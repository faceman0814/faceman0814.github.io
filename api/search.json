[{"id":"2f6f4322594661f0414df8fc201523ed","title":"æˆ‘åœ¨äººé—´å‡‘æ•°çš„ç¬¬8865å¤©","content":"éšä¾¿å­å­æœ‰æ—¶å€™æƒ³æˆä¸ºä¸€ä¸ªæœ‰æ€æƒ³æ·±åº¦çš„äººï¼Œä½†å¥ˆä½•è¯»ä¹¦å¤ªå°‘æ²¡å•¥æ–‡åŒ–ï¼Œçœ‹ä¹¦äºæˆ‘è€Œè¨€è·Ÿå‚¬çœ æ— å·®åˆ«ï¼Œäºæ˜¯æˆ‘æ”¾å¼ƒğŸ™„ ã€‚\næœ€è¿‘å–œæ¬¢ä¸€ä¸ªæ³°å›½å¥³æ¼”å‘˜Ormï¼Œå¥¹èº«ä¸Šè“¬å‹ƒçš„ç”Ÿå‘½åŠ›å’Œæ˜åªšçš„ç¬‘å®¹è®©æˆ‘ç€è¿·ï¼Œå¿ƒç†å­¦ä¸Šè¯´ï¼Œä½ å–œæ¬¢æŸä¸ªäº‹ç‰©æ˜¯å› ä¸ºå®ƒå…·å¤‡ä½ æƒ³æ‹¥æœ‰çš„ç‰¹è´¨ï¼Œæˆ‘è§‰å¾—å¾ˆå¯¹ï¼Œä½†æ¯ä¸ªäººçš„äººç”Ÿéƒ½æ˜¯ç‹¬æœ‰çš„ä¸”ä¸å…·å¤‡å¤åˆ¶æ€§ï¼Œå¦‚ä½•æŒ£æ‰å‘ä¸Šï¼Œæˆ‘è¿˜åœ¨æ‘¸ç´¢ğŸ˜µ ã€‚ã€‚ã€‚ã€‚\nå¾ˆå®¹æ˜“å¯¹ä¸€ä»¶äº‹å„¿ä¸Šå¤´ï¼Œè¿‡äº†å‡ å¤©åˆæ–­å´–ä¸‹å¤´ï¼Œç®€ç§°ä¸‰åˆ†é’Ÿçƒ­åº¦ï¼Œæˆ–è®¸è¿™å°±æ˜¯å¤„å¥³åº§ä¸å—å¾…è§çš„åŸå› ğŸ™ ã€‚\nåˆ†äº«æ¬²æ—ºç››æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œå¥½çš„ä¸€é¢å®ƒå¯ä»¥ä½¿ä½ ä¸»åŠ¨å»ç»´ç³»ä½ æƒ³ç»´ç³»çš„å…³ç³»ï¼Œåçš„ä¸€é¢å°±æ˜¯ä¸‡ä¸€åˆ†äº«é”™äº†äººç»™åˆ«äººå¸¦æ¥å›°æ‰°çš„åŒæ—¶ï¼Œè‡ªå·±çš„çƒ­æƒ…ä¹Ÿè¢«æ‰“å‡»ï¼Œæ‰€ä»¥å¦‚ä½•å»æ§åˆ¶åˆ†äº«æ¬²æ˜¯æˆ‘éœ€è¦å­¦ä¼šçš„è¯¾é¢˜ğŸ ã€‚\n","slug":"2024.12.24æ—¥å¸¸å°è®°","date":"2024-12-24T01:56:11.053Z","categories_index":"æ—¥å¸¸","tags_index":"æ‚è°ˆ","author_index":"FaceMan"},{"id":"c63101490a44e6dea3cd9d49ca1e518b","title":"GitHubActionå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²","content":"ç”±äºæˆ‘çš„æœåŠ¡å™¨é…ç½®å¤ªä½æ”¯æŒä¸äº†GitLabçš„CICDï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œç”¨GitHub Actionæ¥å®ç°ï¼ˆæ„Ÿæ©ï¼‰ï¼Œä¸ŠæœŸæˆ‘ä»¬è¯´åˆ°dockerå®˜æ–¹é•œåƒä»“åº“å³ä½¿ä½ ç”¨ä»£ç†ä¹Ÿç»å¸¸å‡ºç°æ‹‰ä¸ä¸‹æ¥çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¢ä¸ªæ€è·¯ï¼ŒæŠŠé•œåƒå‘å¸ƒåˆ°é˜¿é‡Œäº‘çš„ä¸ªäººä»“åº“ï¼Œæˆ–è€…è‡ªå·±å»ºä¸€ä¸ªdockerç§æœ‰é•œåƒä»“åº“ï¼Œæœ¬ç€ç™½å«–åŸåˆ™ï¼Œæœ¬æ–‡ä½¿ç”¨é˜¿é‡Œäº‘ç§æœ‰é•œåƒä»“åº“æœåŠ¡ã€‚\nå¼€é€šé˜¿é‡Œäº‘ç§æœ‰é•œåƒä»“åº“ç™»å½•ï¼šé˜¿é‡Œäº‘é•œåƒæœåŠ¡å¯ç”¨ä¸ªäººå®ä¾‹\nåˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼Œå¹¶ä¸”è®¾ä¸ºå…¬å¼€ï¼ˆå¯ä»¥ä¸ç”¨ç™»é™†ç›´æ¥æ‹‰é•œåƒï¼‰\nåˆ›å»ºå¥½åå»Githubä»“åº“è®¾ç½®ç¯å¢ƒå˜é‡\nè¿™é‡Œäº‘æœåŠ¡å™¨è¦å¼€æ”¾22ç«¯å£ï¼Œç¡®ä¿&#x2F;etc&#x2F;ssh&#x2F;sshd_configçš„é…ç½®å¦‚ä¸‹\n123456# å¦‚æœæ˜¯rootç™»å½•ï¼Œåˆ™é…ç½®PermitRootLogin yes# å…è®¸å¯†ç ç™»å½•PasswordAuthentication yes# å¦‚æœä½¿ç”¨å¯†é’¥ç™»å½•ï¼Œåˆ™é…ç½®PubkeyAuthentication yes\n\né…ç½®åä½¿ç”¨sudo systemctl restart sshdç”Ÿæ•ˆ\n\n\næ„å»ºGitHubActionæ–‡ä»¶ç›®å½•å¦‚ä¸‹ï¼š\n12345678910Directory: D:\\Project\\DemosMode                 LastWriteTime         Length Name----                 -------------         ------ ----d----           2024/12/2    11:13                .githubd----           2024/12/2    11:13                .vscoded----           2024/12/2    11:13                src-a---           2024/12/2    15:45            549 .gitignore  -a---           2024/12/2    16:14            270 docker-compose.yml-a---           2024/11/1    13:45             27 README.md\n\næˆ‘çš„Dockerfileæ–‡ä»¶æ”¾åœ¨srcä¸‹é¢ï¼Œåˆ›å»ºdeploy.ymlæ”¾åœ¨.github&#x2F;workflowsï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667name: Build and Deployon:  # å½“ä»£ç è¢«æ¨é€åˆ°ä»“åº“æ—¶è§¦å‘  push:    branches:      - main  # å¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹ä¸ºä½ çš„ç›®æ ‡åˆ†æ”¯jobs:  # æ„å»ºå’Œæ¨é€ Docker é•œåƒ  build:    # åœ¨å“ªä¸ªç¯å¢ƒä¸‹è¿è¡Œ    runs-on: ubuntu-latest    steps:      # æ£€æŸ¥ä»£ç     - name: Checkout code      uses: actions/checkout@v2      # å®‰è£… Docker æ„å»ºå·¥å…·    - name: Set up Docker Buildx      uses: docker/setup-buildx-action@v2      # ç™»å½•åˆ°é˜¿é‡Œäº‘ Docker é•œåƒä»“åº“    - name: Log in to Alibaba Cloud Docker Registry      uses: docker/login-action@v2      with:        username: $&#123;&#123;secrets.ALIYUN_REGISTRY_USER&#125;&#125;        password: $&#123;&#123; secrets.ALIYUN_REGISTRY_PASSWORD &#125;&#125;        registry: $&#123;&#123; secrets.ALIYUN_REGISTRY &#125;&#125;      # æ„å»ºå¹¶æ¨é€ Docker é•œåƒ    - name: Build and push Docker image      run: |        docker build -t $&#123;&#123; secrets.ALIYUN_REGISTRY &#125;&#125;/$&#123;&#123; secrets.ALIYUN_NAME_SPACE &#125;&#125;/$&#123;&#123; secrets.IMAGE_NAME &#125;&#125;:latest ./src        docker push $&#123;&#123; secrets.ALIYUN_REGISTRY &#125;&#125;/$&#123;&#123; secrets.ALIYUN_NAME_SPACE &#125;&#125;/$&#123;&#123; secrets.IMAGE_NAME &#125;&#125;:latest  deploy:    runs-on: ubuntu-latest    needs: build    environment:      name: production      url: https://xxxx      steps:      # æ£€æŸ¥ä»£ç     - name: Checkout code      uses: actions/checkout@v2      # SSH è¿æ¥åˆ°æœåŠ¡å™¨å¹¶éƒ¨ç½²åº”ç”¨    - name: SSH into server and deploy      uses: appleboy/ssh-action@v0.1.8      with:        host: $&#123;&#123; secrets.ALIYUN_SERVER_IP &#125;&#125;        username: $&#123;&#123; secrets.ALIYUN_SERVER_USER &#125;&#125;        password: $&#123;&#123; secrets.ALIYUN_SERVER_PASSWORD &#125;&#125;        port: 22        # å¦‚æœä½¿ç”¨ç§é’¥ç™»å½•åˆ™æ‰“å¼€ä¸‹åˆ—é…ç½®        # key: $&#123;&#123; secrets.SSH_PRIVATE_KEY &#125;&#125;        script: |          # æ‹‰å–é•œåƒ          docker pull $&#123;&#123; secrets.ALIYUN_REGISTRY &#125;&#125;/$&#123;&#123; secrets.ALIYUN_NAME_SPACE &#125;&#125;/$&#123;&#123; secrets.IMAGE_NAME &#125;&#125;:latest          # åœæ­¢ä¹‹å‰çš„å®¹å™¨          docker stop $&#123;&#123; secrets.IMAGE_NAME &#125;&#125; || true          docker rm $&#123;&#123; secrets.IMAGE_NAME &#125;&#125; || true          # å¯åŠ¨å®¹å™¨          docker run -d --name $&#123;&#123; secrets.IMAGE_NAME &#125;&#125; -p 7121:80 $&#123;&#123; secrets.ALIYUN_REGISTRY &#125;&#125;/$&#123;&#123; secrets.ALIYUN_NAME_SPACE &#125;&#125;/$&#123;&#123; secrets.IMAGE_NAME &#125;&#125;:latest\n\né…ç½®å®Œæ¨é€åˆ†æ”¯å°±å¯ä»¥å•¦ï¼\n\n","slug":"GitHubActionå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²","date":"2024-12-02T09:48:38.957Z","categories_index":"DevOps","tags_index":"CICD","author_index":"FaceMan"},{"id":"db862bea918e56d5ebf1541d0aa7193d","title":"Dockerå®ç°Linuxç§‘å­¦ä¸Šç½‘","content":"æ²¡æƒ³åˆ°æˆ‘è¿˜èƒ½åœ¨Clashè¿™é‡Œåƒäºï¼Œäº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œä»¥å‰åªç©è¿‡gitlabçš„CICDï¼Œå®˜æ–¹çš„è¦é’±ï¼Œè‡ªå·±éƒ¨ç½²çš„è¯æœåŠ¡å™¨é…ç½®æœ‰è¦æ±‚ï¼Œè€Œä¸”æˆ‘çš„é¡¹ç›®åŸºæœ¬éƒ½å¼€æºï¼Œæ‰€ä»¥ä»Šå¤©å‡†å¤‡ç ”ç©¶ä¸‹GitHubçš„CICDâ€”â€”Github Actionsã€‚ç»è¿‡ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘å‡†å¤‡äº†ä¸€ä¸ªå«webtestçš„é•œåƒï¼Œç„¶ååœ¨æˆ‘99ä¸€å¹´çš„é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šå‡†å¤‡æ‹‰ä¸‹æ¥åšå®éªŒï¼Œå‘ç°ï¼Œæ‹‰ä¸ä¸‹æ¥ï¼æŠ¥é”™å¦‚ä¸‹ï¼š\n1Error response from daemon: Get â€œhttps://registry-1.docker.io/v2/â€: context deadline exceeded\n\nç½‘ä¸Šæ‰¾äº†å¾ˆå¤šæ–¹æ³•æ— éå‡ ç§ï¼š\n\næ”¹DNS\né…ç½®å…¶ä»–é•œåƒæº\nä¸Šä»£ç†\n\næˆ‘è¿™é‡Œå› ä¸ºæ˜¯ä¸Šä¼ åˆ°dockerçš„å®˜æ–¹é•œåƒä»“åº“ï¼Œæ‰€ä»¥æ”¹DNSå’Œé•œåƒæºæ²¡æœ‰ç”¨ï¼Œæ‰€ä»¥å°±å‰©ä¸€æ‹›äº†ï¼Œä¸Šä»£ç†ã€‚\näºæ˜¯ï¼Œæˆ‘å°±å¼€å§‹å¾€Ubuntuä¸ŠæŠ˜è…¾Clashï¼Œå› ä¸ºæˆ‘ä¹‹å‰å¼„è¿‡Clashï¼Œä½†æˆ‘ä¸è®°å¾—æˆ‘ä¸ºå•¥å…³äº†ï¼Œç”¨çš„æ˜¯Ubuntuç³»ç»Ÿä¸‹systemctl start clashçš„å¯åŠ¨æ–¹å¼ï¼Œå…·ä½“çš„å¯ä»¥å‚è€ƒæˆ‘çš„æ–‡ç« ï¼šClash for Ubuntuï¼Œé—®é¢˜åˆæ¥äº†ï¼Œæˆ‘å‘ç°å®˜æ–¹æä¾›çš„é“¾æ¥é¢æ¿Clash (razord.top)æ­»æ´»è¿ä¸ä¸Šï¼Œè¦ä¹ˆæŠ¥è·¨åŸŸï¼Œè¦ä¹ˆå°±æ˜¯Net Errorå•¥çš„ï¼Œæˆ‘æŸ¥äº†ä¸‹ç›¸å…³issueï¼Œclashçš„è®¾è®¡é—®é¢˜ï¼Œæœ€å¥½æ˜¯è®¾ç½®å¯†ç ï¼Œäºæ˜¯æˆ‘åˆå»config.ymlè®¾ç½®å¯†ç ï¼Œä½†å‘ç°å¶å°”èƒ½è¿ä¸Šï¼Œå¤§éƒ¨åˆ†æ—¶é—´è¿ä¸ä¸Šï¼Œä¸ç¨³å®šã€‚äºæ˜¯æˆ‘åˆæ…¢æ…¢æœç´¢è§£å†³æ–¹æ¡ˆï¼Œå‘ç°å¯ä»¥ç”¨yacdæ¥è§£å†³ï¼Œè¿™ä¸ªä¹Ÿæœ‰æä¾›å®˜æ–¹çš„é“¾æ¥yacd (haishan.me)ä¾›ä½ ä½¿ç”¨ï¼Œä½†æˆ‘è¯•äº†ä¸‹å¶å°”ä¹Ÿä¸ç¨³å®šï¼Œäºæ˜¯æˆ‘è‡ªå·±éƒ¨ç½²ï¼Œä¸€ä¸‹å°±æå®šäº†ï¼ä½†è¿™é‡Œæœ‰ä¸ªè¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯å¦‚æœä½ åŠ äº†è¯ä¹¦ï¼Œé‚£ä¹ˆä¸¤ä¸ªéƒ½è¦åŠ ä¸ç„¶ä¹Ÿè¯†åˆ«ä¸åˆ°ã€‚\nDockeræ•™ç¨‹è¿™é‡Œæˆ‘æä¾›ä¸€ä¸ªDockerComposeæ¥éƒ¨ç½²ï¼Œç”¨systemctléƒ¨ç½²éº»çƒ¦å¾—å¾ˆï¼Œè¿˜è¦æƒ³åŠæ³•æ‰¾æºæ–‡ä»¶,è€Œä¸”æœ‰æ›´æ”¹çš„è¯å¾ˆéº»çƒ¦ï¼Œdockeræ–¹ä¾¿ã€‚\né¦–å…ˆï¼Œå»ä»£ç†è½¯ä»¶å¤åˆ¶èŠ‚ç‚¹è®¢é˜…åœ°å€,å‡†å¤‡ä¸€ä¸ªconfig.ymlé…ç½®æ–‡ä»¶ï¼Œæ”¾åˆ°&#x2F;root&#x2F;.config&#x2F;clashè·¯å¾„ä¸‹ï¼Œå‚è€ƒClash for Ubuntu (notion.so)è·å–è¿™é‡Œæˆ‘ä¸é‡å¤è¯´æ˜ã€‚\nç„¶åè®¾ç½®å¯†ç \nå†ç„¶ååˆ›å»ºclash&#x2F;docker-compose.ymlæ–‡ä»¶\n1234567891011121314151617181920212223242526version: &#x27;3.9&#x27;services:  yacd:    image: ghcr.io/haishanh/yacd:master    container_name: yacd    ports:      - &quot;1234:80&quot;    restart: unless-stopped  clash:    image: dreamacro/clash    container_name: clash    volumes:      - ./.config/clash:/root/.config/clash      # - ./ui:/ui # dashboard volume (uncomment if needed)    ports:      - &quot;7890:7890&quot;      - &quot;7891:7891&quot;      # - &quot;8080:8080&quot; # external controller (Restful API, uncomment if needed)    # TUN capabilities (uncomment if needed)    # cap_add:    #   - NET_ADMIN    # devices:    #   - /dev/net/tun    restart: unless-stopped    network_mode: &quot;host&quot;  # use &quot;bridge&quot; mode in non-Linux environments if required\n\nå†å†ç„¶åæ‰§è¡Œdocker compose up -d\nå¦‚æœæ˜¯äº‘æœåŠ¡å™¨è®°å¾—å¼€æ”¾1234å’Œ9090ç«¯å£\n\nPSï¼šæœ‰æ—¶å€™æœ‰ä»£ç†ä¹Ÿæ‹‰ä¸åˆ°dockerå®˜æ–¹çš„é•œåƒï¼Œç½‘ç»œé—®é¢˜ï¼Œåƒåœ¾çš„å¾ˆï¼Œæ‰€ä»¥å»ºè®®å¤§å®¶è‡ªå·±çš„é•œåƒå¯ä»¥æ”¾åˆ°è‡ªå·±çš„ç§æœ‰ä»“åº“é‡Œã€‚\n","slug":"Linuxç§‘å­¦ä¸Šç½‘","date":"2024-11-30T16:33:41.616Z","categories_index":"DevOps","tags_index":"Docker,Clash","author_index":"FaceMan"},{"id":"32b006c2c9398b6cfeebb21599635996","title":"Dockeræ„å»ºã€æ‰“åŒ…ã€éƒ¨ç½²ä¸€æ¡é¾™çš„è¿‡ç¨‹","content":"Webé¡¹ç›®å†™å¥½åï¼Œæˆ‘ä¹ æƒ¯ç”¨Dockeræ‰“åŒ…æˆé•œåƒç„¶åéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šä½¿ç”¨ï¼Œç†ç”±æ˜¯æ–¹ä¾¿ï¼Œåé¢è¿­ä»£çš„æ—¶å€™åªéœ€è¦æ›´æ¢é•œåƒå°±èƒ½å®Œæˆéƒ¨ç½²ï¼Œç”šè‡³æ›´æ–¹ä¾¿ç‚¹ä½¿ç”¨cicdå®Œæˆè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œé‚£ä¹ˆå­¦ä¼šå†™DockerFileæ–‡ä»¶å°±æ˜¯å¿…ä¸å¯å°‘çš„äº†ï¼Œé‚£åºŸè¯å°‘è¯´ï¼Œå®è·µå¼€å§‹ï¼\n1ã€æ„å»ºDockerFileæˆ‘çš„æ–‡ä»¶ç›®å½•ä¸ºï¼š\n123456789101112PS D:\\Study\\Demos\\src&gt; ls    Directory: D:\\Study\\Demos\\srcMode                 LastWriteTime         Length Name----                 -------------         ------ ----d----          2024/11/29    14:40                FaceMan.EFTestd----          2024/11/29    16:31                FaceMan.WebTest-a---          2024/11/29    13:55         309048 config.json-a---          2024/11/29    14:51           2642 Demo.sln-a---          2024/11/29    16:31           1170 Dockerfile-a---          2024/11/29    15:09            640 version.props\n\næ‰€ä»¥æˆ‘çš„DockerFileæ˜¯è¿™æ ·å†™çš„ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344# ä½¿ç”¨å®˜æ–¹çš„ ASP.NET Core Runtime é•œåƒFROM mcr.microsoft.com/dotnet/aspnet:9.0 AS base# è®¾ç½®å·¥ä½œç›®å½•WORKDIR /app# å¼€æ”¾åº”ç”¨æ‰€éœ€çš„ç«¯å£EXPOSE 80# ä½¿ç”¨å®˜æ–¹çš„.NET SDKé•œåƒä½œä¸ºæ„å»ºç¯å¢ƒFROM mcr.microsoft.com/dotnet/sdk:9.0 AS buildWORKDIR /src# å¤åˆ¶é¡¹ç›®æ–‡ä»¶åˆ°å®¹å™¨ä¸­COPY [&quot;FaceMan.EFTest/FaceMan.EFTest.csproj&quot;, &quot;FaceMan.EFTest/&quot;]COPY [&quot;FaceMan.WebTest/FaceMan.WebTest.csproj&quot;, &quot;FaceMan.WebTest/&quot;]# è¿˜åŸå’Œç¼–è¯‘é¡¹ç›®RUN dotnet restore &quot;FaceMan.WebTest/FaceMan.WebTest.csproj&quot;# å¤åˆ¶æ•´ä¸ªé¡¹ç›®åˆ°å®¹å™¨ä¸­COPY . .WORKDIR &quot;/src/FaceMan.WebTest&quot;RUN dotnet build &quot;FaceMan.WebTest.csproj&quot; -c Release -o /app/buildFROM build AS publishRUN dotnet publish &quot;FaceMan.WebTest.csproj&quot; -c Release -o /app/publish /p:UseAppHost=false# ä»æ„å»ºç¯å¢ƒä¸­å¤åˆ¶ç¼–è¯‘å¥½çš„æ–‡ä»¶FROM base AS finalWORKDIR /appCOPY --from=publish /app/publish .#å®šä¹‰æ—¶åŒºå‚æ•°ENV TZ=Asia/Shanghai#è®¾ç½®æ—¶åŒºRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo &#x27;$TZ&#x27; &gt; /etc/timezone# è®¾ç½®å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ENTRYPOINT [&quot;dotnet&quot;, &quot;FaceMan.WebTest.dll&quot;]\n\n2ã€æ‰“åŒ…æˆé•œåƒå¯¼èˆªåˆ°Dockerfileæ‰€åœ¨è·¯å¾„æ‰§è¡Œå‘½ä»¤ï¼šdocker build -t é•œåƒåç§° .ä¾‹å¦‚ï¼šdocker build -t webtest .\npsï¼šä¸€å®šè¦æœ‰è¿™ä¸ªâ€˜.â€™\n3ã€å¯åŠ¨å®¹å™¨é•œåƒæ‰“å®Œä¹‹åå°±å¯ä»¥æ ¹æ®é•œåƒå¯åŠ¨å®¹å™¨äº†ï¼šdocker run é•œåƒ\n.netä¸çŸ¥é“å‡ ä»£å‡çº§ä¹‹åå°±å¿…é¡»è¦æŒ‡å®šç«¯å£äº†ï¼Œæˆ‘çš„é»˜è®¤ç”Ÿæˆçš„æ˜¯8080ï¼Œæ‰€ä»¥æˆ‘éœ€è¦ç”¨-pæ¥æ˜ å°„æˆ‘å®é™…çš„ç«¯å£ï¼šdocker run -d -p 7121:8080 --name my-running-app webtest å…¶ä¸­my-running-appæ˜¯å®¹å™¨åå­—ï¼Œwebtestæ˜¯é•œåƒåå­—\n4ã€ä½¿ç”¨DockerComposeå¯åŠ¨åˆ›å»ºæ–‡ä»¶docker-compose.ymlçš„å†…å®¹ä¸ºï¼š\n12345678910version: &#x27;3.8&#x27;services:  demo-app:    image: webtest    ports:      - &quot;7121:8080&quot;    environment:      #è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œè®¾ç½®ä¸ºå¼€å‘ç¯å¢ƒ      ASPNETCORE_ENVIRONMENT: Development\n\nç„¶åæ‰§è¡Œéƒ¨ç½²å‘½ä»¤ï¼šdocker compose up -d\næ’¤é”€éƒ¨ç½²å‘½ä»¤ä¸ºï¼šdocker compose down\n5ã€æ¨é€é•œåƒåˆ°é•œåƒä»“åº“åˆšåˆšæˆ‘ä»¬åˆ¶ä½œçš„é•œåƒä¸ºï¼šwebtestï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ¨é€åˆ°é•œåƒä»“åº“çš„è¯å°±éœ€è¦æ”¹ä¸‹åå­—ï¼Œè¦åœ¨å‰é¢åŠ ä¸Šä½ dockerä»“åº“çš„ç”¨æˆ·åï¼Œæ¯”å¦‚æˆ‘çš„å«ï¼šfaceman0814&#x2F;webtestã€‚è¿™é‡Œæˆ‘ä»¬ç”¨tagå‘½ä»¤æ¥é‡æ–°åˆ›å»ºä¸€ä¸ªfaceman0814&#x2F;webtesté•œåƒï¼šdocker tag webtest faceman0814/demo\nç„¶åæ¨é€ï¼šdocker push faceman0814/webtest\næ‹‰å–å‘½ä»¤ï¼šdocker pull faceman0814/webtest\næŒ‡å®šç‰ˆæœ¬çš„è¯åœ¨æ‹‰å–å‘½ä»¤åŠ ä¸Š:ç‰ˆæœ¬ï¼Œé»˜è®¤æ˜¯æœ€åä¸€ä¸ªç‰ˆæœ¬\nå®Œç»“è‡ªæ­¤ç®€å•åŸºç¡€çš„é•œåƒæ„å»ºï¼Œå®¹å™¨éƒ¨ç½²çš„è¿‡ç¨‹å°±ç»“æŸäº†ï¼Œå®Œç»“æ’’èŠ±ï¼\n","slug":"æ„å»ºDockerFile","date":"2024-11-29T10:07:43.764Z","categories_index":"DevOps","tags_index":"Docker","author_index":"FaceMan"},{"id":"effef2644cf5d4dbdf4ef3a751e9c7bc","title":" Dockeræ‹‰å–netsdké•œåƒ","content":"åœ¨å†™DockerFileæ–‡ä»¶æ—¶ï¼Œå‘ç°ç›´æ¥æ‹‰å–mcr.microsoft.com/dotnet/sdk:9.0æŠ¥é”™ï¼š\n123PS D:\\Study\\Demos\\Demo&gt; docker pull mcr.microsoft.com/dotnet/sdk:9.0Error response from daemon: Get &quot;https://mcr.microsoft.com/v2/&quot;: EOF\n\nè§£å†³æ–¹æ¡ˆï¼š\n\nå®‰è£…newbe.mcrmirrorï¼šdotnet tool install newbe.mcrmirror -g\nå®‰è£… .NET Core 3.1 æ¡†æ¶ï¼šè®¿é—® Microsoft .NET Core ä¸‹è½½é¡µé¢ã€‚\næ‰§è¡Œå‘½ä»¤ï¼šdocker-mcr -i mcr.microsoft.com/dotnet/sdk:9.0\næŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼šdotnet --list-runtimes\næ‹‰å–.net 9.0 SDKï¼šdocker pull mcr.microsoft.com/dotnet/sdk:9.0\n\n","slug":"dockeræ‹‰å–netsdké•œåƒ","date":"2024-11-29T00:00:00.000Z","categories_index":"DevOps","tags_index":"Docker,.Net SDK","author_index":"FaceMan"},{"id":"2fa7613b39e74fc504fcd245fd9c9634","title":"acmeè¯ä¹¦æŒ‡å—","content":"é€šå¸¸æˆ‘ä»¬è‡ªå·±çš„ç½‘ç«™æ¯”å¦‚åšå®¢ã€ä¸ªäººç½‘ç«™ã€å°ç¨‹åºç­‰éƒ½éœ€è¦ä½¿ç”¨SSLè¯ä¹¦æ¥ç¡®ä¿å®‰å…¨ã€‚ä½†æ˜¯ç”³è¯·è¯ä¹¦å¹¶ä¸æ˜¯ä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼Œéœ€è¦æœ‰ä¸€å®šçš„ç»éªŒå’ŒçŸ¥è¯†ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨acme.shæ¥è‡ªåŠ¨ç”³è¯·å’Œç»­æœŸSSLè¯ä¹¦ã€‚\nä»€ä¹ˆæ˜¯acmeï¼Ÿacmeï¼ˆAutomatic Certificate Management Environmentï¼Œè‡ªåŠ¨è¯ä¹¦ç®¡ç†ç¯å¢ƒï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰è½¯ä»¶ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨ä¸ºç½‘ç«™ã€æœåŠ¡æä¾›è¯ä¹¦ã€‚\nacmeçš„å·¥ä½œåŸç†acmeçš„å·¥ä½œåŸç†æ˜¯ï¼Œå½“ç”¨æˆ·è®¿é—®ç½‘ç«™æˆ–æœåŠ¡æ—¶ï¼Œå¦‚æœç½‘ç«™æˆ–æœåŠ¡çš„è¯ä¹¦å·²ç»è¿‡æœŸï¼Œåˆ™acmeä¼šå‘è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰è¯·æ±‚è¯ä¹¦ã€‚CAä¼šå¯¹ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯è¿›è¡ŒéªŒè¯ï¼Œå¹¶ç­¾å‘è¯ä¹¦ã€‚acmeä¼šè‡ªåŠ¨å®‰è£…å¹¶æ›´æ–°è¯ä¹¦ã€‚\nè¯ä¹¦çš„ç±»å‹acmeæ”¯æŒå¤šç§è¯ä¹¦ç±»å‹ï¼ŒåŒ…æ‹¬ï¼š\n\nRSAè¯ä¹¦ï¼šæœ€å¸¸ç”¨çš„è¯ä¹¦ç±»å‹ï¼Œç”±RSAç®—æ³•ç”Ÿæˆçš„è¯ä¹¦ï¼Œå®‰å…¨æ€§è¾ƒé«˜ã€‚\nECCè¯ä¹¦ï¼šç”±æ¤­åœ†æ›²çº¿ç®—æ³•ç”Ÿæˆçš„è¯ä¹¦ï¼Œå®‰å…¨æ€§è¾ƒé«˜ã€‚\nå¤šåŸŸåè¯ä¹¦ï¼šå¯ä»¥ä¸ºå¤šä¸ªåŸŸåç”Ÿæˆè¯ä¹¦ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢åŸŸååŠ«æŒã€‚\né€šé…ç¬¦è¯ä¹¦ï¼šå¯ä»¥ä¸ºå¤šä¸ªå­åŸŸåç”Ÿæˆè¯ä¹¦ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢æ³›åŸŸåè¯ä¹¦è¢«æ”»å‡»ã€‚\nè‡ªç­¾åè¯ä¹¦ï¼šå¯ä»¥ä¸ºç½‘ç«™æˆ–æœåŠ¡æä¾›è‡ªç­¾åè¯ä¹¦ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢è¯ä¹¦è¢«ç¯¡æ”¹ã€‚\n\nacmeçš„å¸¸ç”¨å‘½ä»¤acmeçš„å¸¸ç”¨å‘½ä»¤æœ‰ï¼š\n\nacme.sh --issue -d example.com -w /path/to/webrootï¼šç­¾å‘example.comçš„è¯ä¹¦ï¼Œå¹¶å°†è¯ä¹¦å®‰è£…åˆ°&#x2F;path&#x2F;to&#x2F;webrootç›®å½•ã€‚\nacme.sh --renew -d example.com -w /path/to/webrootï¼šç»­æœŸexample.comçš„è¯ä¹¦ï¼Œå¹¶å°†è¯ä¹¦å®‰è£…åˆ°&#x2F;path&#x2F;to&#x2F;webrootç›®å½•ã€‚\nacme.sh --revoke -d example.comï¼šåŠé”€example.comçš„è¯ä¹¦ã€‚\nacme.sh --install-cert -d example.com -w /path/to/webrootï¼šå®‰è£…example.comçš„è¯ä¹¦åˆ°&#x2F;path&#x2F;to&#x2F;webrootç›®å½•ã€‚\nacme.sh --update-account-keyï¼šæ›´æ–°acmeè´¦æˆ·çš„ç§é’¥ã€‚\nacme.sh --upgradeï¼šå‡çº§acmeåˆ°æœ€æ–°ç‰ˆæœ¬ã€‚\n\nå‚è€ƒï¼šacme.sh å®˜æ–¹æ–‡æ¡£\né¢å‘è¯ä¹¦å‡†å¤‡å·¥ä½œ\n\n\n\n\n\n\nè´­ä¹°åŸŸåå’ŒæœåŠ¡å™¨\n\nå‡†å¤‡æœåŠ¡å™¨ï¼ˆäº‘æœåŠ¡å™¨æˆ–è‡ªå»ºæœåŠ¡å™¨ï¼‰\næœåŠ¡å™¨éœ€è¦å®‰è£…dockerå’Œdocker-composeï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯v2ç‰ˆæœ¬çš„docker-composeè¯­æ³•ã€‚\næœåŠ¡å™¨éœ€è¦å¼€æ”¾80å’Œ443ç«¯å£\n\n\nå‡†å¤‡åŸŸå\nè´­ä¹°åŸŸåï¼Œå¹¶å°†åŸŸåè§£æåˆ°æœåŠ¡å™¨çš„IPåœ°å€ã€‚\n\n\n\n\n\nå¦‚æœä¸ä¼šè¯·ç™¾åº¦æˆ–è€…çœ‹æˆ‘çš„å…¶ä»–æ–‡ç« ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\nå®‰è£…acme.shå’Œnginx\nacmeç”¨æ¥è‡ªåŠ¨ç­¾å‘è¯ä¹¦ï¼Œnginxç”¨æ¥é…ç½®è¯ä¹¦çš„å®‰è£…ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950version: &#x27;3.8&#x27;services:  nginx:    container_name: nginx    image: nginx    restart: always    network_mode: host    logging:      options:        max-size: &#x27;2048m&#x27;        max-file: &#x27;10&#x27;    labels:      - nginx    volumes:      - /docker/nginx/acme/d1:/domains      - /docker/nginx/conf.d:/etc/nginx/conf.d      - /docker/nginx/nginx.conf:/etc/nginx/nginx.conf      - /docker/nginx/www:/var/www      - /root/static_website:/static_website  acme.sh:    container_name: acme.sh    image: neilpang/acme.sh:3.0.5    restart: always    command: daemon    logging:      options:        max-size: &#x27;2048m&#x27;        max-file: &#x27;10&#x27;    volumes:      # æŒ‚è½½ä¸»æœºè·¯å¾„åˆ°å®¹å™¨è·¯å¾„ï¼Œç”¨äºä¿å­˜acme.shè„šæœ¬      - /docker/nginx/acme:/acme.sh      # æŒ‚è½½ä¸»æœºè·¯å¾„åˆ°å®¹å™¨è·¯å¾„ï¼Œå…è®¸å®¹å™¨é€šè¿‡docker.sockä¸æœ¬åœ°dockeræœåŠ¡é€šä¿¡      - /var/run/docker.sock:/var/run/docker.sock    environment:      # è®¾ç½®å®¹å™¨çš„éƒ¨ç½²æ ‡ç­¾ï¼Œç”¨äºè‡ªåŠ¨åŠ è½½ä¸nginxç›¸å…³çš„é…ç½®      - DEPLOY_DOCKER_CONTAINER_LABEL=nginx      # è®¾ç½®å®¹å™¨çš„è‡ªåŠ¨é‡è½½å‘½ä»¤ï¼Œåœ¨å®¹å™¨å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œè¯¥å‘½ä»¤é‡æ–°åŠ è½½nginxé…ç½®      - DEPLOY_DOCKER_CONTAINER_RELOAD_CMD=&quot;service nginx force-reload&quot;      # è®¾ç½®é˜¿é‡Œäº‘çš„Access Key      - Ali_Key=********      # è®¾ç½®é˜¿é‡Œäº‘çš„Secret Key      - Ali_Secret=************      # è®¾ç½®åä¸ºäº‘çš„ç”¨æˆ·å      - HUAWEICLOUD_Username=********      # è®¾ç½®åä¸ºäº‘çš„å¯†é’¥      - HUAWEICLOUD_Password=*********      # è®¾ç½®åä¸ºäº‘çš„åŸŸå      - HUAWEICLOUD_DomainName=********\n\n\n\nç­¾å‘è¯ä¹¦123456789101112//é˜¿é‡Œäº‘è§£æï¼šdns_ali  //åä¸ºäº‘è§£æï¼šdns_huaweicloudsudo docker exec \\ acme --issue --dns dns_ali \\ -d example.com \\ --cert-file\t    /acme.sh/domains/example.com/cert.cert \\ --key-file         /acme.sh/domains/example.com/key.key \\ --ca-file          /acme.sh/domains/example.com/ca.cer \\ --fullchain-file   /acme.sh/domains/example.com/fullchain.pem \\ --force//example.comä¸ºåŸŸå\n\nè‡ªåŠ¨åŒ–ç»­ç­¾1docker exec acme.sh  --upgrade  --auto-upgrade\n\né‡è½½é…ç½®1docker exec -it nginx  service nginx force-reload\n\nnignxé…ç½®1234567891011121314151617181920212223error_log /var/log/nginx/error.log;server &#123;    listen 80;    listen 443 ssl;    server_name example.com;    ssl_protocols TLSv1.2 TLSv1.1 TLSv1;       ssl_certificate      /domains/fullchain.pem; //è¯ä¹¦è·¯å¾„    ssl_certificate_key  /domains/key.key; //å¯†é’¥è·¯å¾„    ssl_prefer_server_ciphers on;     ssl_session_timeout  5m;    if ($server_port = 80) &#123;    rewrite ^(.*)$ https://$host$1 permanent;    &#125;    location / &#123;        proxy_pass ipåœ°å€åŠ ç«¯å£å·;        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        root /home/web/;        index index.php;    &#125;&#125;\n\né‡å¯nginx1docker restart nginx\n\nå®Œç»“è‡³æ­¤ï¼Œacmeè¯ä¹¦ç”³è¯·å’Œç»­æœŸçš„æµç¨‹å·²ç»ä»‹ç»å®Œæ¯•ï¼Œè®¿é—®è‡ªå·±çš„ç½‘ç«™æˆ–æœåŠ¡æ—¶ä½ ä¼šçœ‹åˆ°httpsçš„é”ï¼Œå¦‚æœè¯ä¹¦å·²ç»è¿‡æœŸï¼Œåˆ™ä¼šè‡ªåŠ¨ç”³è¯·å’Œå®‰è£…è¯ä¹¦ã€‚\n","slug":"acmeè¯ä¹¦æŒ‡å—","date":"2024-11-28T00:00:00.000Z","categories_index":"DevOps","tags_index":"SSL,Liunx","author_index":"FaceMan"},{"id":"6077b98b9ff0688a2006567048ac9630","title":"Qexoï¼šåšå®¢çš„ç®¡ç†å’Œè‡ªåŠ¨åŒ–å‘å¸ƒ","content":"Hexoæ˜¯ä¸€ä¸ªæ¨¡æ¿å¾ˆå¤šçš„é™æ€åšå®¢ç”Ÿæˆå·¥å…·ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦æ‰“å¼€ç¼–è¯‘å™¨è¿›è¡Œåšå®¢æ’°å†™å’Œä½¿ç”¨å‘½ä»¤è¡Œç”Ÿæˆå‘å¸ƒæœªå…æœ‰ç‚¹å¤ªç¹çï¼Œæœ¬ç¯‡æ–‡ç« å°±æ¥æ€»ç»“å¤§ä½¬çš„å¯è§†åŒ–åšå®¢æ’°å†™å†…å®¹å’Œè‡ªåŠ¨åŒ–éƒ¨ç½²åšå®¢æ–¹æ³•ã€‚\nQexoåœ¨é€›Githubæ—¶çœ‹åˆ°è¿™ä¸ªé¡¹ç›®æˆ‘çš„çœ¼ç›ä¸€äº®ï¼Œå¯ä»¥ç®¡ç†hexoçš„åšå®¢å†…å®¹ï¼Œäº²æµ‹å¥½ç”¨ï¼Œè¿™é‡Œä¸å±•å¼€è®²ï¼Œå› ä¸ºå®˜æ–¹æ–‡æ¡£è¶³å¤Ÿè¯¦ç»†ï¼Œå¦‚æœè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜å…ˆæŸ¥çœ‹issueï¼Œä¸€èˆ¬éƒ½èƒ½è§£å†³ï¼šQexo | ä¸€ä¸ªç¾è§‚ã€å¼ºå¤§çš„åœ¨çº¿ é™æ€åšå®¢ ç®¡ç†å™¨\nè‡ªåŠ¨åŒ–éƒ¨ç½²åšå®¢ä¸ºäº†ç®€åŒ–Hexoéƒ¨ç½²è¿‡ç¨‹ï¼Œä½ å¯ä»¥ä½¿ç”¨æŒç»­é›†æˆå·¥å…·ï¼ˆå¦‚ GitHub Actionsï¼‰æ¥å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚\n1ã€åˆ›å»ºåšå®¢æºä»£ç ä»“åº“å› ä¸ºæˆ‘ä»¬éœ€è¦ Hexo æºä»£ç æ‰èƒ½ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªç§æœ‰ä»“åº“æ¥ä¿å­˜æˆ‘ä»¬çš„æºä»£ç ï¼Œå½“ç„¶å¦‚æœä½ è§‰å¾—éº»çƒ¦ä¹Ÿå¯ä»¥å»ºç«‹ä¸€ä¸ªåˆ†æ”¯ä¿å­˜ï¼Œä¸è¿‡é€šå¸¸æˆ‘ä»¬ä¼šå°†çº¯é™æ€æ–‡ä»¶å’Œæºç æ–‡ä»¶åˆ†åˆ«å­˜æ”¾åˆ°ä¸¤ä¸ªä»“åº“é‡Œï¼Œä¸€ä¸ªå¯ä»¥ä½œä¸ºå…¬å¼€ä»“åº“å¯¹å¤–å±•ç¤ºï¼Œæºç ç›®å½•éœ€è¦è®¾ä¸ºç§æœ‰ï¼Œæœ‰åˆ©äºæ›´å¥½åœ°ä¿æŠ¤ä½ çš„æ–‡ç« ç‰ˆæƒã€‚\n2ã€ç”Ÿæˆ Github Tokenç‚¹å‡»å¤´åƒ &#x3D;&gt; Settings &#x3D;&gt; Developer settings &#x3D;&gt;Personal access tokens &#x3D;&gt; Tokens(classic) &#x3D;&gt; Generate new token &#x3D;&gt; Generate new token(classic)\n\nè®¾ç½®æ ¹æ®éœ€è¦è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæˆ‘è¿™é‡Œè®¾ç½®æ°¸ä¸è¿‡æœŸï¼Œæƒé™å‹¾é€‰repoä»¥åŠ workflowï¼Œç”Ÿæˆåè®°å¾—ä¿å­˜èµ·æ¥ï¼Œåªæ˜¾ç¤ºä¸€æ¬¡ã€‚\n3ã€ä¿®æ”¹ config.ymlæŠŠ config.yml æ–‡ä»¶ä¸­çš„ deploy &#x3D;&gt; repository &#x3D;&gt; github å€¼æ”¹æˆ token url çš„å½¢å¼ã€‚\n12345678910deploy:  - type: git    repo: https://&#123;$GH_TOKEN&#125;@github.com/shiguang-coding/shiguang-coding.github.io.git,maindeploy:- type: git  repo: https://&#123;$GH_TOKEN&#125;@github.com/shiguang-coding/shiguang-coding.github.io.git,main\n\nå°† {$GH_TOKEN} æ›¿æ¢æˆåˆšæ‰ç”Ÿæˆçš„ token ï¼Œä»“åº“åœ°å€æ˜¯åšå®¢é™æ€æ–‡ä»¶æœ€ç»ˆå­˜æ”¾çš„ä»“åº“åœ°å€ï¼Œå³å¼€é€š Github Pages æœåŠ¡çš„é‚£ä¸ªä»“åº“åœ°å€ã€‚\nè¿™é‡Œå¯ä»¥åŒæ—¶éƒ¨ç½²åˆ°å¤šä¸ªä»“åº“ï¼Œåªéœ€å¤åˆ¶ä¸€ä»½é…ç½®ä¿¡æ¯å³å¯\n12345678910111213deploy:  - type: git    repo: https://&#123;$GH_TOKEN&#125;@github.com/your-name/your-name.github.io.git,main  - type: git    repo: https://&#123;$GH_TOKEN&#125;@github.com/your-name/your-repo.git,maindeploy:- type: git  repo: https://&#123;$GH_TOKEN&#125;@github.com/your-name/your-name.github.io.git,main- type: git  repo: https://&#123;$GH_TOKEN&#125;@github.com/your-name/your-repo.git,main\n\n4ã€åˆ›å»º GitHub Actions è„šæœ¬GitHub Actions çš„å·¥ä½œæµæ–‡ä»¶å­˜æ”¾åœ¨æºä»£ç ä»“åº“çš„ .github&#x2F;workflows ç›®å½•ã€‚workflow æ–‡ä»¶é‡‡ç”¨ YAML æ ¼å¼ï¼Œæ–‡ä»¶åå¯ä»¥ä»»æ„å–ï¼Œä½†æ˜¯åç¼€åç»Ÿä¸€ä¸º .ymlï¼Œæ¯”å¦‚ deploy.ymlã€‚ä¸€ä¸ªåº“å¯ä»¥æœ‰å¤šä¸ª workflow æ–‡ä»¶ã€‚GitHub åœ¨æˆ‘ä»¬å®Œæˆé¢„è®¾è§¦å‘æ¡ä»¶æ—¶ï¼Œåªè¦å‘ç° .github&#x2F;workflows ç›®å½•é‡Œé¢æœ‰ .yml æ–‡ä»¶ï¼Œå°±ä¼šè‡ªåŠ¨è¯»å–è¿è¡Œè¯¥æ–‡ä»¶ã€‚\nå¯ä»¥æ‰‹åŠ¨å»ºç«‹æ­¤æ–‡ä»¶ï¼Œæˆ–è€…é€šè¿‡æºä»£ç ä»“åº“ &#x3D;&gt; Actions &#x3D;&gt; é€‰æ‹© Setup Nodeåˆ›å»ºï¼Œä½†æœ€ç»ˆåŒæ ·éƒ½éœ€ push åˆ°è¿œç«¯æºä»£ç ä»“åº“ä¸­ã€‚\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152name: FaceMan&#x27;s Blog CI/CD # è„šæœ¬ workflow åç§°on:  push:    branches: [main, master] # å½“ç›‘æµ‹ main,master çš„ push    paths: # ç›‘æµ‹æ‰€æœ‰ source ç›®å½•ä¸‹çš„æ–‡ä»¶å˜åŠ¨ï¼Œæ‰€æœ‰ yml,json åç¼€æ–‡ä»¶çš„å˜åŠ¨ã€‚      - &#x27;*.json&#x27;      - &#x27;**.yml&#x27;      - &#x27;**/source/**&#x27;jobs:  blog: # ä»»åŠ¡åç§°    timeout-minutes: 30 # è®¾ç½® 30 åˆ†é’Ÿè¶…æ—¶    runs-on: ubuntu-latest # æŒ‡å®šæœ€æ–° ubuntu ç³»ç»Ÿ    steps:      - uses: actions/checkout@v2 # æ‹‰å–ä»“åº“ä»£ç       - uses: actions/setup-node@v2 # è®¾ç½® node.js ç¯å¢ƒ        with:          node-version: &#x27;18&#x27;  # æ ¹æ®ä½ çš„ Node.js ç‰ˆæœ¬è¿›è¡Œè°ƒæ•´      - name: Cache node_modules # ç¼“å­˜ node_modulesï¼Œæé«˜ç¼–è¯‘é€Ÿåº¦ï¼Œæ¯•ç«Ÿæ¯æœˆåªæœ‰ 2000 åˆ†é’Ÿã€‚        uses: actions/cache@v2        env:          cache-name: cache-node-modules        with:          path: ~/.npm          key: $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-$&#123;&#123; hashFiles(&#x27;**/package-lock.json&#x27;) &#125;&#125;          restore-keys: |            $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-            $&#123;&#123; runner.os &#125;&#125;-build-            $&#123;&#123; runner.os &#125;&#125;-      - name: Init Node.js # å®‰è£…æºä»£ç æ‰€éœ€æ’ä»¶        run: |          npm install          echo &quot;init node successful&quot;      - name: Install Hexo-cli # å®‰è£… Hexo        run: |          npm install -g hexo-cli --save          echo &quot;install hexo successful&quot;      - name: Build Blog # ç¼–è¯‘åˆ›å»ºé™æ€åšå®¢æ–‡ä»¶        run: |          hexo clean          hexo g          # echo &quot;è‡ªå®šä¹‰åŸŸå&quot; &gt; public/CNAME          echo &quot;build blog successful&quot;      - name: FaceMan&#x27;s Blog # è®¾ç½® git ä¿¡æ¯å¹¶æ¨é€é™æ€åšå®¢æ–‡ä»¶        run: |          git config --global user.name &quot;your name&quot;          git config --global user.email &quot;your email&quot;          hexo deploy      - run: echo &quot;Deploy Successful!&quot;\n\nå¦‚æœéœ€è¦åŠ è‡ªå®šä¹‰åŸŸåï¼Œå°±æŠŠè„šæœ¬ä¸­è‡ªå®šä¹‰åŸŸåæ›¿æ¢ä¸ºä½ çš„åŸŸåï¼Œå¹¶ä¸”åˆ é™¤#ã€‚\nä»£ç æäº¤å‰éœ€è¦æ£€æŸ¥ä¸‹æ˜¯å¦å·²å®‰è£…ä¸€é”®éƒ¨ç½²æ’ä»¶ hexo-deployer-gitã€‚\n12npm install hexo-deployer-git --save\n\nè‹¥æç¤º Deployer not found: git åˆ™è¯´æ˜å°šæœªå¼•å…¥è¯¥æ’ä»¶ä¾èµ–ã€‚\nä»£ç æäº¤åä¼šè‡ªåŠ¨æ‰§è¡Œ Actionsï¼Œå¯æŸ¥çœ‹éƒ¨ç½²è®°å½•åŠæ—¥å¿—ï¼Œéƒ¨ç½²å¤±è´¥ä¹Ÿä¼šæœ‰é‚®ä»¶æé†’ã€‚\n\n","slug":"ä½¿ç”¨Qexoå®Œæˆå¯¹Hexoåšå®¢çš„ç®¡ç†å’Œè‡ªåŠ¨åŒ–å‘å¸ƒ","date":"2024-11-28T00:00:00.000Z","categories_index":"","tags_index":"Hexo","author_index":"FaceMan"},{"id":"2fad6525e464e362f1913614556fcda3","title":"è¿ç»´å¸¸ç”¨å‘½ä»¤","content":"åœ¨æ“ä½œé¡¹ç›®éƒ¨ç½²çš„æ—¶å€™ï¼Œç»å¸¸ä¼šå¿˜è®°ä¸€äº›å‘½ä»¤ï¼Œä»è€Œç™¾åº¦æˆ–è€…gptï¼Œè¿™é‡Œè®°å½•ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤æ“ä½œã€‚\nDockeré…ç½®dockeré•œåƒåŠ é€Ÿå™¨12345678910111213141516171819202122vi /etc/docker/daemon.json&#123;    &quot;registry-mirrors&quot;: [&quot;https://docker.registry.cyou&quot;,  &quot;https://docker-cf.registry.cyou&quot;,  &quot;https://dockercf.jsdelivr.fyi&quot;,  &quot;https://docker.jsdelivr.fyi&quot;,  &quot;https://dockertest.jsdelivr.fyi&quot;,  &quot;https://mirror.aliyuncs.com&quot;,  &quot;https://dockerproxy.com&quot;,  &quot;https://mirror.baidubce.com&quot;,  &quot;https://docker.m.daocloud.io&quot;,  &quot;https://docker.nju.edu.cn&quot;,  &quot;https://docker.mirrors.sjtug.sjtu.edu.cn&quot;,  &quot;https://docker.mirrors.ustc.edu.cn&quot;,  &quot;https://mirror.iscas.ac.cn&quot;,  &quot;https://docker.rainbond.cc&quot;]  &#125;//é‡æ–°åŠ è½½é…ç½®systemctl daemon-reload//é‡å¯dockeræœåŠ¡systemctl restart docker\n\né…ç½®DNSæœåŠ¡å™¨1234567sudo nano /etc/systemd/resolved.conf//è¾“å…¥[Resolve]DNS=8.8.8.8 8.8.4.4//é‡å¯ç”Ÿæ•ˆsudo systemctl restart systemd-resolved.service\n\nå®¹å™¨ç›¸å…³å‘½ä»¤12345678910111213141516171819202122//å¯åŠ¨å®¹å™¨docker run -d --name nginx -p 80:80 nginx//è¿›å…¥å®¹å™¨docker exec -it nginx /bin/bash//æŸ¥çœ‹æ—¥å¿—docker logs nginx//æŸ¥çœ‹å®¹å™¨IPåœ°å€docker inspect nginx | grep IPAddress//æŸ¥çœ‹å½“å‰è¿è¡Œçš„å®¹å™¨docker ps//æŸ¥çœ‹æ‰€æœ‰å®¹å™¨docker ps -a//å¯åŠ¨å®¹å™¨docker start nginx//åœæ­¢å®¹å™¨docker stop nginx//é‡å¯å®¹å™¨docker restart nginx//åˆ é™¤å®¹å™¨docker rm nginx//åˆ é™¤æ‰€æœ‰åœæ­¢çš„å®¹å™¨docker container prune\n\né•œåƒç›¸å…³å‘½ä»¤123456789//æ‹‰å–é•œåƒdocker pull nginx//æŸ¥çœ‹æœ¬åœ°é•œåƒdocker images//åˆ é™¤é•œåƒdocker rmi nginx//åˆ é™¤æ‰€æœ‰é•œåƒdocker rmi $(docker images -q)\n\nç½‘ç»œç›¸å…³å‘½ä»¤123456789//æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œdocker network ls//åˆ›å»ºç½‘ç»œdocker network create my-net//åˆ é™¤ç½‘ç»œdocker network rm my-net//è¿æ¥åˆ°ç½‘ç»œdocker run -d --name nginx --net my-net -p 80:80 nginx\n\næ•°æ®å·ç›¸å…³å‘½ä»¤123456789//åˆ›å»ºæ•°æ®å·docker volume create my-vol//æŸ¥çœ‹æ•°æ®å·docker volume ls//æŒ‚è½½æ•°æ®å·docker run -d --name nginx -v my-vol:/usr/share/nginx/html nginx//åˆ é™¤æ•°æ®å·docker volume rm my-vol\n\nå…¶ä»–å‘½ä»¤123456789101112131415161718//æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤docker//æŸ¥çœ‹ç‰ˆæœ¬docker version//æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯docker info//ç™»å½•é•œåƒä»“åº“docker login//é€€å‡ºé•œåƒä»“åº“docker logout//å¯¼å‡ºé•œåƒdocker save -o my-image.tar my-image//å¯¼å…¥é•œåƒdocker load -i my-image.tar//å¯¼å…¥/å¯¼å‡ºå®¹å™¨docker export my-container &gt; my-container.tardocker import my-container.tar\n\nDocker Composeå‘½ä»¤ V2çš„å†™æ³•1234567//å¯åŠ¨å®¹å™¨docker compose up -d//åœæ­¢å®¹å™¨docker compose stop//åˆ é™¤å®¹å™¨docker compose down\n\nDocker Stack123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//åˆ›å»ºstackdocker stack deploy -c docker-compose.yml my-stack//æ›´æ–°stackdocker stack deploy -c docker-compose.yml my-stack//åˆ é™¤stackdocker stack rm my-stack//æŸ¥çœ‹stackdocker stack ls//æŸ¥çœ‹stackçš„æœåŠ¡docker stack services my-stack//æŸ¥çœ‹stackçš„å®¹å™¨docker stack ps my-stack//æŸ¥çœ‹stackçš„æ—¥å¿—docker stack logs my-stack//æŸ¥çœ‹stackçš„é…ç½®docker stack config my-stack//æŸ¥çœ‹stackçš„èŠ‚ç‚¹docker node ls//æŸ¥çœ‹èŠ‚ç‚¹çš„æœåŠ¡docker node ps node-name//æŸ¥çœ‹èŠ‚ç‚¹çš„å®¹å™¨docker node ps node-name//æŸ¥çœ‹èŠ‚ç‚¹çš„æ—¥å¿—docker node logs node-name//æŸ¥çœ‹èŠ‚ç‚¹çš„é…ç½®docker node inspect node-name//æ·»åŠ èŠ‚ç‚¹docker swarm join-token manager//åˆ é™¤èŠ‚ç‚¹docker swarm leave --force//æ›´æ–°èŠ‚ç‚¹docker node update node-name --availability drain//æ›´æ–°æœåŠ¡docker service update --image nginx my-stack_nginx//æ›´æ–°stackdocker stack deploy -c docker-compose.yml my-stack//æŸ¥çœ‹æœåŠ¡çš„å¥åº·çŠ¶æ€docker service ps my-stack_nginx//é‡æ–°éƒ¨ç½²æœåŠ¡docker service update --force my-stack_nginx//åˆ é™¤æœåŠ¡docker service rm my-stack_nginx//æŸ¥çœ‹æœåŠ¡çš„æ—¥å¿—docker service logs my-stack_nginx//æŸ¥çœ‹æœåŠ¡çš„é…ç½®docker service inspect my-stack_nginx//æŸ¥çœ‹æœåŠ¡çš„èŠ‚ç‚¹docker service ps my-stack_nginx --no-trunc\n\nLinuxæ–‡ä»¶ç›¸å…³å‘½ä»¤123456789101112131415161718192021222324// åˆ›å»ºæ–‡ä»¶å¤¹mkdir myfolder// åˆ‡æ¢ç›®å½•cd myfolder// æŸ¥çœ‹å½“å‰ç›®å½•pwd// æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ls// æŸ¥çœ‹æ–‡ä»¶å†…å®¹cat file.txt // å¤åˆ¶æ–‡ä»¶cp file1.txt file2.txt // ç§»åŠ¨æ–‡ä»¶mv file1.txt file2.txt // åˆ é™¤æ–‡ä»¶rm file.txt // åˆ é™¤æ–‡ä»¶å¤¹rm -r myfolder // åˆ›å»ºæ–‡ä»¶touch file.txt // ç¼–è¾‘æ–‡ä»¶vi file.txt // ç¼–è¾‘æ–‡ä»¶ï¼Œå¹¶ä¿å­˜é€€å‡º:wq \n\nå‹ç¼©è§£å‹ç›¸å…³å‘½ä»¤123456789101112// å‹ç¼©æ–‡ä»¶tar -cvf file.tar file1.txt file2.txt // è§£å‹æ–‡ä»¶tar -xvf file.tar // å‹ç¼©æ–‡ä»¶å¤¹tar -zcvf file.tar.gz folder // è§£å‹æ–‡ä»¶å¤¹tar -zxvf file.tar.gz // å‹ç¼©æ–‡ä»¶ï¼Œå¹¶æŒ‡å®šå‹ç¼©çº§åˆ«tar -zcvf - file1.txt file2.txt | pv -l &gt;/dev/null // è§£å‹æ–‡ä»¶ï¼Œå¹¶æ˜¾ç¤ºè¿›åº¦æ¡tar -zxvf file.tar.gz | pv -l &gt;/dev/null \n\nç½‘ç»œç›¸å…³å‘½ä»¤12345678910111213141516// æŸ¥çœ‹ç½‘ç»œä¿¡æ¯ifconfig // æŸ¥çœ‹è·¯ç”±ä¿¡æ¯route // æŸ¥çœ‹ç«¯å£ä¿¡æ¯netstat -anp // æŸ¥çœ‹ç«¯å£æ˜¯å¦è¢«å ç”¨lsof -i:8080 // æŸ¥çœ‹ç½‘ç»œè¿æ¥ä¿¡æ¯ss -tuln // æŸ¥çœ‹ç½‘ç»œè¿æ¥ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤ºè¿›åº¦æ¡ss -tuln | pv -l &gt;/dev/null // æŸ¥çœ‹ç½‘ç»œè¿æ¥ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ss -tuln -o state established &#x27;( dport = :ssh or sport = :ssh )&#x27; // æŸ¥çœ‹ç½‘ç»œè¿æ¥ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤ºè¿›åº¦æ¡ss -tuln -o state established &#x27;( dport = :ssh or sport = :ssh )&#x27; | pv -l &gt;/dev/null \n\né˜²ç«å¢™ç›¸å…³å‘½ä»¤12345678910// å¼€å¯é˜²ç«å¢™systemctl start firewalld // å…³é—­é˜²ç«å¢™systemctl stop firewalld // æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€systemctl status firewalld // å…è®¸ç«¯å£firewall-cmd --zone=public --add-port=8080/tcp --permanent // é‡å¯é˜²ç«å¢™firewall-cmd --reload \n\nNugetå‘½ä»¤1234567891011121314151617// å®‰è£…åŒ…nuget install PackageName// å¸è½½åŒ…nuget uninstall PackageName// æ›´æ–°åŒ…nuget update PackageName// å‘å¸ƒåŒ…nuget push PackageName.nupkg -Source https://api.nuget.org/v3/index.jsonå‘å¸ƒæ‚¨çš„ç¬¬ä¸€ä¸ªåŒ…ï¼šdotnet nuget push -s http://localhost:5555/v3/index.json -k NUGET-SERVER-API-KEY package.1.0.0.nupkgå‘å¸ƒæ‚¨çš„ç¬¬ä¸€ä¸ªå…ƒä»¶åŒ…ï¼šdotnet nuget push -s http://localhost:5555/v3/index.json -k NUGET-SERVER-API-KEY symbol.package.1.0.0.snupkg// åˆ—å‡ºåŒ…nuget list// åˆ—å‡ºåŒ…ï¼Œå¹¶æ˜¾ç¤ºç‰ˆæœ¬å·nuget list -AllVersions\n\nGitå‘½ä»¤123456789101112131415161718192021222324252627282930// å…‹éš†ä»“åº“git clone https://github.com/username/repository.git// åˆ‡æ¢åˆ†æ”¯git checkout branch-name// åˆ›å»ºåˆ†æ”¯git branch branch-name// åˆå¹¶åˆ†æ”¯git merge branch-name// æŸ¥çœ‹çŠ¶æ€git status// æ·»åŠ æ–‡ä»¶git add file-name// æäº¤æ–‡ä»¶git commit -m &quot;commit message&quot;// æ¨é€åˆ°è¿œç¨‹ä»“åº“git push origin branch-name// æ‹‰å–è¿œç¨‹ä»“åº“git pull origin branch-name// æŸ¥çœ‹æ—¥å¿—git log// æ’¤é”€ä¸Šä¸€æ¬¡æäº¤git reset --hard HEAD^// æ’¤é”€æ‰€æœ‰æäº¤git reset --hard origin/master// å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬git reset --hard commit-id// åˆ é™¤è¿œç¨‹åˆ†æ”¯git push origin --delete branch-name// åˆ é™¤æœ¬åœ°åˆ†æ”¯git branch -d branch-name\n\nDotNetå‘½ä»¤1234567891011121314// ç¼–è¯‘é¡¹ç›®dotnet build// è¿è¡Œé¡¹ç›®dotnet run// å‘å¸ƒé¡¹ç›®dotnet publish -c Release -o ./bin/bash// æ·»åŠ åŒ…dotnet add package PackageName// è¿˜åŸåŒ…dotnet restore// è¿è¡Œå•å…ƒæµ‹è¯•dotnet test// è¿è¡Œdotnetå‘½ä»¤dotnet --info\n","slug":"è¿ç»´å¸¸ç”¨å‘½ä»¤","date":"2024-11-28T00:00:00.000Z","categories_index":"DevOps","tags_index":"Docker,Linux","author_index":"FaceMan"},{"id":"15cdd7edd7d25fc2ae3b2ddd5c892e87","title":"åŠ¨æ€APIé›†æˆ","content":"åœ¨æ—¥å¸¸å¼€å‘æ—¶ï¼Œæƒ³è¦ç”¨åˆ°Swaggerå°±å¿…é¡»å¾—åˆ›å»ºæ§åˆ¶å™¨åˆ›å»ºæ¥å£æ–‡æ¡£ï¼Œä¸€èˆ¬ä¸šåŠ¡å¤„ç†éƒ½ä¸ä¼šåœ¨æ§åˆ¶å™¨ä¸­å¤„ç†ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå†åˆ›å»ºå¦ä¸€ä¸ªç±»æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæ¯æ¬¡åˆ›å»ºéƒ½ä¸¤ä¸ªç±»å°±å¾ˆç¹çï¼Œè¿™ç¯‡æ–‡ç« å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªç¹çï¼Œå…³å¿ƒæºç çš„æœ‹å‹å¯ä»¥ç›´æ¥å‚è€ƒæˆ‘çš„æ–‡ç« ï¼š!åŠ¨æ€APIé›†æˆæºç è§£æç‰ˆï¼Œæˆ–è€…å»githubä¸Šä¸‹è½½æºç ï¼š!åŠ¨æ€APIä»“åº“ã€‚\nåŠŸèƒ½åŠ¨æ€æ‰«æç”ŸæˆSwagger APIæ¥å£ã€‚æ”¯æŒä¸‰ç§æ–¹å¼ï¼š\n\nç»§æ‰¿IApplicationServiceæ¥å£\næ ‡è®°DynamicWebApiç‰¹æ€§\nåŸç”ŸApiController\n\næ•™ç¨‹å¿…è¦é…ç½®ï¼šåœ¨appsettings.jsoné…ç½®è¯·æ±‚ç±»å‹è§„åˆ™,ä¾‹å¦‚ä»¥Getæˆ–è€…Queryå¼€å¤´çš„æ–¹æ³•ï¼Œå°±ä¼šè¢«è¯†åˆ«ä¸ºGetç±»å‹ã€‚\n123456789101112131415161718&quot;HttpMethodInfo&quot;: [  &#123;    &quot;MethodKey&quot;: &quot;Get&quot;,    &quot;MethodVal&quot;: [ &quot;GET&quot;, &quot;QUERY&quot; ]  &#125;,  &#123;    &quot;MethodKey&quot;: &quot;Post&quot;,    &quot;MethodVal&quot;: [ &quot;CREATE&quot;, &quot;SAVE&quot;, &quot;INSERT&quot;, &quot;ADD&quot; ]  &#125;,  &#123;    &quot;MethodKey&quot;: &quot;Put&quot;,    &quot;MethodVal&quot;: [ &quot;UPDATE&quot;, &quot;EDIT&quot; ]  &#125;,  &#123;    &quot;MethodKey&quot;: &quot;Delete&quot;,    &quot;MethodVal&quot;: [ &quot;Delete&quot;, &quot;REMOVE&quot;, &quot;Del&quot; ]  &#125;]\n\nä¹Ÿè‡ªå®šä¹‰httpç‰¹æ€§ï¼Œè·ŸControllerä¸€æ ·åŠ [HttpPost]å°±å¯ä»¥äº†\nåœ¨Programè®¾ç½®Swaggeré…ç½®é¡¹\n123456789101112var conifg = new SwaggerConfigParam()&#123;    Title = &quot;FaceMan API&quot;,    Version = &quot;v1&quot;,    HttpMethods = builder.Configuration.GetSection(&quot;HttpMethodInfo&quot;).Get&lt;List&lt;HttpMethodConfigure&gt;&gt;()&#125;;builder.Services.AddDynamicApi(builder.Environment.WebRootPath, conifg);//å…¶ä»–é…ç½®app.UseSwagger(conifg);\n\nç”¨æ³•å‚è€ƒExample\nå…¶ä»–é…ç½®é¡¹æ–‡æ¡£æ³¨é‡Š1ã€è¦å¼€å¯æ–‡æ¡£æ³¨é‡Šï¼Œé¦–å…ˆéœ€è¦åœ¨ç±»åº“å±æ€§ä¸­è®¾ç½®XMLæ–‡ä»¶è·¯å¾„2ã€å¯ç”¨SwaggerConfigParamçš„æ–‡æ¡£æ³¨é‡Šé…ç½®\n123456var conifg = new SwaggerConfigParam()&#123;    //å…¶ä»–é…ç½®    EnableXmlComments=ture,    ApiDocsPath = &quot;ApiDocs&quot;&#125;;\n\n3ã€åœ¨å¯åŠ¨é¡¹ç›®å±æ€§é¡µé…ç½®å¦‚ä¸‹ä»£ç è¿™é‡Œç±»åº“å‘½åæœ€å¥½æœ‰ä¸ªé€šç”¨å‰ç¼€ï¼Œä¸ç„¶åªèƒ½ä¸€æ¡æ¡å†™äº†ï¼Œæ¯”å¦‚FaceMan.Webã€FaceMan.Domain\n12345678910111213141516171819   &lt;PropertyGroup&gt;    &lt;!--å…¶ä»–é…ç½®--&gt;\t&lt;ApiDocDir&gt;wwwroot\\ApiDocs&lt;/ApiDocDir&gt;&lt;/PropertyGroup&gt;&lt;!--åœ¨æ„å»ºé¡¹ç›®åï¼Œå¤åˆ¶æ‰€æœ‰ä»¥FaceManå¼€å¤´çš„XMLæ–‡æ¡£æ–‡ä»¶åˆ°æŒ‡å®šçš„APIæ–‡æ¡£ç›®å½•ã€‚è¿™é€šå¸¸ç”¨äºå°†ç”Ÿæˆçš„XMLæ–‡æ¡£æ–‡ä»¶ï¼ˆä¾‹å¦‚APIæ³¨é‡Šï¼‰æ•´ç†åˆ°ä¸€ä¸ªç›®å½•ä¸­ï¼Œä¾¿äºè¿›ä¸€æ­¥çš„å¤„ç†æˆ–å‘å¸ƒã€‚è¿™ç§åšæ³•å¯ä»¥é€‚åˆäºç”ŸæˆAPIæ–‡æ¡£å¦‚Swaggeræ—¶çš„ä½¿ç”¨åœºæ™¯ã€‚--&gt;&lt;Target Name=&quot;CopyXmlDocFileForBuild&quot; AfterTargets=&quot;Build&quot;&gt;\t&lt;ItemGroup&gt;\t\t&lt;XmlDocFiles Include=&quot;$(OutDir)$(AssemblyName).xml&quot; /&gt;\t\t&lt;!--Include=&quot;@(ReferencePath-&gt;&#x27;%(RootDir)%(Directory)%(Filename).xml&#x27;)&quot;ï¼šè¿™è¡Œè¡¨ç¤ºä»æ‰€æœ‰é¡¹ç›®å¼•ç”¨ï¼ˆReferencePathï¼‰çš„è·¯å¾„ä¸­æ”¶é›†ä»¥.xmlä¸ºæ‰©å±•åçš„æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶é€šå¸¸æ˜¯ç”Ÿæˆçš„XMLæ–‡æ¡£æ–‡ä»¶ã€‚--&gt;\t\t&lt;!--Condition=&quot;$([System.String]::new(&#x27;%(FileName)&#x27;).StartsWith(&#x27;FaceMan&#x27;))&quot;ï¼šæ­¤æ¡ä»¶ç”¨äºè¿‡æ»¤æ–‡ä»¶ï¼Œä»…åŒ…æ‹¬æ–‡ä»¶åä»¥FaceManå¼€å¤´çš„XMLæ–‡æ¡£æ–‡ä»¶ã€‚è¿™ä¿è¯åªæœ‰ç›¸å…³çš„æ–‡æ¡£æ–‡ä»¶è¢«é€‰æ‹©ã€‚--&gt;\t\t&lt;XmlDocFiles Include=&quot; @(ReferencePath-&gt;&#x27;%(RootDir)%(Directory)%(Filename).xml&#x27;)&quot; Condition=&quot;$([System.String]::new(&#x27;%(FileName)&#x27;).StartsWith(&#x27;FaceMan&#x27;))&quot; /&gt;\t&lt;/ItemGroup&gt;\t&lt;!--SourceFiles=&quot;@(XmlDocFiles)&quot;ï¼šæŒ‡å®šè¦å¤åˆ¶çš„æºæ–‡ä»¶ä¸ºä¸Šä¸€æ­¥ä¸­å®šä¹‰çš„XmlDocFilesé›†åˆã€‚--&gt;\t&lt;!--`Condition=&quot;Exists(&#x27;%(FullPath)&#x27;)&quot;ï¼šç¡®ä¿å¤åˆ¶å‰æºæ–‡ä»¶å­˜åœ¨ï¼Œè¿™æ˜¯ä¸€ç§å®‰å…¨æ£€æŸ¥ã€‚--&gt;\t&lt;!--DestinationFolder=&quot;$(ApiDocDir)&quot;ï¼šç›®çš„åœ°æ–‡ä»¶å¤¹ä¸º$(ApiDocDir)ï¼Œè¿™ä¸ªå±æ€§ä¹‹å‰å·²ç»åœ¨é¡¹ç›®æ–‡ä»¶ä¸­å®šä¹‰ï¼ŒæŒ‡å‘å­˜æ”¾APIæ–‡æ¡£çš„ç›®å½•ã€‚--&gt;\t&lt;!--SkipUnchangedFiles=&quot;true&quot;ï¼šæ­¤é€‰é¡¹è¡¨ç¤ºåªæœ‰å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶ä¼šè¢«å¤åˆ¶ï¼Œè¿™å¯ä»¥æé«˜æ•ˆç‡ï¼Œé¿å…ä¸å¿…è¦çš„å¤åˆ¶æ“ä½œã€‚--&gt;\t&lt;Copy SourceFiles=&quot;@(XmlDocFiles)&quot; Condition=&quot;Exists(&#x27;%(FullPath)&#x27;)&quot; DestinationFolder=&quot;$(ApiDocDir)&quot; SkipUnchangedFiles=&quot;true&quot; /&gt;&lt;/Target&gt;\n\né…ç½®å®Œå¯åŠ¨å°±å¯ä»¥çœ‹è§å•¦\nSwaggerç™»å½•é¡µä¸€èˆ¬æ¥è¯´Swaggeréƒ½ä¼šéœ€è¦ç™»å½•æ‰èƒ½è¿›è¡Œæ¥å£è°ƒç”¨ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªç™»å½•é¡µï¼Œå¦‚æœéœ€è¦é‰´æƒè¯·è‡ªå·±å®ç°ã€‚\n1234567var conifg = new SwaggerConfigParam()&#123;    //å…¶ä»–é…ç½®    EnableLoginPage=true,    WebRootPath=builder.Environment.WebRootPath,    LoginPagePath = &quot;pages/swagger.html&quot;&#125;;\n\nåœ¨wwwrootä¸‹pagesç›®å½•ä¸‹åˆ›å»ºswagger.htmlæ–‡ä»¶\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot; /&gt;    &lt;title&gt;Swagger UI&lt;/title&gt;    &lt;!-- ä½¿ç”¨ Swagger UI é»˜è®¤çš„ CSS æ ·å¼ --&gt;    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.0/swagger-ui.min.css&quot;&gt;    &lt;style&gt;        body &#123;            margin: 0;            padding: 0;            font-family: Arial, sans-serif;        &#125;        .swagger-ui .scheme-container &#123;            margin: 0px;            padding: 0px;        &#125;        .button-container &#123;            justify-content: center;            right: 5%;            top: 10%;            position: absolute        &#125;            .button-container button &#123;                margin: 0 10px;                padding: 10px 20px;                font-size: 14px;                border: none;                background-color: #1b1b1b;                color: #fff;                cursor: pointer;                border-radius: 4px;            &#125;    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;    &lt;div class=&quot;button-container&quot;&gt;        &lt;!--&lt;button id=&quot;hangfireButton&quot;&gt;è·³è½¬åˆ° Hangfire&lt;/button&gt;--&gt;        &lt;button id=&quot;logoutButton&quot;&gt;é€€å‡ºç™»å½•&lt;/button&gt;    &lt;/div&gt;    &lt;div id=&quot;swagger-ui&quot;&gt;&lt;/div&gt;    &lt;!-- åŠ è½½ Swagger UI çš„ JavaScript --&gt;    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.0/swagger-ui-bundle.min.js&quot;&gt;&lt;/script&gt;    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.1.0/swagger-ui-standalone-preset.min.js&quot;&gt;&lt;/script&gt;    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js&quot;&gt;&lt;/script&gt;    &lt;script&gt;        window.onload = function () &#123;            var configObject = JSON.parse(&#x27;%(ConfigObject)&#x27;);            const cookie = Cookies.get(&#x27;access-token&#x27;);            if (!cookie) &#123;                window.location.href = &#x27;/home/index&#x27;;            &#125;            // é…ç½® SwaggerUI            configObject.dom_id = &quot;#swagger-ui&quot;;            configObject.presets = [SwaggerUIBundle.presets.apis, SwaggerUIStandalonePreset];            configObject.layout = &quot;StandaloneLayout&quot;;            configObject.requestInterceptor = function (request) &#123;                // æ·»åŠ  Authorization å¤´                request.headers[&#x27;Authorization&#x27;] = &#x27;Bearer &#x27; + cookie;                return request;            &#125;;            // è®¾ç½® OAuth2 é‡å®šå‘ URL            if (!configObject.hasOwnProperty(&quot;oauth2RedirectUrl&quot;)) &#123;                configObject.oauth2RedirectUrl = window.location + &quot;oauth2-redirect.html&quot;;            &#125;            configObject.plugins = [                function (system) &#123;                    return &#123;                        components: &#123;                            authorizeBtn: function () &#123;                                return null;                            &#125;                        &#125;                    &#125;;                &#125;            ];            // åˆå§‹åŒ– Swagger UI            SwaggerUIBundle(configObject);            // è·³è½¬åˆ° Hangfire å¹¶æ‰“å¼€æ–°é¡µé¢            document.getElementById(&quot;hangfireButton&quot;).addEventListener(&quot;click&quot;, function () &#123;                window.open(&quot;/hangfire&quot;, &quot;_blank&quot;); // æ›¿æ¢ &quot;/hangfire&quot; ä¸ºæ­£ç¡®çš„ Hangfire é¡µé¢ URL            &#125;);            // é€€å‡ºç™»å½•å¹¶æ¸…é™¤ cookie            document.getElementById(&quot;logoutButton&quot;).addEventListener(&quot;click&quot;, function () &#123;                Cookies.remove(&quot;access-token&quot;); // æ¸…é™¤åä¸º &quot;access-token&quot; çš„ cookie                window.location.href = &quot;/Home/Index&quot;; // æ›¿æ¢ &quot;/home/logout&quot; ä¸ºæ­£ç¡®çš„é€€å‡ºç™»å½• URL            &#125;);        &#125;    &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;\n\næ–°å»ºä¸€ä¸ªLoginController\n123456789    public class LoginController : Controller    &#123;        // GET: LoginController        public ActionResult Index()        &#123;            return View();        &#125;    &#125;&#125;\n\næ–°å»ºIndexè§†å›¾\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;    &lt;title&gt;Document&lt;/title&gt;    &lt;style&gt;        * &#123;            padding: 0;            margin: 0;        &#125;        html &#123;            height: 100%;        &#125;        body &#123;            background-image: linear-gradient(to bottom right, rgb(114, 135, 254), rgb(130, 88, 186));        &#125;        .login-container &#123;            width: 600px;            /*  height: 315px; */            margin: 0 auto;            margin-top: 10%;            border-radius: 15px;            box-shadow: 0 10px 50px 0px rbg(59, 45, 159);            background-color: rgb(95, 76, 194);        &#125;        .left-container &#123;            display: inline-block;            width: 330px;            border-top-left-radius: 15px;            border-bottom-left-radius: 15px;            padding: 60px;            background-image: linear-gradient(to bottom right, rgb(118, 76, 163), rgb(92, 103, 211));        &#125;        .title &#123;            color: #fff;            font-size: 18px;            font-weight: 200;        &#125;            .title span &#123;                border-bottom: 3px solid rgb(237, 221, 22);            &#125;        .input-container &#123;            padding: 20px 0;        &#125;        input &#123;            border: 0;            background: none;            outline: none;            color: #fff;            margin: 20px 0;            display: block;            width: 100%;            padding: 5px 0;            transition: .2s;            border-bottom: 1px solid rgb(199, 191, 219);        &#125;            input:hover &#123;                border-bottom-color: #fff;            &#125;        ::-webkit-input-placeholder &#123;            color: rgb(199, 191, 219);        &#125;        .right-container &#123;            width: 145px;            display: inline-block;            height: calc(100% - 120px);            vertical-align: top;            padding: 60px 0;        &#125;        .action-container &#123;            font-size: 10px;            color: #fff;            text-align: center;            position: relative;            top: 200px;        &#125;            .action-container .btn &#123;                border: 1px solid rgb(237, 221, 22);                padding: 10px;                display: inline;                line-height: 20px;                border-radius: 20px;                position: absolute;                bottom: 10px;                left: calc(72px - 20px);                transition: .2s;                cursor: pointer;            &#125;                .action-container .btn:hover &#123;                    background-color: rgb(237, 221, 22);                    color: rgb(95, 76, 194);                &#125;    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;    &lt;div class=&quot;login-container&quot;&gt;        &lt;div class=&quot;left-container&quot;&gt;            &lt;div class=&quot;title&quot;&gt;&lt;span&gt;ç™»å½•&lt;/span&gt;&lt;/div&gt;            &lt;div class=&quot;input-container&quot;&gt;                &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; placeholder=&quot;ç”¨æˆ·å&quot;&gt;                &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;å¯†ç &quot;&gt;            &lt;/div&gt;        &lt;/div&gt;        &lt;div class=&quot;right-container&quot;&gt;            &lt;div class=&quot;action-container&quot;&gt;                &lt;button type=&quot;submit&quot; id=&quot;login-btn&quot; class=&quot;btn btn-primary&quot;&gt;ç™»å½•&lt;/button&gt;            &lt;/div&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;script src=&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot;&gt;&lt;/script&gt;&lt;script&gt;    $(document).ready(function () &#123;        // å½“è¡¨å•æäº¤æ—¶        $(&#x27;#login-btn&#x27;).click(function (event) &#123;            event.preventDefault(); // é˜²æ­¢é¡µé¢åˆ·æ–°            //$(&#x27;.error&#x27;).remove(); // ç§»é™¤å·²æœ‰çš„é”™è¯¯ä¿¡æ¯            var username = $(&#x27;#username&#x27;).val();            var password = $(&#x27;#password&#x27;).val();            // å‘èµ· AJAX è¯·æ±‚            $.ajax(&#123;                type: &#x27;get&#x27;,                contentType: &quot;application/json&quot;,                url: &#x27;@ViewBag.Url/api/Login/UserLogin?username=123&amp;password=456&#x27;,//ç™»å½•æ¥å£åœ°å€                // data: JSON.stringify(&#123;                //     username: username,                //     password: password                // &#125;),                success: function (response) &#123;                    window.location.href = &#x27;/swagger&#x27;;                &#125;,                error: function (response) &#123;                    // å¦‚æœè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œåˆ™æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š                    const exampleModal = document.getElementById(&#x27;exampleModal&#x27;)                    exampleModal.addEventListener(&#x27;show.bs.modal&#x27;, event =&gt; &#123;                        // Update the modal&#x27;s content.                        const modalTitle = exampleModal.querySelector(&#x27;.modal-title&#x27;);                        const modalBodyInput = exampleModal.querySelector(&#x27;.modal-body&#x27;);                        modalBodyInput.textContent = response?.responseJSON?.result?.error ?? &#x27;æœåŠ¡å™¨å¼‚å¸¸&#x27;;                    &#125;)                    $(&#x27;#whatever&#x27;).trigger(&#x27;click&#x27;);                &#125;            &#125;);        &#125;);    &#125;);&lt;/script&gt;\n\nè¯·æ±‚ç™»å½•æ¥å£æˆåŠŸä¹‹åå°±ä¼šè‡ªåŠ¨è·³è½¬Swaggerï¼Œåœ¨è°ƒç”¨æ¥å£æ—¶ä¼šè‡ªåŠ¨åŠ åˆ°è¯·æ±‚å¤´ï¼Œtokenè¿‡æœŸåä¼šè·³å›ç™»å½•é¡µé¢ã€‚\nä¸å¼€ç™»å½•é¡µï¼Œä½†éœ€è¦æƒé™æ ¡éªŒ123456var conifg = new SwaggerConfigParam()&#123;//å…¶ä»–é…ç½®EnableSimpleToken=trueEnableLoginPage=false&#125;;\n\n\n","slug":"åŠ¨æ€APIé›†æˆ","date":"2024-11-27T00:00:00.000Z","categories_index":".Net","tags_index":".Net,Swagger","author_index":"FaceMan"},{"id":"61d5ab16d3669ffca8733aef334b5fbf","title":"Switchæ¨¡æ‹Ÿå™¨-YuZu","content":"ä¸€èˆ¬å·¥ä½œåƒåˆé¥­çš„æ—¶å€™ï¼Œæˆ‘å–œæ¬¢æ‰“å¼€Bç«™æ‰¾ä¸ªä¸‹é¥­ç›´æ’­çœ‹çœ‹ï¼Œä¸€èˆ¬ä¼šé€‰æ‹©å¡å°”è¾¾ä¸»æ’­ç‹è–¯æ¡ï¼Œæœ‰ä¸€å¤©çªç„¶çœ‹åˆ°ä¸€æ¡å¼¹å¹•åœ¨é—®ä¸»æ’­ç”¨çš„æ¨¡æ‹Ÿå™¨è¿˜æ˜¯ä¸»æœºï¼Œè¿™è®©æˆ‘äº§ç”Ÿäº†å…´è¶£ï¼Œäºæ˜¯åœ¨æŸä¸€å¤©æ‘¸é±¼çš„æ—¶å€™æŠ˜è…¾å¼€å§‹ï¼\nèµ„æº+æ•™ç¨‹PCç«¯è§£å‹ä¹‹åç”¨ç®¡ç†å‘˜è¿è¡Œï¼Œå¯†é’¥æ˜¯å·²ç»å®‰è£…å¥½äº†çš„ï¼Œä¸‹å¥½æ¸¸æˆï¼Œè®¾ç½®æ¸¸æˆæ–‡ä»¶å¤¹å¼€ç©å°±è¡Œï¼Œè®°å¾—æå‰è®¾ç½®ä¸­æ–‡ã€‚\nè®¾ç½®è½¯ä»¶è¯­è¨€ï¼šæ¨¡æ‹Ÿ-ã€‹è®¾ç½®-ã€‹é€šç”¨-ã€‹ç•Œé¢-ã€‹ç•Œé¢è¯­è¨€\nè®¾ç½®æ¸¸æˆè¯­è¨€ï¼šæ¨¡æ‹Ÿ-ã€‹è®¾ç½®-ã€‹ç³»ç»Ÿ-ã€‹Languageå’ŒRegion\né“¾æ¥ï¼šï¼ˆå¡«å……ç™¾åº¦ç½‘ç›˜åŸŸåï¼Œè‡ªåˆ ï¼‰&#x2F;s&#x2F;1WOxIM2-TfkibbgJZ4o7Qjw?pwd&#x3D;1234æå–ç ï¼š1234\nå®‰å“å› ä¸ºæˆ‘ç”¨çš„æ˜¯é˜¿é‡Œäº‘ç›˜ï¼Œä»–æ²¡æœ‰åŠæ³•è¿‡å¤šæ–‡ä»¶å’Œzipæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œå°±è´´ä¸€ä¸‹å¤§ç¥çš„ã€‚\nèµ„æºï¼šyuzuã€Skylineã€Cemuã€Citraã€Vita3kã€AetherSX2ã€PPSSPPæ¨¡æ‹Ÿå™¨ å’Œ å¼€æºé©±åŠ¨ä¸‹è½½\næ•™ç¨‹ï¼šæ•™ä½ æ‰‹æœºå˜switchï¼å®‰å“yuzuæ¨¡æ‹Ÿå™¨æœ€å¼ºä¿å§†çº§å®‰è£…ä½¿ç”¨æ•™ç¨‹\næ¸¸æˆèµ„æºæ¸ é“ä¸€ï¼šè´´å§\nè´´å§é‡Œå¾ˆå¤šå¤§ç¥è€å“¥æ•´ç†çš„å¾ˆå¥½ï¼Œä½ å¯ä»¥åˆ°é‚£é‡Œå»æ‰¾èµ„æº\næ¸ é“äºŒï¼šVXå…¬ä¼—å·\n\nç”µç©è”ç›Ÿ\né¹¿æ«å ‚æ¸¸æˆ\nNSå¤´å·ç”µç©\nNSå¤´å·ç©å®¶\n\næ¸ é“ä¸‰ï¼šç½‘é¡µ\n\nSwitch520ï¼ˆswitch520æœ€æ–°ï¼‰\nç©å®¶èšä¼šçš„ç½‘ç«™ - Powered by Discuz!ï¼ˆ91æœ€æ–°ç½‘ç«™ï¼Œéœ€è¦ä¸€äº›ç­¾åˆ°ç§¯åˆ†ï¼‰\nnsboyï¼ˆå†·é—¨è®ºå›ï¼‰\nSwitch618ï¼ˆç±»ä¼¼520ï¼‰\nRuTracker.orgï¼ˆæ¯›å­æœ€å¤§è®ºå›ï¼Œæœ‰æ—¶å€™ä¸éœ€è¦æ¢¯ï¼‹æ³¨å†Œï¼‹ç¿»è¯‘ï¼‰\n\n","slug":"yuzu","date":"2024-11-26T00:00:00.000Z","categories_index":"æ—¥å¸¸","tags_index":"ç”Ÿæ´»éšç¬”,Swtich","author_index":"FaceMan"},{"id":"e39417a60f2c78600e5ff58d1d0519aa","title":"ä½¿ç”¨Hugoæ­å»ºä¸ªäººåšå®¢","content":"å…ˆæ¥è¯´è¯´å†™è¿™ç¯‡åšå®¢çš„ç¼˜ç”±\nä¸€ä¸ªç¨‹åºå‘˜æœ€å¥½çš„é—¨é¢æ˜¯å•¥ï¼Ÿé™¤äº†githubæ‹¥æœ‰staræ•°é«˜çš„å¼€æºé¡¹ç›®ä¹‹å¤–å½“ç„¶æ˜¯ä¸ªäººåšå®¢ï¼Œæ— è®ºæ˜¯æŠ€æœ¯ç§¯ç´¯è¿˜æ˜¯æ‰¾å·¥ä½œï¼Œæœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„ä¸ªäººåšå®¢æ— ç–‘æ˜¯åŠ åˆ†é¡¹ï¼Œç°åœ¨githubä¸Šæœ‰å„ç§å¼€æºçš„åšå®¢ç³»ç»Ÿï¼Œä¼˜ç‚¹æ˜¯åŠŸèƒ½å¾ˆå¤šï¼Œä½†éƒ½æœ‰ä¸ªé—®é¢˜å°±æ˜¯å¤§ï¼Œæˆ‘ä¹‹å‰ç”¨Javaçš„oneblogé¡¹ç›®éƒ¨ç½²äº†ä¸€ä¸ªåšå®¢ï¼Œä½†ç”±äºæˆ‘æ˜¯ä¹°çš„é˜¿é‡Œäº‘2æ ¸2gæœåŠ¡å™¨ï¼Œéƒ¨ç½²ä¸Šå»ä¹‹åç”±äºå¤ªå¤§ç³»ç»Ÿå´©äº†ï¼Œæˆ‘é‡å¯äº†3æ¬¡æ‰åœ¨dockeré‡å¯ä¹‹å‰å…³æ‰ï¼Œå°±å¾ˆå°´å°¬ã€‚åé¢æƒ³äº†ä¸ªåŠæ³•æ˜¯éƒ¨ç½²åˆ°è‡ªå·±çš„ç”µè„‘çš„è™šæ‹Ÿæœºä¸Šï¼Œç„¶åé€šè¿‡frp+nginxæ˜ å°„å‡ºå»ï¼Œä½†é—®é¢˜åˆæ¥äº†ï¼Œæˆ‘æ˜¯ç¬”è®°æœ¬æ²¡æœ‰åŠæ³•ä¿è¯åƒæœåŠ¡å™¨ä¸€æ ·ä¸€ç›´è¿è¡Œç€ï¼Œäºæ˜¯ï¼Œæˆ‘æ‘†çƒ‚äº†ã€‚åé¢åˆ·Bç«™çš„æ—¶å€™çœ‹åˆ°äº†æ•°å­—æ¸¸ç‰§äººçš„ä¸€ä¸ªè§†é¢‘ï¼Œäº†è§£åˆ°äº†hugoè¿™ä¸ªä¸œè¥¿ï¼Œäºæ˜¯æˆ‘ç¢ç£¨äº†ä¸€å¤©å¼„äº†ä¸ªåšå®¢å‡ºæ¥ï¼Œè¸©äº†ä¸€äº›å‘ï¼Œæ‰€ä»¥æœ‰äº†ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œè¡¥å……å®Œæ•´ç»™æ–°æ‰‹å°ç™½ä»¬é¿å‘ã€‚\nå¿…è¦æ¡ä»¶å®‰è£…å’Œéƒ¨ç½²ç½‘ä¸Šæ•™ç¨‹å¾ˆå¤šï¼Œæˆ‘è¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ã€‚\nåœ¨github.ioå®‰è£…éƒ¨ç½²ä¸ªäººåšå®¢hugo\nTips1.è‡ªå®šä¹‰åŸŸåå‰æï¼šéœ€è¦æœ‰ä¸€ä¸ªè‡ªå·±çš„åŸŸåï¼Œå¦‚æœæƒ³ä»¥httpsè®¿é—®è¿˜éœ€è¦é…ç½®è¯ä¹¦ã€‚\nå¦‚æœä¸æƒ³ç”¨github.ioåšç»“å°¾ï¼Œå¯ä»¥åˆ°githubé¡¹ç›®çš„Pageé¡µè®¾ç½®è‡ªåŸŸåï¼ˆCustom domainï¼‰ï¼Œç„¶ååœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œæ·»åŠ è§£æè®°å½•ï¼Œè§£æç±»å‹é€‰æ‹©CNAMEï¼Œä¸»æœºè®°å½•å¡«@ï¼Œè®°å½•å€¼å¡«ä½ çš„github.ioçš„åŸŸåï¼Œä¿å­˜å³å¯ã€‚æˆ‘å› ä¸ºè§£æçš„æ˜¯æ³›åŸŸåï¼Œç„¶ååˆç”¨çš„äºŒçº§åŸŸåæ‰€ä»¥æˆ‘ç”¨nginxåšäº†ä¸€æ¬¡è½¬å‘ï¼Œä¸è¿™ä¹ˆåšnginxé…ç½®å¯ä»¥å¿½ç•¥ã€‚\n1.é…ç½®nginxä»£ç†123456789101112131415161718192021222324error_log /var/log/nginx/error.log;    server &#123;        listen 80;        listen 443 ssl;        server_name blog.faceman.cn; # ä½ çš„åŸŸå        ssl_protocols TLSv1.2 TLSv1.1 TLSv1;           ssl_certificate      /domains/fullchain.pem; # è¯ä¹¦ä½ç½®        ssl_certificate_key  /domains/key.key; # è¯ä¹¦ä½ç½®        ssl_prefer_server_ciphers on;         ssl_session_timeout  5m;        if ($server_port = 80) &#123;        rewrite ^(.*)$ https://$host$1 permanent;        &#125;        location / &#123;            proxy_pass https://faceman0814.github.io; # æ˜ å°„åœ°å€            proxy_set_header Host $host;            proxy_set_header X-Real-IP $remote_addr;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;            root /home/web/;            index index.php;        &#125;    &#125;\n\né‡å¯nginxå³å¯\n2.è®¾ç½®è‡ªåŸŸå\n2.éƒ¨ç½²è„šæœ¬ä¸ºäº†ç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œæˆ‘å†™äº†ä¸€å¥—Windowsç‰ˆæœ¬çš„è„šæœ¬åˆ†äº«ç»™å¤§å®¶\n12345678910111213141516171819202122232425262728param(    [string]$commitMessage = &quot;åšå®¢æ›´æ–°&quot;)# è¾“å‡ºéƒ¨ç½²æ›´æ–°ä¿¡æ¯Write-Host &quot;æ­£åœ¨éƒ¨ç½²åˆ°GitHub...&quot; -ForegroundColor Green# æ„å»ºé¡¹ç›®&amp; hugo# è¿›å…¥Publicæ–‡ä»¶å¤¹Set-Location public# å°†æ›´æ”¹æ·»åŠ åˆ°gitgit add .# æäº¤æ›´æ”¹Write-Host $commitMessage -ForegroundColor Greengit commit -m $commitMessage# æ‹‰å–æœ€æ–°çš„è¿œç¨‹ä»“åº“æ›´æ”¹ä»¥é¿å…å†²çªgit pull origin main# æ¨é€æºå’Œæ„å»ºä»“åº“git push origin main# è¿”å›åˆ°é¡¹ç›®æ ¹ç›®å½•Set-Location ..\n\næ ¹ç›®å½•ä¸‹é¢ä¿å­˜ä¸ºdeploy.ps1(powershellè„šæœ¬æ ¼å¼)\n12//åœ¨æ ¹ç›®å½•ä¸‹è¿è¡Œ/deploy.ps1 &quot;æäº¤å†…å®¹&quot; //é»˜è®¤æäº¤å†…å®¹ä¸ºåšå®¢æ›´æ–°\n\næˆ‘ç”¨çš„anankeä¸»é¢˜æœ‰äº›å°é—®é¢˜ï¼Œæ¯”å¦‚ï¼š\n\ngithubåœ°å€ç”Ÿæˆçš„æ—¶å€™ä¼šæœ‰äº›ä¹±ç å¯¼è‡´è·³è½¬404\né™æ€å›¾ç‰‡éƒ¨ç½²çš„æ—¶å€™ä¼šè¢«æŸå\n\næˆ‘åœ¨è„šæœ¬å¤„ç†ï¼Œå¦‚æœä½ ä»¬æ²¡æœ‰è¿™ä¸ªé—®é¢˜å¯ä»¥ç•¥è¿‡ã€‚\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849param(    [string]$commitMessage = &quot;åšå®¢æ›´æ–°&quot;)# è¾“å‡ºéƒ¨ç½²æ›´æ–°ä¿¡æ¯Write-Host &quot;æ­£åœ¨éƒ¨ç½²åˆ°GitHub...&quot; -ForegroundColor Green# æ„å»ºé¡¹ç›®&amp; hugo# è¿›å…¥Publicæ–‡ä»¶å¤¹Set-Location public# æ‰«ææ‰€æœ‰æ–‡ä»¶å¹¶æ›¿æ¢æŒ‡å®šå­—ç¬¦ä¸²$replacements = @&#123;    &quot;https://github.com/faceman0814%25!%28EXTRA%20%3cnil%3e%29&quot; = &quot;https://github.com/faceman0814&quot;;&#125;# æ‰«ææ‰€æœ‰æ–‡ä»¶å¹¶æ›¿æ¢æŒ‡å®šå­—ç¬¦ä¸²Get-ChildItem -Recurse | Where-Object &#123; !$_.PSIsContainer &#125; | ForEach-Object &#123;    $content = Get-Content $_.FullName -Raw    foreach ($oldText in $replacements.Keys) &#123;        $newText = $replacements[$oldText]        $content = $content -replace [regex]::Escape($oldText), $newText    &#125;    Set-Content $_.FullName -Value $content&#125;# å¤åˆ¶ images æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„å›é€€åˆ°æ ¹ç›®å½•å†è®¿é—®static/images$sourcePath = &quot;..\\static\\images&quot;$destinationPath = &quot;.\\images&quot;Copy-Item -Path $sourcePath\\* -Destination $destinationPath -Force -Recurse# å°†æ›´æ”¹æ·»åŠ åˆ°gitgit add .# æäº¤æ›´æ”¹Write-Host $commitMessage -ForegroundColor Greengit commit -m $commitMessage# æ‹‰å–æœ€æ–°çš„è¿œç¨‹ä»“åº“æ›´æ”¹ä»¥é¿å…å†²çªgit pull origin main# æ¨é€æºå’Œæ„å»ºä»“åº“git push origin main# è¿”å›åˆ°é¡¹ç›®æ ¹ç›®å½•Set-Location ..\n\né¡µè„šåŠ è¿è¡Œæ—¶é—´åœ¨é¡µè„šåŠ å…¥ä»£ç \n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;div class=&quot;footer-container&quot;&gt;      &lt;span id=&quot;sitetime&quot;&gt;è½½å…¥è¿è¡Œæ—¶é—´...&lt;/span&gt; &lt;/div&gt;&lt;script&gt;  function siteTime() &#123;      var seconds = 1000;      var minutes = seconds * 60;      var hours = minutes * 60;      var days = hours * 24;      var years = days * 365;      var today = new Date();      var startYear = 2024;      var startMonth = 11;      var startDate = 8;      var startHour = 14;      var startMinute = 15;      var startSecond = 11;      var todayYear = today.getFullYear();      var todayMonth = today.getMonth() + 1;      var todayDate = today.getDate();      var todayHour = today.getHours();      var todayMinute = today.getMinutes();      var todaySecond = today.getSeconds();      var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);      var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);      var diff = t2 - t1;      var diffYears = Math.floor(diff / years);      var diffDays = Math.floor((diff / days) - diffYears * 365);      var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);      var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /          minutes);      var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -          diffMinutes * minutes) / seconds);      if (startYear == todayYear) &#123;          //document.getElementById(&quot;year&quot;).innerHTML = todayYear;          document.getElementById(&quot;sitetime&quot;).innerHTML = &quot;åšå®¢å·²è¿è¡Œ &quot; + diffDays + &quot; å¤© &quot; + diffHours +              &quot; å°æ—¶ &quot; + diffMinutes + &quot; åˆ†é’Ÿ &quot; + diffSeconds + &quot; ç§’&quot;;      &#125; else &#123;          //document.getElementById(&quot;year&quot;).innerHTML = startYear + &quot; - &quot; + todayYear;          document.getElementById(&quot;sitetime&quot;).innerHTML = &quot;åšå®¢å·²è¿è¡Œ &quot; + diffYears + &quot; å¹´ &quot; + diffDays +              &quot; å¤© &quot; + diffHours + &quot; å°æ—¶ &quot; + diffMinutes + &quot; åˆ†é’Ÿ &quot; + diffSeconds + &quot; ç§’&quot;;      &#125;  &#125;  setInterval(siteTime, 1000);&lt;/script&gt;\n\næ·»åŠ è®¿é—®é‡è®¡æ•°å·¥å…·1234567&lt;script async src=&quot;https://busuanzi.icodeq.com/busuanzi.pure.mini.js&quot;&gt;&lt;/script&gt;æœ¬æ–‡æ€»é˜…è¯»é‡ &lt;span id=&quot;busuanzi_value_page_pv&quot;&gt;&lt;/span&gt; æ¬¡æœ¬ç«™æ€»è®¿é—®é‡ &lt;span id=&quot;busuanzi_value_site_pv&quot;&gt;&lt;/span&gt; æ¬¡æœ¬ç«™æ€»è®¿å®¢æ•° &lt;span id=&quot;busuanzi_value_site_uv&quot;&gt;&lt;/span&gt; äºº\n\né‡åˆ°çš„ä¸€äº›å‘ä¸­æ–‡åšå®¢å†…å®¹æˆªæ–­è¿‡é•¿é»˜è®¤æƒ…å†µä¸‹ï¼ŒHugo å¯èƒ½ä¼šæ ¹æ®å•è¯è¾¹ç•Œæ¥æˆªæ–­æ‘˜è¦ï¼Œè¿™åœ¨å¤„ç†è‹±æ–‡æ—¶æ¯”è¾ƒåˆé€‚ï¼Œä½†å¯¹äºä¸­æ–‡ç­‰æ²¡æœ‰æ˜æ˜¾ç©ºæ ¼åˆ†éš”çš„è¯­è¨€åˆ™ä¸å¤ªé€‚ç”¨ã€‚å°±å¯èƒ½ä¼šå¯¼è‡´æ‘˜è¦éƒ¨åˆ†è¿‡é•¿ï¼Œå¯¼è‡´è§‚æ„Ÿä¸å¥½ï¼Œé¢å¯¹è¿™ç§æƒ…å†µæœ‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆã€‚\næ–¹æ¡ˆ 1ï¼šè‡ªå®šä¹‰ Summary åˆ†éš”ç¬¦ä½ å¯ä»¥åœ¨æ–‡ç« ä¸­æ‰‹åŠ¨å®šä¹‰ä¸€ä¸ªåˆ†éš”ç¬¦æ¥æŒ‡ç¤ºæ‘˜è¦ç»“æŸçš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨ Markdown æ–‡ä»¶ä¸­ä½¿ç”¨&lt;!--more--&gt;æ ‡ç­¾æ¥å®šä¹‰æ‘˜è¦çš„ç»“æŸã€‚\næ–¹æ¡ˆ 2ï¼šè°ƒæ•´ .Summary é•¿åº¦å¦‚æœä¸å¸Œæœ›åœ¨æ¯ç¯‡æ–‡ç« ä¸­æ‰‹åŠ¨åŠ å…¥åˆ†éš”ç¬¦ï¼Œä½ å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æ¥å…¨å±€è°ƒæ•´æ‘˜è¦çš„é•¿åº¦ã€‚é…ç½®æ–‡ä»¶ï¼ˆconfig.tomlï¼‰ç¤ºä¾‹ï¼š\n12[summary]  length = 120  # æ§åˆ¶æ‘˜è¦çš„å­—ç¬¦æ•°ï¼Œé»˜è®¤æ˜¯ 70\n\nè¿™æ ·è®¾ç½®åï¼ŒHugo å°†ä¼šè‡ªåŠ¨æˆªå–æ¯ç¯‡æ–‡ç« çš„å‰ 120 ä¸ªå­—ç¬¦ä½œä¸ºæ‘˜è¦ã€‚\næ–¹æ¡ˆ 3ï¼šä½¿ç”¨ CSS æ§åˆ¶æ˜¾ç¤ºå†…å®¹å¦‚æœä½ ä»ç„¶æƒ³åœ¨å‰ç«¯æ§åˆ¶æ˜¾ç¤ºçš„æ–‡å­—æ•°é‡ï¼ˆå°¤å…¶æ˜¯ä¸ºäº†ä¿æŒå¸ƒå±€çš„ä¸€è‡´æ€§ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ CSS çš„ text-overflow å±æ€§ã€‚\n1234567.nested-copy-line-height &#123;  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-line-clamp: 3; /* é™åˆ¶åœ¨3è¡Œå†… */  overflow: hidden;  text-overflow: ellipsis;&#125;\n\nä»¥ä¸Šæ–¹æ³•å¯ä»¥é€‰æ‹©é€‚åˆä½ ç½‘ç«™éœ€æ±‚çš„ä¸€ç§æˆ–å‡ ç§ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚å¦‚æœé€‰æ‹© CSS æ–¹å¼ï¼Œè¯·ç¡®ä¿å®ƒä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå’Œå†…å®¹çš„å¯è®¿é—®æ€§ã€‚\n","slug":"ä½¿ç”¨Hugoæ­å»ºä¸ªäººåšå®¢","date":"2024-11-26T00:00:00.000Z","categories_index":"DevOps","tags_index":"Hugo","author_index":"FaceMan"},{"id":"82af2d180e848d28b222db96dd62b1e7","title":"åŠ¨æ€APIé›†æˆæºç è§£æç‰ˆ","content":"åœ¨æ—¥å¸¸å¼€å‘æ—¶ï¼Œæƒ³è¦ç”¨åˆ°Swaggerå°±å¿…é¡»å¾—åˆ›å»ºæ§åˆ¶å™¨åˆ›å»ºæ¥å£æ–‡æ¡£ï¼Œä¸€èˆ¬ä¸šåŠ¡å¤„ç†éƒ½ä¸ä¼šåœ¨æ§åˆ¶å™¨ä¸­å¤„ç†ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå†åˆ›å»ºå¦ä¸€ä¸ªç±»æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæ¯æ¬¡åˆ›å»ºéƒ½ä¸¤ä¸ªç±»å°±å¾ˆç¹çï¼Œè¿™ç¯‡æ–‡ç« å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªç¹çï¼Œä»£ç åªè®²äº†å¤§æ¦‚æ€è·¯ï¼Œå…·ä½“çš„ç»†èŠ‚å¯ä»¥å‚è€ƒæºç !åŠ¨æ€APIä»“åº“ã€‚ä¸å…³å¿ƒæºç çš„æœ‹å‹å¯ä»¥ç›´æ¥é›†æˆæˆ‘çš„NugetåŒ…FaceMan.DynamicAPIï¼Œé…ç½®æ•™ç¨‹å‚è€ƒæˆ‘çš„æ–‡ç« ï¼šåŠ¨æ€APIé›†æˆã€‚\né›†æˆSwagger\né¦–å…ˆï¼Œåœ¨ä½ çš„.NET Coreé¡¹ç›®ä¸­å®‰è£…éœ€è¦çš„åŒ…ã€‚ä½ å¯ä»¥é€šè¿‡NuGetåŒ…ç®¡ç†å™¨æ¥å®‰è£…å®ƒï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´å®‰è£…ï¼Œä»¥ä¸‹æ˜¯åŒ…åå’Œç‰ˆæœ¬ã€‚\n\n12&lt;PackageReference Include=&quot;Swashbuckle.AspNetCore&quot; Version=&quot;6.4.0&quot; /&gt;&lt;PackageReference Include=&quot;Swashbuckle.AspNetCore.Filters&quot; Version=&quot;8.0.2&quot; /&gt;\n\n\n.Net 6ä»¥åå–æ¶ˆäº†StartUpï¼Œé…ç½®éƒ½åœ¨Programä¸­ï¼Œè¿™é‡Œé‡‡ç”¨æ–°å†™æ³•ã€‚\n\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152var builder = WebApplication.CreateBuilder(args);// é…ç½®æ–‡ä»¶è¯»å–var basePath = AppContext.BaseDirectory;var config = new ConfigurationBuilder()                .SetBasePath(basePath)                .AddJsonFile(&quot;appsettings.json&quot;, optional: true, reloadOnChange: true)                .Build();  #region æ·»åŠ Swaggeræ–‡æ¡£æœåŠ¡builder.Services.AddEndpointsApiExplorer();builder.Services.AddSwaggerGen(options =&gt;&#123;    //æ·»åŠ å“åº”å¤´ä¿¡æ¯ã€‚å®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…æŸ¥çœ‹ API å“åº”ä¸­åŒ…å«çš„ HTTP å¤´ä¿¡æ¯ï¼Œä»è€Œæ›´å¥½åœ°ç†è§£ API çš„è¡Œä¸ºã€‚    options.OperationFilter&lt;AddResponseHeadersFilter&gt;();    //æ‘˜è¦ä¸­æ·»åŠ æˆæƒä¿¡æ¯ã€‚å®ƒä¼šåœ¨æ¯ä¸ªéœ€è¦æˆæƒçš„æ“ä½œæ—è¾¹æ˜¾ç¤ºä¸€ä¸ªé”å›¾æ ‡ï¼Œæé†’å¼€å‘è€…è¯¥æ“ä½œéœ€è¦èº«ä»½éªŒè¯ã€‚    options.OperationFilter&lt;AppendAuthorizeToSummaryOperationFilter&gt;();    //åŠ å®‰å…¨éœ€æ±‚ä¿¡æ¯ã€‚å®ƒä¼šæ ¹æ® API çš„å®‰å…¨é…ç½®ï¼ˆå¦‚ OAuth2ã€JWT ç­‰ï¼‰è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„å®‰å…¨éœ€æ±‚æè¿°ï¼Œå¸®åŠ©å¼€å‘è€…äº†è§£å“ªäº›æ“ä½œéœ€è¦ç‰¹å®šçš„å®‰å…¨é…ç½®ã€‚    options.OperationFilter&lt;SecurityRequirementsOperationFilter&gt;();    options.SwaggerDoc(&quot;v1&quot;, new OpenApiInfo    &#123;        Title = &quot;xxxFrameWork API&quot;,        Version = &quot;v1&quot;,        Description = &quot;xxxFrameWork API æ¥å£æ–‡æ¡£&quot;,        Contact = new OpenApiContact()        &#123;            Name = &quot;xxxxx&quot;,            Email = &quot;xxxxx@qq.com&quot;,            Url = new Uri(&quot;https://github.com/xxxxx&quot;)        &#125;    &#125;);&#125;);#endregion æ·»åŠ Swaggeræ–‡æ¡£æœåŠ¡//å¼€å‘ç¯å¢ƒæ‰å¼€å¯æ–‡æ¡£ã€‚if (app.Environment.IsDevelopment())&#123;    app.UseSwagger();    app.UseSwaggerUI(options =&gt;    &#123;        //é…ç½®Endpointè·¯å¾„å’Œæ–‡æ¡£æ ‡é¢˜        options.SwaggerEndpoint(&quot;/swagger/v1/swagger.json&quot;, &quot;v1 Docs&quot;);        //é…ç½®è·¯ç”±å‰ç¼€ï¼ŒRoutePrefixæ˜¯Swagger UIçš„æ ¹è·¯å¾„ã€‚        //options.RoutePrefix = String.Empty;        //è®¾ç½®é»˜è®¤æ¨¡å‹å±•å¼€æ·±åº¦ã€‚é»˜è®¤å€¼ä¸º3ï¼Œå¯ä»¥è®¾ç½®æˆ-1ä»¥å®Œå…¨å±•å¼€æ‰€æœ‰æ¨¡å‹ã€‚        //options.DefaultModelExpandDepth(-1);        // å¯ç”¨æ·±é“¾æ¥åŠŸèƒ½åï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥é€šè¿‡URLè®¿é—®ç‰¹å®šçš„APIæ“ä½œæˆ–æ¨¡å‹ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨å¯¼èˆªåˆ°ç›¸åº”çš„ä½ç½®ã€‚        options.EnableDeepLinking();        options.DocExpansion(DocExpansion.None); //swaggeræ–‡æ¡£å±•å¼€æ–¹å¼ï¼Œnoneä¸ºæŠ˜å ï¼Œlistä¸ºåˆ—è¡¨    &#125;);&#125;\n\nåŠ¨æ€APISwaggeræ–‡æ¡£çš„åŸç†æ˜¯æ‰«ææ§åˆ¶å™¨æ¥ç”Ÿæˆï¼ŒåŠ¨æ€APIåˆ™æ˜¯è‡ªå®šä¹‰ç±»æ§åˆ¶å™¨ï¼Œç„¶åè®©æ¥å£ç»§æ‰¿ï¼Œè‡ªå®šä¹‰æ§åˆ¶å™¨è¯†åˆ«è§„åˆ™ï¼Œå®ç°æ€è·¯ï¼š\n\nå®šä¹‰ä¸€ä¸ªæ¥å£æˆ–ç‰¹æ€§ç”¨æ¥æ ‡è¯†è¿™æ˜¯ä¸ªæ§åˆ¶å™¨ï¼ŒMvcä¸­å®ç°çš„æ ¸å¿ƒæ˜¯ControllerFeatureProviderç±»ï¼Œé‡å†™IsControllerçš„åˆ¤æ–­é€»è¾‘ã€‚\nç»§æ‰¿IApplicationModelConventioné‡å†™Applyï¼Œå¦‚æœæ˜¯ç»§æ‰¿äº†è‡ªå®šä¹‰çš„æ§åˆ¶å™¨æ¥å£å°±æ ¹æ®è§„åˆ™æ ‡è®°Httpè¯·æ±‚ç±»å‹ã€‚æ¯”å¦‚Abpä¸­ç»§æ‰¿äº†IApplicationServiceæ¥å£ï¼ŒSwaggerä¼šè‡ªåŠ¨è¯†åˆ«,ä¸”éµå¾ªçº¦å®šå¤§äºè§„èŒƒåŸåˆ™ï¼Œå°†Getå¼€å¤´çš„è¯·æ±‚éƒ½é»˜è®¤æ˜¯Getè¯·æ±‚ï¼ŒDelå¼€å¤´çš„è¯·æ±‚é»˜è®¤æ˜¯Deleteè¯·æ±‚ã€‚\né…ç½®åº”ç”¨ç¨‹åºéƒ¨åˆ†ç®¡ç†å™¨ï¼Œæ·»åŠ è‡ªå®šä¹‰çš„æ§åˆ¶å™¨ç‰¹æ€§æä¾›ç¨‹åº\né…ç½®MvcOptionsï¼Œæ·»åŠ è‡ªå®šä¹‰çš„åº”ç”¨ç¨‹åºæ¨¡å‹çº¦å®š\n\næ¨¡ä»¿Abpçš„å®ç°\nåˆ›å»ºIApplicationServiceç”¨æ¥æ ‡è¯†è‡ªå®šä¹‰æ§åˆ¶å™¨çš„æ¥å£æˆ–ç‰¹æ€§1234567891011121314/// &lt;summary&gt;/// åŠ¨æ€WebAPIæ¥å£/// &lt;/summary&gt;public class IApplicationService&#123;&#125; /// &lt;summary&gt; /// åŠ¨æ€WebAPIç‰¹æ€§ /// &lt;/summary&gt; [AttributeUsage(AttributeTargets.Class, Inherited = true)] public class DynamicWebApiAttribute : Attribute &#123; &#125;\n\nåˆ›å»ºApplicationServiceControllerFeatureProviderç±»æ¥ç»§æ‰¿ControllerFeatureProviderç±»\n1234567891011121314151617181920212223242526272829/// &lt;summary&gt;/// è‡ªå®šä¹‰æ§åˆ¶å™¨ç‰¹æ€§æä¾›ç¨‹åºï¼Œç”¨äºå°†å®ç°äº† IApplicationService æ¥å£çš„ç±»è¯†åˆ«ä¸ºæ§åˆ¶å™¨ã€‚/// &lt;/summary&gt;public class ApplicationServiceControllerFeatureProvider : ControllerFeatureProvider&#123;    /// &lt;summary&gt;    /// åˆ¤æ–­ç»™å®šçš„ç±»å‹æ˜¯å¦ä¸ºæ§åˆ¶å™¨ã€‚    /// &lt;/summary&gt;    /// &lt;param name=&quot;typeInfo&quot;&gt;è¦åˆ¤æ–­çš„ç±»å‹ä¿¡æ¯ã€‚&lt;/param&gt;    /// &lt;returns&gt;å¦‚æœç±»å‹æ˜¯æ§åˆ¶å™¨ï¼Œåˆ™è¿”å› trueï¼›å¦åˆ™è¿”å› falseã€‚&lt;/returns&gt;    protected override bool IsController(TypeInfo typeInfo)    &#123;        // æ£€æŸ¥ç±»å‹æ˜¯å¦å®ç°äº† IApplicationService æ¥å£        if (typeof(IApplicationService).IsAssignableFrom(typeInfo))        &#123;            // æ£€æŸ¥ç±»å‹æ˜¯å¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š            var type = typeInfo.AsType();            if ((typeof(IApplicationService).IsAssignableFrom(type) || //åˆ¤æ–­æ˜¯å¦ç»§æ‰¿ICoreDynamicControlleræ¥å£                type.IsDefined(typeof(DynamicWebApiAttribute), true) ||// åˆ¤æ–­æ˜¯å¦æ ‡è®°äº†DynamicAPIAttributeç‰¹æ€§                 type.BaseType == typeof(Controller)) &amp;&amp;                typeInfo.IsPublic &amp;&amp; !typeInfo.IsAbstract &amp;&amp; !typeInfo.IsGenericType &amp;&amp; !typeInfo.IsInterface)//å¿…é¡»æ˜¯Publicã€ä¸èƒ½æ˜¯æŠ½è±¡ç±»ã€å¿…é¡»æ˜¯éæ³›å‹çš„            &#123;                return true;            &#125;        &#125;        // å¦‚æœä¸æ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œåˆ™è¿”å› false        return false;    &#125;&#125;\n\nåˆ›å»ºHttpMethodConfigureé…ç½®ç±»12345public class HttpMethodConfigure   &#123;       public string MethodKey &#123; get; set; &#125;       public List&lt;string&gt; MethodVal &#123; get; set; &#125;   &#125;\n\nåˆ›å»ºApplicationServiceConventionç»§æ‰¿IApplicationModelConvention123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140/// &lt;summary&gt;/// è‡ªå®šä¹‰åº”ç”¨ç¨‹åºæ¨¡å‹çº¦å®šï¼Œç”¨äºé…ç½®å®ç°äº† IApplicationService æ¥å£çš„æ§åˆ¶å™¨ã€‚/// &lt;/summary&gt;public class ApplicationServiceConvention : IApplicationModelConvention&#123;    private IConfiguration _configuration;    private List&lt;HttpMethodConfigure&gt; httpMethods = new();    public ApplicationServiceConvention(IConfiguration configuration)    &#123;        _configuration = configuration;        httpMethods = _configuration.GetSection(&quot;HttpMethodInfo&quot;).Get&lt;List&lt;HttpMethodConfigure&gt;&gt;();    &#125;    /// &lt;summary&gt;    /// åº”ç”¨çº¦å®š    /// &lt;/summary&gt;    /// &lt;param name=&quot;application&quot;&gt;&lt;/param&gt;    public void Apply(ApplicationModel application)    &#123;        //å¾ªç¯æ¯ä¸€ä¸ªæ§åˆ¶å™¨ä¿¡æ¯        foreach (var controller in application.Controllers)        &#123;            var controllerType = controller.ControllerType.AsType();            //æ˜¯å¦ç»§æ‰¿IApplicationServiceæ¥å£            if (typeof(IApplicationService).IsAssignableFrom(controllerType))            &#123;                //Actionså°±æ˜¯æ¥å£çš„æ–¹æ³•                foreach (var item in controller.Actions)                &#123;                    ConfigureSelector(controller.ControllerName, item);                &#125;            &#125;        &#125;    &#125;    /// &lt;summary&gt;    /// é…ç½®é€‰æ‹©å™¨    /// &lt;/summary&gt;    /// &lt;param name=&quot;controllerName&quot;&gt;&lt;/param&gt;    /// &lt;param name=&quot;action&quot;&gt;&lt;/param&gt;    private void ConfigureSelector(string controllerName, ActionModel action)    &#123;        //å¦‚æœå±æ€§è·¯ç”±æ¨¡å‹ä¸ºç©ºï¼Œåˆ™ç§»é™¤        for (int i = 0; i &lt; action.Selectors.Count; i++)        &#123;            if (action.Selectors[i].AttributeRouteModel is null)            &#123;                action.Selectors.Remove(action.Selectors[i]);            &#125;        &#125;            //å»é™¤è·¯å¾„ä¸­çš„AppServiceåç¼€            if (controllerName.EndsWith(&quot;AppService&quot;))            &#123;                controllerName = controllerName.Substring(0, controllerName.Length - 10);            &#125;        //å¦‚æœæœ‰é€‰æ‹©å™¨ï¼Œåˆ™éå†é€‰æ‹©å™¨ï¼Œæ·»åŠ é»˜è®¤è·¯ç”±        if (action.Selectors.Any())        &#123;            foreach (var item in action.Selectors)            &#123;                var routePath = string.Concat(&quot;api/&quot;, controllerName + &quot;/&quot;, action.ActionName).Replace(&quot;//&quot;, &quot;/&quot;);                var routeModel = new AttributeRouteModel(new RouteAttribute(routePath));                //å¦‚æœæ²¡æœ‰è®¾ç½®è·¯ç”±ï¼Œåˆ™æ·»åŠ è·¯ç”±                if (item.AttributeRouteModel == null)                &#123;                    item.AttributeRouteModel = routeModel;                &#125;            &#125;        &#125;        //å¦‚æœæ²¡æœ‰é€‰æ‹©å™¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªé€‰æ‹©å™¨å¹¶æ·»åŠ ã€‚        else        &#123;            action.Selectors.Add(CreateActionSelector(controllerName, action));        &#125;    &#125;    /// &lt;summary&gt;    /// åˆ›å»ºActioné€‰æ‹©å™¨    /// &lt;/summary&gt;    /// &lt;param name=&quot;controllerName&quot;&gt;&lt;/param&gt;    /// &lt;param name=&quot;action&quot;&gt;&lt;/param&gt;    /// &lt;returns&gt;&lt;/returns&gt;    private SelectorModel CreateActionSelector(string controllerName, ActionModel action)    &#123;        var selectorModel = new SelectorModel();        var actionName = action.ActionName;        string httpMethod = string.Empty;        //æ˜¯å¦æœ‰HttpMethodAttribute        var routeAttributes = action.ActionMethod.GetCustomAttributes(typeof(HttpMethodAttribute), false);        //å¦‚æœæ ‡è®°äº†HttpMethodAttribute        if (routeAttributes != null &amp;&amp; routeAttributes.Any())        &#123;            httpMethod = routeAttributes.SelectMany(m =&gt; (m as HttpMethodAttribute).HttpMethods).ToList().Distinct().FirstOrDefault();        &#125;        else        &#123;            //å¤§å†™æ–¹æ³•å            var methodName = action.ActionMethod.Name.ToUpper();            //éå†HttpMethodInfoé…ç½®ï¼ŒåŒ¹é…æ–¹æ³•å            foreach (var item in httpMethods)            &#123;                foreach (var method in item.MethodVal)                &#123;                    if (methodName.StartsWith(method))                    &#123;                        httpMethod = item.MethodKey;                        break;                    &#125;                &#125;            &#125;            //å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„HttpMethodï¼Œé»˜è®¤ä½¿ç”¨POST            if (httpMethod == string.Empty)            &#123;                httpMethod = &quot;POST&quot;;            &#125;        &#125;        return ConfigureSelectorModel(selectorModel, action, controllerName, httpMethod);    &#125;    /// &lt;summary&gt;    /// é…ç½®é€‰æ‹©å™¨æ¨¡å‹    /// &lt;/summary&gt;    /// &lt;param name=&quot;selectorModel&quot;&gt;&lt;/param&gt;    /// &lt;param name=&quot;action&quot;&gt;&lt;/param&gt;    /// &lt;param name=&quot;controllerName&quot;&gt;&lt;/param&gt;    /// &lt;param name=&quot;httpMethod&quot;&gt;&lt;/param&gt;    /// &lt;returns&gt;&lt;/returns&gt;    public SelectorModel ConfigureSelectorModel(SelectorModel selectorModel, ActionModel action, string controllerName, string httpMethod)    &#123;        var routePath = string.Concat(&quot;api/&quot;, controllerName + &quot;/&quot;, action.ActionName).Replace(&quot;//&quot;, &quot;/&quot;);        //ç»™æ­¤é€‰æ‹©å™¨æ·»åŠ è·¯ç”±        selectorModel.AttributeRouteModel = new AttributeRouteModel(new RouteAttribute(routePath));        //æ·»åŠ HttpMethod        selectorModel.ActionConstraints.Add(new HttpMethodActionConstraint(new[] &#123; httpMethod &#125;));        return selectorModel;    &#125;&#125;\n\nåˆ›å»ºDynamicWebApiExtensions1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/// &lt;summary&gt;/// åŠ¨æ€WebAPIæ‰©å±•ç±»ï¼Œç”¨äºåœ¨ASP.NET Coreåº”ç”¨ç¨‹åºä¸­æ·»åŠ åŠ¨æ€WebAPIåŠŸèƒ½ã€‚/// &lt;/summary&gt;public static class DynamicWebApiExtensions&#123;    /// &lt;summary&gt;    /// ä¸ºIMvcBuilderæ·»åŠ åŠ¨æ€WebAPIåŠŸèƒ½ã€‚    /// &lt;/summary&gt;    /// &lt;param name=&quot;builder&quot;&gt;IMvcBuilderå®ä¾‹ã€‚&lt;/param&gt;    /// &lt;returns&gt;IMvcBuilderå®ä¾‹ã€‚&lt;/returns&gt;    public static IMvcBuilder AddDynamicWebApi(this IMvcBuilder builder, IConfiguration configuration)    &#123;        if (builder == null)        &#123;            throw new ArgumentNullException(nameof(builder));        &#125;        // é…ç½®åº”ç”¨ç¨‹åºéƒ¨åˆ†ç®¡ç†å™¨ï¼Œæ·»åŠ è‡ªå®šä¹‰çš„æ§åˆ¶å™¨ç‰¹æ€§æä¾›ç¨‹åº        builder.ConfigureApplicationPartManager(applicationPartManager =&gt;        &#123;            applicationPartManager.FeatureProviders.Add(new ApplicationServiceControllerFeatureProvider());        &#125;);        // é…ç½®MvcOptionsï¼Œæ·»åŠ è‡ªå®šä¹‰çš„åº”ç”¨ç¨‹åºæ¨¡å‹çº¦å®š        builder.Services.Configure&lt;MvcOptions&gt;(options =&gt;        &#123;            options.Conventions.Add(new ApplicationServiceConvention(configuration));        &#125;);        return builder;    &#125;    /// &lt;summary&gt;    /// ä¸ºIMvcCoreBuilderæ·»åŠ åŠ¨æ€WebAPIåŠŸèƒ½ã€‚    /// &lt;/summary&gt;    /// &lt;param name=&quot;builder&quot;&gt;IMvcCoreBuilderå®ä¾‹ã€‚&lt;/param&gt;    /// &lt;returns&gt;IMvcCoreBuilderå®ä¾‹ã€‚&lt;/returns&gt;    public static IMvcCoreBuilder AddDynamicWebApi(this IMvcCoreBuilder builder, IConfiguration configuration)    &#123;        if (builder == null)        &#123;            throw new ArgumentNullException(nameof(builder));        &#125;        // é…ç½®åº”ç”¨ç¨‹åºéƒ¨åˆ†ç®¡ç†å™¨ï¼Œæ·»åŠ è‡ªå®šä¹‰çš„æ§åˆ¶å™¨ç‰¹æ€§æä¾›ç¨‹åº        builder.ConfigureApplicationPartManager(applicationPartManager =&gt;        &#123;            applicationPartManager.FeatureProviders.Add(new ApplicationServiceControllerFeatureProvider());        &#125;);        // é…ç½®MvcOptionsï¼Œæ·»åŠ è‡ªå®šä¹‰çš„åº”ç”¨ç¨‹åºæ¨¡å‹çº¦å®š        builder.Services.Configure&lt;MvcOptions&gt;(options =&gt;        &#123;            options.Conventions.Add(new ApplicationServiceConvention(configuration));        &#125;);        return builder;    &#125;&#125;\n\nProgramä¸­é…ç½®123456//æ³¨å†ŒåŠ¨æ€APIæœåŠ¡builder.Services.AddControllers().AddDynamicWebApi(builder.Configuration);//å¿…é¡»è¦åŠ ï¼Œä¸ç„¶æ–­ç‚¹è¿›ä¸æ¥app.MapControllers();\n\nåœ¨Appsettingsé…ç½®httpè¯·æ±‚ç±»å‹åŒ¹é…è§„åˆ™123456789101112131415161718&quot;HttpMethodInfo&quot;: [  &#123;    &quot;MethodKey&quot;: &quot;Get&quot;,    &quot;MethodVal&quot;: [ &quot;GET&quot;, &quot;QUERY&quot; ]  &#125;,  &#123;    &quot;MethodKey&quot;: &quot;Post&quot;,    &quot;MethodVal&quot;: [ &quot;CREATE&quot;, &quot;SAVE&quot;, &quot;INSERT&quot;, &quot;ADD&quot; ]  &#125;,  &#123;    &quot;MethodKey&quot;: &quot;Put&quot;,    &quot;MethodVal&quot;: [ &quot;UPDATE&quot;, &quot;EDIT&quot; ]  &#125;,  &#123;    &quot;MethodKey&quot;: &quot;Delete&quot;,    &quot;MethodVal&quot;: [ &quot;Delete&quot;, &quot;REMOVE&quot; ]  &#125;]\n\nåˆ›å»ºæµ‹è¯•ç±»12345678910111213141516public class Test : IApplicationService&#123;    /// &lt;summary&gt;    ///é¢†åŸŸå±‚æ³¨é‡Šæµ‹è¯•æ¥å£    /// &lt;/summary&gt;    /// &lt;returns&gt;&lt;/returns&gt;    public string Hello()    &#123;        return &quot;Hello from Class1&quot;;    &#125;    public string Get()    &#123;        return &quot;Get from Class1&quot;;    &#125;&#125;\n\n\nå°†åŠ¨æ€APIé…ç½®Swaggeræ–‡æ¡£æ³¨é‡Š\nç±»åº“é…ç½®ä¸­è®¾ç½®xmlæ–‡ä»¶ç”Ÿæˆåœ°å€\n\n12&lt;GenerateDocumentationFile&gt;True&lt;/GenerateDocumentationFile&gt;&lt;DocumentationFile&gt;bin\\Debug\\FlyFramework.Core.xml&lt;/DocumentationFile&gt;\n\n\nåœ¨Hostä¸­çš„wwwrootåˆ›å»ºApiDocsæ–‡ä»¶å¤¹\nHostä¸»æœºé…ç½®xmlæ–‡ä»¶å¤åˆ¶åœ°å€ï¼Œç”Ÿæˆçš„xmlæ–‡ä»¶ä¼šå¤åˆ¶åˆ°å¯¹åº”çš„åœ°å€ã€‚\n\n123456789101112131415161718&lt;ApiDocDir&gt;wwwroot\\ApiDocs&lt;/ApiDocDir&gt;&lt;!--åœ¨æ„å»ºé¡¹ç›®åï¼Œå¤åˆ¶æ‰€æœ‰ä»¥FlyFrameworkå¼€å¤´çš„XMLæ–‡æ¡£æ–‡ä»¶åˆ°æŒ‡å®šçš„APIæ–‡æ¡£ç›®å½•ã€‚è¿™é€šå¸¸ç”¨äºå°†ç”Ÿæˆçš„XMLæ–‡æ¡£æ–‡ä»¶ï¼ˆä¾‹å¦‚APIæ³¨é‡Šï¼‰æ•´ç†åˆ°ä¸€ä¸ªç›®å½•ä¸­ï¼Œä¾¿äºè¿›ä¸€æ­¥çš„å¤„ç†æˆ–å‘å¸ƒã€‚è¿™ç§åšæ³•å¯ä»¥é€‚åˆäºç”ŸæˆAPIæ–‡æ¡£å¦‚Swaggeræ—¶çš„ä½¿ç”¨åœºæ™¯ã€‚--&gt;&lt;Target Name=&quot;CopyXmlDocFileForBuild&quot; AfterTargets=&quot;Build&quot;&gt;\t&lt;ItemGroup&gt;\t\t&lt;!--Include=&quot;@(ReferencePath-&gt;&#x27;%(RootDir)%(Directory)%(Filename).xml&#x27;)&quot;ï¼šè¿™è¡Œè¡¨ç¤ºä»æ‰€æœ‰é¡¹ç›®å¼•ç”¨ï¼ˆReferencePathï¼‰çš„è·¯å¾„ä¸­æ”¶é›†ä»¥.xmlä¸ºæ‰©å±•åçš„æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶é€šå¸¸æ˜¯ç”Ÿæˆçš„XMLæ–‡æ¡£æ–‡ä»¶ã€‚--&gt;\t\t&lt;!--Condition=&quot;$([System.String]::new(&#x27;%(FileName)&#x27;).StartsWith(&#x27;FlyFramework&#x27;))&quot;ï¼šæ­¤æ¡ä»¶ç”¨äºè¿‡æ»¤æ–‡ä»¶ï¼Œä»…åŒ…æ‹¬æ–‡ä»¶åä»¥FlyFrameworkå¼€å¤´çš„XMLæ–‡æ¡£æ–‡ä»¶ã€‚è¿™ä¿è¯åªæœ‰ç›¸å…³çš„æ–‡æ¡£æ–‡ä»¶è¢«é€‰æ‹©ã€‚--&gt;\t\t&lt;XmlDocFiles Include=&quot;@(ReferencePath-&gt;&#x27;%(RootDir)%(Directory)%(Filename).xml&#x27;)&quot; Condition=&quot;$([System.String]::new(&#x27;%(FileName)&#x27;).StartsWith(&#x27;FlyFramework&#x27;))&quot; /&gt;\t&lt;/ItemGroup&gt;\t&lt;!--SourceFiles=&quot;@(XmlDocFiles)&quot;ï¼šæŒ‡å®šè¦å¤åˆ¶çš„æºæ–‡ä»¶ä¸ºä¸Šä¸€æ­¥ä¸­å®šä¹‰çš„XmlDocFilesé›†åˆã€‚--&gt;\t&lt;!--`Condition=&quot;Exists(&#x27;%(FullPath)&#x27;)&quot;ï¼šç¡®ä¿å¤åˆ¶å‰æºæ–‡ä»¶å­˜åœ¨ï¼Œè¿™æ˜¯ä¸€ç§å®‰å…¨æ£€æŸ¥ã€‚--&gt;\t&lt;!--DestinationFolder=&quot;$(ApiDocDir)&quot;ï¼šç›®çš„åœ°æ–‡ä»¶å¤¹ä¸º$(ApiDocDir)ï¼Œè¿™ä¸ªå±æ€§ä¹‹å‰å·²ç»åœ¨é¡¹ç›®æ–‡ä»¶ä¸­å®šä¹‰ï¼ŒæŒ‡å‘å­˜æ”¾APIæ–‡æ¡£çš„ç›®å½•ã€‚--&gt;\t&lt;!--SkipUnchangedFiles=&quot;true&quot;ï¼šæ­¤é€‰é¡¹è¡¨ç¤ºåªæœ‰å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶ä¼šè¢«å¤åˆ¶ï¼Œè¿™å¯ä»¥æé«˜æ•ˆç‡ï¼Œé¿å…ä¸å¿…è¦çš„å¤åˆ¶æ“ä½œã€‚--&gt;\t&lt;Copy SourceFiles=&quot;@(XmlDocFiles)&quot; Condition=&quot;Exists(&#x27;%(FullPath)&#x27;)&quot; DestinationFolder=&quot;$(ApiDocDir)&quot; SkipUnchangedFiles=&quot;true&quot; /&gt;&lt;/Target&gt;\n\n\nåœ¨AddSwaggerGenå¢åŠ é…ç½®\n\n12345678//éå†æ‰€æœ‰xmlå¹¶åŠ è½½var binXmlFiles =    new DirectoryInfo(Path.Join(builder.Environment.WebRootPath, &quot;ApiDocs&quot;))        .GetFiles(&quot;*.xml&quot;, SearchOption.TopDirectoryOnly);foreach (var filePath in binXmlFiles.Select(item =&gt; item.FullName))&#123;    options.IncludeXmlComments(filePath, true);&#125;\n\nè‡´è°¢æ€è·¯å‚è€ƒçš„å¤§ä½¬æ–‡ç« ï¼Œå¤§ä½¬æ˜¯ä»æºç è§’åº¦è§£é‡Šï¼Œæˆ‘å†™è¿™ç¯‡åæ–°æ‰‹å‘ï¼Œåšäº†äº›æ‹“å±•ï¼ŒåŸæ–‡æŒ‡è·¯ï¼š.Net Coreåç«¯æ¶æ„å®æˆ˜ã€2-å®ç°åŠ¨æ€è·¯ç”±ä¸Dynamic APIã€‘ - æ±ŸåŒ—ã€ - åšå®¢å›­ (cnblogs.com)\n","slug":"åŠ¨æ€APIé›†æˆæºç è§£æç‰ˆ","date":"2024-11-24T00:00:00.000Z","categories_index":".Net","tags_index":"Swagger","author_index":"FaceMan"},{"id":"26f6a1758883b55cdee304c67b5f3a44","title":".NetCoreè‡ªåŠ¨å¼€å¯äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§","content":"èµ·å› æ˜¯å› ä¸ºå…¬å¸æ²¡æœ‰ä½¿ç”¨ä»»ä½•ä»£ç æ¡†æ¶ï¼Œæ‰€ä»¥ä½¿ç”¨çš„éƒ½æ˜¯æ¯”è¾ƒåŸå§‹çš„å†™æ³•ï¼Œåœ¨ç³»ç»Ÿçš„å„å¤„éƒ½æœ‰SaveChanges()æ–¹æ³•,è¿™æ ·ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸å‰é¢å·²ç»æ‰§è¡Œäº†ä¸€äº›æ“ä½œç›´æ¥åˆ°æ•°æ®åº“å»äº†ï¼Œä½†åº”è¯¥å›æ»šåˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å¼€å¯äº‹åŠ¡ï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæäº¤äº‹åŠ¡ã€‚ä½†æ˜¯å¦‚æœæ¯ä¸ªæ–¹æ³•éƒ½æ‰‹åŠ¨å¼€å¯äº‹åŠ¡ï¼Œä»£ç ä¼šæ˜¾å¾—å¾ˆå†—ä½™ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè‡ªåŠ¨å¼€å¯äº‹åŠ¡çš„æœºåˆ¶ã€‚\nå®ç°æ–¹æ³•åŒæ­¥æ–¹æ³•12345678910111213141516171819202122232425262728293031public class TransactionFilterAttritube : IActionFilter&#123;    private readonly YourDbContext  _dbContext;    public TransactionFilterAttritube(YourDbContext  dbContext)    &#123;        _dbContext = dbContext;    &#125;    public void OnActionExecuted(ActionExecutedContext context)    &#123;        // æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸å‘ç”Ÿ        if (context.Exception == null &amp;&amp; !context.Canceled)        &#123;            // æäº¤äº‹åŠ¡            _dbContext.SaveChanges();            _dbContext.Database.CurrentTransaction?.Commit();        &#125;        else        &#123;            // å›æ»šäº‹åŠ¡            _dbContext.Database.CurrentTransaction?.Rollback();        &#125;    &#125;    public void OnActionExecuting(ActionExecutingContext context)    &#123;        // åœ¨åŠ¨ä½œæ–¹æ³•æ‰§è¡Œä¹‹å‰å¯åŠ¨äº‹åŠ¡        _dbContext.Database.BeginTransaction();    &#125;&#125;\n\nå¼‚æ­¥æ–¹æ³•12345678910111213141516171819202122232425262728public class TransactionFilterAttritube : IAsyncActionFilter&#123;    private readonly YourDbContext  _dbContext;    public TransactionFilterAttritube(YourDbContext  dbContext)    &#123;        _dbContext = dbContext;    &#125;    public async Task OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next)    &#123;        // åœ¨åŠ¨ä½œæ–¹æ³•æ‰§è¡Œä¹‹å‰å¯åŠ¨äº‹åŠ¡        var transaction = await _dbContext.Database.BeginTransactionAsync();        var executedContext = await next(); // æ‰§è¡ŒAction        // æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸å‘ç”Ÿ        if (executedContext.Exception == null)        &#123;            // æäº¤äº‹åŠ¡            await _dbContext.SaveChangesAsync();            await transaction.CommitAsync();        &#125;        else        &#123;            // å›æ»šäº‹åŠ¡            await transaction.RollbackAsync();        &#125;    &#125;&#125;\n\nä½¿ç”¨æ–¹æ³•å¯åŠ¨æ—¶æ³¨å†Œæ‹¦æˆªå™¨ï¼š\n1234services.AddMvcCore(option =&gt;&#123;    option.Filters.Add&lt;TransactionFilterAttritube&gt;();&#125;)\n\næ€»ç»“é€šè¿‡æ‹¦æˆªå™¨çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªåŠ¨å¼€å¯äº‹åŠ¡ï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæäº¤äº‹åŠ¡ï¼Œé¿å…æ‰‹åŠ¨å¼€å¯äº‹åŠ¡ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚\n","slug":"NetCoreè‡ªåŠ¨å¼€å¯äº‹åŠ¡","date":"2024-11-22T00:00:00.000Z","categories_index":".Net","tags_index":".NetCore,c#","author_index":"FaceMan"},{"id":"1796052fe66afe402255c3eb4319b228","title":"Sqlä¼˜åŒ–æ–¹æ³•","content":"æœ€è¿‘æ–°å…¥èŒäº†ä¸€å®¶ç”µå•†å…¬å¸ï¼ŒåšCRMç³»ç»Ÿï¼Œç”±äºä¸šåŠ¡é‡æ¯”è¾ƒå¤§ï¼Œæ•°æ®é‡åºå¤§åŠ¨ä¸åŠ¨å‡ åä¸‡æ•°æ®èµ·æ­¥ï¼Œæ•°æ®åº“çš„å‹åŠ›ä¹Ÿå¾ˆå¤§ã€‚æ¯”å¦‚æœ€è¿‘é‡åˆ°çš„éœ€æ±‚ï¼Œéœ€è¦æŸ¥çœ‹æœ€è§„å®šæ—¶é—´å†…å®¢æˆ·æ˜¯å¦æœ‰ä¸‹å•ï¼Œæˆ–è€…æ˜¯å¦æœ‰è·Ÿå®¢æˆ·è”ç³»ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±è¦é‡Šæ”¾å‡ºå»ï¼Œè¿™å°±éœ€è¦å»è®¢å•è¡¨æŸ¥è¯¢ä»–çš„ä¸‹å•è®°å½•å’Œè”ç³»è®°å½•ã€‚è”ç³»è®°å½•å¥½æŸ¥ï¼Œæœ‰å®šæ—¶åŒæ­¥æœ€åä¸€æ¬¡è”ç³»æ—¶é—´çš„ï¼Œä½†è®¢å•è¡¨çš„æ•°æ®é‡å¤§ï¼Œè¦æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·çš„æœ€åä¸€å•æˆäº¤è®°å½•å°±éœ€è¦åˆ†ç»„å»æŸ¥äº†ã€‚æˆ‘ç›´æ¥å†™åœ¨linqé‡Œé¢æŸ¥è¯¢ï¼Œé€Ÿåº¦è´¼æ…¢ï¼ŒæŸ¥è¯¢äº†å‡ åˆ†é’Ÿï¼Œè¿˜æ²¡è¿”å›ç»“æœã€‚ä½†æ˜¯æˆ‘æŠŠæŸ¥è¯¢è®¢å•è¿™ä¸€æ­¥å•ç‹¬æ‹¿å‡ºæ¥åšæˆè§†å›¾å†å»è¿è¡¨æŸ¥è¯¢ï¼Œé€Ÿåº¦å°±å¿«å¤šäº†å‡ ç§’å°±å‡ºæ¥äº†ã€‚æŸ¥äº†ä¸‹å¤§æ¦‚åŸå› åº”è¯¥æ˜¯è§†å›¾åœ¨æ•°æ®åº“ä¸­è¢«é¢„å…ˆç¼–è¯‘å’Œä¼˜åŒ–ï¼Œæ‰€ä»¥å½“é€šè¿‡è§†å›¾æŸ¥è¯¢æ•°æ®æ—¶ï¼Œæ•°æ®åº“å¯ä»¥å¿«é€Ÿå“åº”ã€‚è€Œç›´æ¥åœ¨EF Coreä¸­ä½¿ç”¨LINQæŸ¥è¯¢å¯èƒ½ä¼šç”Ÿæˆä¸å¤Ÿä¼˜åŒ–çš„SQLè¯­å¥ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°èšåˆã€åˆ†ç»„ç­‰æ“ä½œæ—¶ã€‚æ‰€ä»¥æ•°æ®é‡å¤§ä¸”æŸ¥è¯¢æ€§èƒ½ä¸å¥½æ—¶ï¼Œä¹Ÿä¸å¤±ä¸ºä¸€ç§ä¼˜åŒ–æ–¹æ³•ï¼ˆå¦‚æœæœ‰è¯¯è¯·æŒ‡æ­£ï¼‰ã€‚\nä»¥å‰æ•°æ®é‡å°æ²¡æ€ä¹ˆå…³æ³¨è¿‡Sqlä¼˜åŒ–ï¼Œæ‰€ä»¥ä¸‹é¢è®°å½•ä¸€äº›å¸¸ç”¨çš„Sqlä¼˜åŒ–æ–¹æ³•ï¼Œä»¥mysqlä¸ºä¾‹ã€‚\n1. é¿å…ä½¿ç”¨select *å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å†™sqlè¯­å¥æ—¶ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå–œæ¬¢ç›´æ¥ä½¿ç”¨select *ï¼Œä¸€æ¬¡æ€§æŸ¥å‡ºè¡¨ä¸­æ‰€æœ‰åˆ—çš„æ•°æ®ã€‚åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¯èƒ½æˆ‘ä»¬çœŸæ­£éœ€è¦ä½¿ç”¨çš„åªæœ‰å…¶ä¸­ä¸€ä¸¤åˆ—ã€‚æŸ¥äº†å¾ˆå¤šæ•°æ®ï¼Œä½†æ˜¯ä¸ç”¨ï¼Œç™½ç™½æµªè´¹äº†æ•°æ®åº“èµ„æºï¼Œæ¯”å¦‚ï¼šå†…å­˜æˆ–è€…cpuã€‚æ­¤å¤–ï¼Œå¤šæŸ¥å‡ºæ¥çš„æ•°æ®ï¼Œé€šè¿‡ç½‘ç»œIOä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šå¢åŠ æ•°æ®ä¼ è¾“çš„æ—¶é—´ã€‚è¿˜æœ‰ä¸€ä¸ªæœ€é‡è¦çš„é—®é¢˜æ˜¯ï¼šselect *ä¸ä¼šèµ°è¦†ç›–ç´¢å¼•ï¼Œä¼šå‡ºç°å¤§é‡çš„å›è¡¨æ“ä½œï¼Œè€Œä»å¯¼è‡´æŸ¥è¯¢sqlçš„æ€§èƒ½å¾ˆä½ã€‚\næ‰€ä»¥ï¼Œæœ€ä½³å®è·µæ˜¯ï¼šåªé€‰æ‹©éœ€è¦çš„åˆ—ï¼Œå¹¶ä¸”å°½é‡é¿å…ä½¿ç”¨select *ã€‚\n2. ç”¨union allä»£æ›¿unionunion allä¸ä¼šå»é‡ï¼Œè€Œunionä¼šï¼Œæ’é‡çš„è¿‡ç¨‹éœ€è¦éå†ã€æ’åºå’Œæ¯”è¾ƒï¼Œå®ƒæ›´è€—æ—¶ï¼Œæ›´æ¶ˆè€—cpuèµ„æºã€‚æ‰€ä»¥éœ€è¦å»é‡ç”¨unionä¸éœ€è¦å»é‡çš„æ—¶å€™ç”¨union allã€‚\n3. å°è¡¨é©±åŠ¨å¤§è¡¨å¦‚æœsqlè¯­å¥ä¸­åŒ…å«äº†inå…³é”®å­—ï¼Œåˆ™å®ƒä¼šä¼˜å…ˆæ‰§è¡Œiné‡Œé¢çš„å­æŸ¥è¯¢è¯­å¥ï¼Œç„¶åå†æ‰§è¡Œinå¤–é¢çš„è¯­å¥ã€‚å¦‚æœiné‡Œé¢çš„æ•°æ®é‡å¾ˆå°‘ï¼Œä½œä¸ºæ¡ä»¶æŸ¥è¯¢é€Ÿåº¦æ›´å¿«ã€‚è€Œå¦‚æœsqlè¯­å¥ä¸­åŒ…å«äº†existså…³é”®å­—ï¼Œå®ƒä¼˜å…ˆæ‰§è¡Œexistså·¦è¾¹çš„è¯­å¥ï¼ˆå³ä¸»æŸ¥è¯¢è¯­å¥ï¼‰ã€‚ç„¶åæŠŠå®ƒä½œä¸ºæ¡ä»¶ï¼Œå»è·Ÿå³è¾¹çš„è¯­å¥åŒ¹é…ã€‚å¦‚æœåŒ¹é…ä¸Šï¼Œåˆ™å¯ä»¥æŸ¥è¯¢å‡ºæ•°æ®ã€‚å¦‚æœåŒ¹é…ä¸ä¸Šï¼Œæ•°æ®å°±è¢«è¿‡æ»¤æ‰äº†ã€‚\n\nin é€‚ç”¨äºå·¦è¾¹å¤§è¡¨ï¼Œå³è¾¹å°è¡¨ã€‚\nexists é€‚ç”¨äºå·¦è¾¹å°è¡¨ï¼Œå³è¾¹å¤§è¡¨ã€‚ä¸ç®¡æ˜¯ç”¨inï¼Œè¿˜æ˜¯existså…³é”®å­—ï¼Œå…¶æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯ç”¨å°è¡¨é©±åŠ¨å¤§è¡¨ã€‚\n\n4. æ‰¹é‡æ’å…¥æ‰¹é‡æ’å…¥å¯ä»¥æé«˜æ•°æ®åº“çš„æ’å…¥æ€§èƒ½ã€‚æˆ‘ä»¬å¯ä»¥æŠŠéœ€è¦æ’å…¥çš„æ•°æ®åˆ†æ‰¹æ¬¡æ’å…¥ï¼Œè€Œä¸æ˜¯ä¸€æ¡ä¸€æ¡æ’å…¥ã€‚è¿™æ ·å¯ä»¥å‡å°‘ç½‘ç»œIOï¼Œæé«˜æ•°æ®åº“çš„æ’å…¥æ€§èƒ½ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸å»ºè®®ä¸€æ¬¡æ‰¹é‡æ“ä½œå¤ªå¤šçš„æ•°æ®ï¼Œå¦‚æœæ•°æ®å¤ªå¤šæ•°æ®åº“å“åº”ä¹Ÿä¼šå¾ˆæ…¢ã€‚æ‰¹é‡æ“ä½œéœ€è¦æŠŠæ¡ä¸€ä¸ªåº¦ï¼Œå»ºè®®æ¯æ‰¹æ•°æ®å°½é‡æ§åˆ¶åœ¨500ä»¥å†…ã€‚å¦‚æœæ•°æ®å¤šäº500ï¼Œåˆ™åˆ†å¤šæ‰¹æ¬¡å¤„ç†ã€‚\n5. å¤šç”¨limitlimitå¯ä»¥é™åˆ¶æŸ¥è¯¢ç»“æœçš„æ•°é‡ï¼Œé¿å…æŸ¥è¯¢å‡ºå¤§é‡æ•°æ®ï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡ã€‚æ¯”å¦‚æŸ¥è¯¢æŸä¸ªç”¨æˆ·ä¸‹çš„ç¬¬ä¸€ä¸ªè®¢å•ï¼Œæƒ³çœ‹çœ‹ä»–ç¬¬ä¸€æ¬¡çš„é¦–å•æ—¶é—´ã€‚\n1SELECT order_time FROM orders WHERE user_id = 1 ORDER BY order_time LIMIT 1;\n\n6. inä¸­å€¼å¤ªå¤šinä¸­å€¼å¤ªå¤šï¼Œä¼šå¯¼è‡´æŸ¥è¯¢è®¡åˆ’å˜å¾—å¤æ‚ï¼Œç´¢å¼•å¤±æ•ˆï¼Œå¯¼è‡´æŸ¥è¯¢æ•ˆç‡å˜ä½ã€‚æ‰€ä»¥inä¸­å€¼ä¸è¦å¤ªå¤šã€‚\nå¯¹äºæ‰¹é‡æŸ¥è¯¢æ¥å£ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨inå…³é”®å­—è¿‡æ»¤å‡ºæ•°æ®ã€‚æ¯”å¦‚ï¼šæƒ³é€šè¿‡æŒ‡å®šçš„ä¸€äº›idï¼Œæ‰¹é‡æŸ¥è¯¢å‡ºç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸åšä»»ä½•é™åˆ¶ï¼Œè¯¥æŸ¥è¯¢è¯­å¥ä¸€æ¬¡æ€§å¯èƒ½ä¼šæŸ¥è¯¢å‡ºéå¸¸å¤šçš„æ•°æ®ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´æ¥å£è¶…æ—¶ã€‚æ‰€ä»¥å¯ä»¥åœ¨sqlä¸­å¯¹æ•°æ®ç”¨limitåšé™åˆ¶ã€‚\n1SELECT * FROM user_info WHERE id IN (1,2,3,4,5,6,7,8,9,10) LIMIT 10;\n\nè¿˜æœ‰ä¸€ä¸ªæ–¹æ¡ˆå°±æ˜¯ï¼šå¦‚æœidsè¶…è¿‡500æ¡è®°å½•ï¼Œå¯ä»¥åˆ†æ‰¹ç”¨å¤šçº¿ç¨‹å»æŸ¥è¯¢æ•°æ®ã€‚æ¯æ‰¹åªæŸ¥500æ¡è®°å½•ï¼Œæœ€åæŠŠæŸ¥è¯¢åˆ°çš„æ•°æ®æ±‡æ€»åˆ°ä¸€èµ·è¿”å›ã€‚\n7. å¢é‡æŸ¥è¯¢å¢é‡æŸ¥è¯¢å¯ä»¥é¿å…å…¨è¡¨æ‰«æï¼ŒåªæŸ¥è¯¢æ–°å¢çš„æ•°æ®ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬æƒ³æŸ¥è¯¢æŸä¸ªç”¨æˆ·çš„æ–°å¢è®¢å•ï¼Œåªéœ€è¦æŸ¥è¯¢user_idå¤§äºæŸä¸ªå€¼ï¼Œå¹¶ä¸”order_timeå¤§äºæŸä¸ªå€¼çš„æ•°æ®ã€‚\n1SELECT * FROM orders WHERE user_id &gt; 1000 AND order_time &gt; &#x27;2021-01-01&#x27;;\n\n8. é«˜æ•ˆçš„åˆ†é¡µåˆ†é¡µæŸ¥è¯¢æ˜¯æ•°æ®åº“æŸ¥è¯¢ä¸­æœ€å¸¸ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ã€‚åˆ†é¡µæŸ¥è¯¢å¯ä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œé¿å…æŸ¥è¯¢å‡ºå¤§é‡æ•°æ®ï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡ã€‚\næ–¹æ¡ˆä¸€ limitåœ¨mysqlä¸­åˆ†é¡µä¸€èˆ¬ç”¨çš„limitå…³é”®å­—ï¼Œå¦‚æœè¡¨ä¸­æ•°æ®é‡å°‘ï¼Œç”¨limitå…³é”®å­—åšåˆ†é¡µï¼Œæ²¡å•¥é—®é¢˜ã€‚ä½†å¦‚æœè¡¨ä¸­æ•°æ®é‡å¾ˆå¤šï¼Œç”¨å®ƒå°±ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ã€‚æ¯”å¦‚ç°åœ¨åˆ†é¡µå‚æ•°å˜æˆäº†ï¼š\n12select id,name,age from user limit 1000000,20;\n\nmysqlä¼šæŸ¥åˆ°1000020æ¡æ•°æ®ï¼Œç„¶åä¸¢å¼ƒå‰é¢çš„1000000æ¡ï¼ŒåªæŸ¥åé¢çš„20æ¡æ•°æ®ï¼Œè¿™ä¸ªæ˜¯éå¸¸æµªè´¹èµ„æºçš„ã€‚é‚£ä¹ˆï¼Œè¿™ç§æµ·é‡æ•°æ®è¯¥æ€ä¹ˆåˆ†é¡µå‘¢ï¼Ÿä¼˜åŒ–sqlï¼š\n12select id,name,age from user where id &gt; 1000000 limit 20;\n\nå…ˆæ‰¾åˆ°ä¸Šæ¬¡åˆ†é¡µæœ€å¤§çš„idï¼Œç„¶ååˆ©ç”¨idä¸Šçš„ç´¢å¼•æŸ¥è¯¢ã€‚ä¸è¿‡è¯¥æ–¹æ¡ˆï¼Œè¦æ±‚idæ˜¯è¿ç»­çš„ï¼Œå¹¶ä¸”æœ‰åºçš„ã€‚\næ–¹æ¡ˆäºŒ betweenå¦ä¸€ç§åˆ†é¡µæ–¹æ³•æ˜¯åˆ©ç”¨betweenå…³é”®å­—ï¼Œæ¯”å¦‚ï¼š\n12select id,name,age from user where id between 1000000 and 1000020;\n\néœ€è¦æ³¨æ„çš„æ˜¯betweenè¦åœ¨å”¯ä¸€ç´¢å¼•ä¸Šåˆ†é¡µï¼Œä¸ç„¶ä¼šå‡ºç°æ¯é¡µå¤§å°ä¸ä¸€è‡´çš„é—®é¢˜ã€‚\n9. ç”¨è¿æ¥æŸ¥è¯¢ä»£æ›¿å­æŸ¥è¯¢è¿æ¥æŸ¥è¯¢æ˜¯ä¸€ç§æ›´é«˜æ•ˆçš„æŸ¥è¯¢æ–¹å¼ã€‚è¿æ¥æŸ¥è¯¢å¯ä»¥é¿å…å­æŸ¥è¯¢çš„æ€§èƒ½é—®é¢˜ã€‚æ¯”å¦‚ï¼š\n12select * from orderwhere user_id in (select id from user where status=1)\n\nå­æŸ¥è¯¢ä¼šå¯¼è‡´å¤§é‡çš„å›è¡¨æ“ä½œï¼Œå¯¼è‡´æŸ¥è¯¢æ•ˆç‡å¾ˆä½ã€‚ä¼˜åŒ–sqlï¼š\n123select o.* from order oinner join user u on o.user_id = u.idwhere u.status=1\n\nç”¨è¿æ¥æŸ¥è¯¢ï¼ŒæŠŠå­æŸ¥è¯¢ç»“æœä½œä¸ºä¸€ä¸ªè¡¨ï¼Œç›´æ¥ä¸ä¸»è¡¨è¿æ¥ï¼Œé¿å…äº†å›è¡¨æ“ä½œã€‚\n10. æå‡group byçš„æ•ˆç‡æˆ‘ä»¬æœ‰å¾ˆå¤šä¸šåŠ¡åœºæ™¯éœ€è¦ä½¿ç”¨group byå…³é”®å­—ï¼Œå®ƒä¸»è¦çš„åŠŸèƒ½æ˜¯å»é‡å’Œåˆ†ç»„ã€‚é€šå¸¸å®ƒä¼šè·Ÿhavingä¸€èµ·é…åˆä½¿ç”¨ï¼Œè¡¨ç¤ºåˆ†ç»„åå†æ ¹æ®ä¸€å®šçš„æ¡ä»¶è¿‡æ»¤æ•°æ®ã€‚æ¯”å¦‚ï¼š\n123select user_id,user_name from ordergroup by user_idhaving user_id &lt;= 200;\n\nè¿™ç§å†™æ³•æ€§èƒ½ä¸å¥½ï¼Œå®ƒå…ˆæŠŠæ‰€æœ‰çš„è®¢å•æ ¹æ®ç”¨æˆ·idåˆ†ç»„ä¹‹åï¼Œå†å»è¿‡æ»¤ç”¨æˆ·idå¤§äºç­‰äº200çš„ç”¨æˆ·ã€‚åˆ†ç»„æ˜¯ä¸€ä¸ªç›¸å¯¹è€—æ—¶çš„æ“ä½œï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸å…ˆç¼©å°æ•°æ®çš„èŒƒå›´ä¹‹åï¼Œå†åˆ†ç»„å‘¢ï¼Ÿä¼˜åŒ–sqlï¼š\n123select user_id,user_name from orderwhere user_id &lt;= 200group by user_id\n\nä½¿ç”¨whereæ¡ä»¶åœ¨åˆ†ç»„å‰ï¼Œå°±æŠŠå¤šä½™çš„æ•°æ®è¿‡æ»¤æ‰äº†ï¼Œè¿™æ ·åˆ†ç»„æ—¶æ•ˆç‡å°±ä¼šæ›´é«˜ä¸€äº›ã€‚å…¶å®è¿™æ˜¯ä¸€ç§æ€è·¯ï¼Œä¸ä»…é™äºgroup byçš„ä¼˜åŒ–ã€‚æˆ‘ä»¬çš„sqlè¯­å¥åœ¨åšä¸€äº›è€—æ—¶çš„æ“ä½œä¹‹å‰ï¼Œåº”å°½å¯èƒ½ç¼©å°æ•°æ®èŒƒå›´ï¼Œè¿™æ ·èƒ½æå‡sqlæ•´ä½“çš„æ€§èƒ½ã€‚\n11. ç´¢å¼•ä¼˜åŒ–å¾ˆå¤šæ—¶å€™sqlè¯­å¥ï¼Œèµ°äº†ç´¢å¼•ï¼Œå’Œæ²¡æœ‰èµ°ç´¢å¼•ï¼Œæ‰§è¡Œæ•ˆç‡å·®åˆ«å¾ˆå¤§ã€‚æ‰€ä»¥ç´¢å¼•ä¼˜åŒ–è¢«ä½œä¸ºsqlä¼˜åŒ–çš„é¦–é€‰ã€‚ç´¢å¼•ä¼˜åŒ–çš„ç¬¬ä¸€æ­¥æ˜¯ï¼šæ£€æŸ¥sqlè¯­å¥æœ‰æ²¡æœ‰èµ°ç´¢å¼•ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•æŸ¥çœ‹sqlèµ°äº†ç´¢å¼•æ²¡ï¼Ÿå¯ä»¥ä½¿ç”¨explainå‘½ä»¤ï¼ŒæŸ¥çœ‹mysqlçš„æ‰§è¡Œè®¡åˆ’ã€‚\n1explain select * from user where id = 1;\n\n\nsqlè¯­å¥æ²¡æœ‰èµ°ç´¢å¼•ï¼Œæ’é™¤æ²¡æœ‰å»ºç´¢å¼•ä¹‹å¤–ï¼Œæœ€å¤§çš„å¯èƒ½æ€§æ˜¯ç´¢å¼•å¤±æ•ˆäº†ã€‚\næ­¤å¤–ï¼Œä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·ä¸€ç§æƒ…å†µï¼šæ˜æ˜æ˜¯åŒä¸€æ¡sqlï¼Œåªæœ‰å…¥å‚ä¸åŒè€Œå·²ã€‚æœ‰çš„æ—¶å€™èµ°çš„ç´¢å¼•aï¼Œæœ‰çš„æ—¶å€™å´èµ°çš„ç´¢å¼•bï¼Ÿæ²¡é”™ï¼Œæœ‰æ—¶å€™mysqlä¼šé€‰é”™ç´¢å¼•ã€‚å¿…è¦æ—¶å¯ä»¥ä½¿ç”¨force indexæ¥å¼ºåˆ¶æŸ¥è¯¢sqlèµ°æŸä¸ªç´¢å¼•ã€‚\n","slug":"Sqlä¼˜åŒ–æ–¹æ³•","date":"2024-11-21T00:00:00.000Z","categories_index":"æ•°æ®åº“","tags_index":"Sql","author_index":"FaceMan"},{"id":"584404787b0b0e754117ced08ab7daf6","title":"NFS for CentOS","content":"NFS for CentOSNFSä»‹ç»NFSä»‹ç»NFS å³ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNetwork File-Systemï¼‰ï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œè®©ä¸åŒæœºå™¨ã€ä¸åŒç³»ç»Ÿä¹‹é—´å¯ä»¥å®ç°æ–‡ä»¶å…±äº«ã€‚é€šè¿‡ NFSï¼Œå¯ä»¥è®¿é—®è¿œç¨‹å…±äº«ç›®å½•ï¼Œå°±åƒè®¿é—®æœ¬åœ°ç£ç›˜ä¸€æ ·ã€‚NFS åªæ˜¯ä¸€ç§æ–‡ä»¶ç³»ç»Ÿï¼Œæœ¬èº«å¹¶æ²¡æœ‰ä¼ è¾“åŠŸèƒ½ï¼Œæ˜¯åŸºäº RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰åè®®å®ç°çš„ï¼Œé‡‡ç”¨ C&#x2F;S æ¶æ„ã€‚\nå®‰è£…ç›®æ ‡ï¼šå®ç°Aå…±äº«ç›®å½•ï¼ŒBè®¿é—®Aã€‚\nå‰ç½®æ¡ä»¶ï¼šå‡†å¤‡ä¸¤å°ä¸»æœºAå’ŒBï¼Œä¸”åœ¨åŒä¸€å±€åŸŸç½‘ã€‚\n\nAå®‰è£…NFSè½¯ä»¶åŒ…\n1sudo yum install nfs-utils\né…ç½® NFS æœåŠ¡ç«¯\nç¼–è¾‘ /etc/exports æ–‡ä»¶ï¼Œæ·»åŠ éœ€è¦å…±äº«çš„ç›®å½•åŠå…¶æƒé™è®¾ç½®ã€‚\nä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦å…±äº« /mnt/data ç›®å½•ï¼Œå¹¶ä¸”å…è®¸æ‰€æœ‰å®¢æˆ·ç«¯è¯»å†™è®¿é—®ï¼š\n1/mnt/data  *(rw,sync,no_root_squashva\n\nå…¶ä¸­ï¼š\n\n/mnt/data æ˜¯éœ€è¦å…±äº«çš„ç›®å½•ã€‚\n&#96;&#96; è¡¨ç¤ºå…è®¸æ‰€æœ‰å®¢æˆ·ç«¯è®¿é—®ã€‚\nrw è¡¨ç¤ºå…è®¸è¯»å†™è®¿é—®ã€‚\nsync è¡¨ç¤ºåŒæ­¥å†™å…¥ç£ç›˜ï¼Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚\nno_root_squash è¡¨ç¤ºå…è®¸ root ç”¨æˆ·è®¿é—®å…±äº«ç›®å½•ã€‚\n\nä¿å­˜ä¿®æ”¹åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡æ–°åŠ è½½é…ç½®ï¼š\n1sudo exportfs -r\nå¯åŠ¨ NFS æœåŠ¡ç«¯\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ NFS æœåŠ¡ç«¯ï¼š\n1sudo systemctl start nfs-server\n\nå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æœåŠ¡æ˜¯å¦å·²å¯åŠ¨ï¼š\n1sudo systemctl status nfs-server\nBé…ç½® NFS å®¢æˆ·ç«¯\nåœ¨Bä¸Šï¼Œå®‰è£… NFS è½¯ä»¶åŒ…ï¼š\n1sudo yum install nfs-utils\n\nç„¶åè¿è¡Œä¹‹åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‚è½½å…±äº«ç›®å½•ï¼š\n1sudo mount server:/mnt/data /mnt/nfs\n\nå…¶ä¸­ï¼š\n\nserver æ˜¯ NFS æœåŠ¡ç«¯çš„ IP åœ°å€æˆ–ä¸»æœºåã€‚\n/mnt/data æ˜¯å…±äº«çš„ç›®å½•ã€‚\n/mnt/nfs æ˜¯æŒ‚è½½åˆ°å®¢æˆ·ç«¯ä¸Šçš„ç›®å½•ã€‚\n\n\n5.éªŒè¯ NFS æœåŠ¡\nå¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸Šåˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶ï¼Œç„¶ååœ¨æœåŠ¡ç«¯ä¸ŠæŸ¥çœ‹æ˜¯å¦åŒæ­¥æ›´æ–°ã€‚\nå¦‚æœéœ€è¦å¸è½½ NFS å…±äº«ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1sudo umount /mnt/nfs\n\né—®é¢˜è§£å†³mount.nfs: No route to hostè¿™ä¸ªé”™è¯¯é€šå¸¸è¡¨ç¤ºæ— æ³•åˆ°è¾¾ç›®æ ‡ä¸»æœºã€‚è¯·ç¡®ä¿åœ¨æ‰§è¡Œè¯¥å‘½ä»¤ä¹‹å‰ï¼Œæ‚¨çš„æœºå™¨å¯ä»¥è®¿é—®ç›®æ ‡æœºå™¨çš„ IP åœ°å€ï¼Œå¹¶ä¸”ç›®æ ‡æœºå™¨ä¸Šçš„ NFS æœåŠ¡æ­£åœ¨è¿è¡Œã€‚\næ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š\n\næ£€æŸ¥ç½‘ç»œè¿æ¥\nè¯·æ£€æŸ¥æ‚¨çš„æœºå™¨ä¸ç›®æ ‡æœºå™¨ä¹‹é—´çš„ç½‘ç»œè¿æ¥ï¼Œç¡®ä¿å®ƒä»¬å¯ä»¥äº’ç›¸è®¿é—®ã€‚æ‚¨å¯ä»¥å°è¯•ä½¿ç”¨ ping å‘½ä»¤æ¥æµ‹è¯•ç½‘ç»œè¿æ¥ï¼Œä¾‹å¦‚ï¼š\n1ping 192.168.2.164\nå¦‚æœæ— æ³• ping é€šç›®æ ‡æœºå™¨ï¼Œå¯èƒ½éœ€è¦æ£€æŸ¥æ‚¨çš„ç½‘ç»œè®¾ç½®æˆ–é˜²ç«å¢™é…ç½®ã€‚\n\næ£€æŸ¥ç›®æ ‡æœºå™¨çš„ NFS æœåŠ¡çŠ¶æ€\nè¯·ç¡®ä¿ç›®æ ‡æœºå™¨ä¸Šçš„ NFS æœåŠ¡æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸”å·²æ­£ç¡®é…ç½®å…±äº«ç›®å½•ã€‚æ‚¨å¯ä»¥å°è¯•åœ¨ç›®æ ‡æœºå™¨ä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ NFS æœåŠ¡çŠ¶æ€\n\næ£€æŸ¥ç›®æ ‡æœºå™¨çš„é˜²ç«å¢™è®¾ç½®\nå¦‚æœç›®æ ‡æœºå™¨çš„é˜²ç«å¢™å·²å¯ç”¨ï¼Œè¯·ç¡®ä¿å·²å°† NFS æœåŠ¡ç«¯å£æ·»åŠ åˆ°é˜²ç«å¢™è§„åˆ™ä¸­ã€‚NFS é»˜è®¤ä½¿ç”¨ TCP å’Œ UDP ç«¯å£ 2049ã€‚æ‚¨å¯ä»¥å°è¯•ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ç›®æ ‡æœºå™¨ä¸Šçš„é˜²ç«å¢™è®¾ç½®ï¼š\n1firewall-cmd --list-all\nå¦‚æœéœ€è¦ï¼Œè¯·æ·»åŠ é˜²ç«å¢™è§„åˆ™ï¼Œä¾‹å¦‚ï¼š\n12firewall-cmd --add-service=nfs --permanentfirewall-cmd --reload\n\n","slug":"NFSforCentOS","date":"2024-11-19T00:00:00.000Z","categories_index":"DevOps","tags_index":"CentOS,Linux","author_index":"FaceMan"},{"id":"d153e7aca8864e461d50ee65cfb7c4b4","title":"c#å®ç°å¯¹è¯è®°å½•è½¬PDFã€Wordã€MDæ–‡ä»¶","content":"å·¥ä½œä¸­æœ‰ä¸ªåœºæ™¯æ˜¯chatgptèŠå¤©å¯¹è¯è®°å½•ä¸‹è½½æ”¯æŒPDFã€Wordã€MDæ ¼å¼ï¼Œäºæ˜¯æœ‰äº†æœ¬ç¯‡æ–‡ç« ã€‚\nå®ç°æ€è·¯å¯¹è¯ä¸­å¯èƒ½ä¼šç”¨mdæ ¼å¼çš„å›ç­”ï¼Œä¸”å› ä¸ºä¸èƒ½ç›´æ¥è½¬æˆpdfæˆ–è€…wordï¼Œæ‰€ä»¥è¿™é‡Œé€šè¿‡æ–¹æ³•è½¬æˆmdæˆ–è€…htmlä»£ç ï¼Œä½¿ç”¨htmlæ ¼å¼è½¬æˆpdfæˆ–è€…wordã€‚\nä»£ç å®ç°éœ€è¦çš„nugetåŒ…\nhtmlè½¬pdfiTextSharpitextsharp.xmlworker\nhtmlè½¬wordFreeSpire.Doc\nmdè½¬htmlMarkdig\n\nåˆ›å»ºHtmlHelperå¸®åŠ©ç±»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293/// &lt;summary&gt;/// HTMLå¸®åŠ©ç±»/// &lt;/summary&gt;public class HtmlHelper&#123;\t/// &lt;summary&gt;\t/// å­—ä½“è·¯å¾„\t/// &lt;/summary&gt;\tprivate static string FontPath;\tpublic HtmlHelper(string fontPath)\t&#123;\t\tFontPath = fontPath;\t&#125;\tpublic HtmlHelper()\t&#123;\t&#125;\t//å°†htmlå­—ç¬¦ä¸²è½¬ä¸ºpdfå­—èŠ‚æ•°ç»„\tpublic byte[] ConvertHtmlTextToPDF(string htmlText)\t&#123;\t\tif (string.IsNullOrEmpty(htmlText))\t\t&#123;\t\t\treturn null;\t\t&#125;\t\ttry\t\t&#123;\t\t\tMemoryStream outputStream = new MemoryStream(); //è¦æŠŠPDFå¯«åˆ°å“ªå€‹ä¸²æµ\t\t\tbyte[] data = Encoding.UTF8.GetBytes(htmlText); //å­—ä¸²è½‰æˆbyte[]\t\t\tMemoryStream msInput = new MemoryStream(data);\t\t\tDocument doc = new Document(); //è¦å¯«PDFçš„æ–‡ä»¶ï¼Œå»ºæ§‹å­æ²’å¡«çš„è©±é è¨­ç›´å¼A4\t\t\tPdfWriter writer = PdfWriter.GetInstance(doc, outputStream);\t\t\t//æŒ‡å®šæ–‡ä»¶é è¨­é–‹æª”æ™‚çš„ç¸®æ”¾ç‚º100%\t\t\tPdfDestination pdfDest = new PdfDestination(PdfDestination.XYZ, 0, doc.PageSize.Height, 1f);\t\t\t//é–‹å•ŸDocumentæ–‡ä»¶ \t\t\tdoc.Open();\t\t\t//ä½¿ç”¨XMLWorkerHelperæŠŠHtml parseåˆ°PDFæª”è£¡\t\t\tXMLWorkerHelper.GetInstance().ParseXHtml(writer, doc, msInput, null, Encoding.UTF8, new UnicodeFontFactory());\t\t\t//å°‡pdfDestè¨­å®šçš„è³‡æ–™å¯«åˆ°PDFæª”\t\t\tPdfAction action = PdfAction.GotoLocalPage(1, pdfDest, writer);\t\t\twriter.SetOpenAction(action);\t\t\tdoc.Close();\t\t\tmsInput.Close();\t\t\toutputStream.Close();\t\t\treturn outputStream.ToArray();\t\t&#125;\t\tcatch (Exception ex)\t\t&#123;\t\t\tthrow new UserFriendlyException(&quot;è½¬PDFæ—¶å¼‚å¸¸,è¯·è”ç³»ç®¡ç†å‘˜ï¼&quot;, ex);\t\t&#125;\t&#125;\t//å°†htmlå­—ç¬¦ä¸²è½¬ä¸ºwordå­—èŠ‚æ•°ç»„\tpublic byte[] ConvertHtmlTextToWord(string htmlText)\t&#123;\t\tif (string.IsNullOrEmpty(htmlText))\t\t&#123;\t\t\treturn null;\t\t&#125;\t\ttry\t\t&#123;\t\t\tMemoryStream outputStream = new MemoryStream(); //è¦æŠŠWordå¯«åˆ°å“ªå€‹ä¸²æµ\t\t\tbyte[] data = Encoding.UTF8.GetBytes(htmlText); //å­—ä¸²è½‰æˆbyte[]\t\t\tMemoryStream  stream = new MemoryStream(data);\t\t\tSpire.Doc.Document doc = new Spire.Doc.Document(); //è¦å¯«Wordçš„æ–‡ä»¶ï¼Œå»ºæ§‹å­æ²’å¡«çš„è©±é è¨­ç›´å¼A4\t\t\tdoc.LoadFromStream(stream, FileFormat.Html, XHTMLValidationType.None);\t\t\tdoc.SaveToStream(outputStream, FileFormat.Docx);\t\t\tdoc.Close();\t\t\treturn outputStream.ToArray();\t\t&#125;\t\tcatch (Exception ex)\t\t&#123;\t\t\tthrow new UserFriendlyException(&quot;è½¬Wordæ—¶å¼‚å¸¸,è¯·è”ç³»ç®¡ç†å‘˜ï¼&quot;, ex);\t\t&#125;\t&#125;\t//å­—ä½“å·¥å‚\tpublic class UnicodeFontFactory : FontFactoryImp\t&#123;\t\tpublic override Font GetFont(string fontname, string encoding, bool embedded, float size, int style, BaseColor color,\t\t\tbool cached)\t\t&#123;\t\t\tBaseFont baseFont = BaseFont.CreateFont(FontPath, BaseFont.IDENTITY_H, BaseFont.EMBEDDED);\t\t\treturn new Font(baseFont, size, style, color);\t\t&#125;\t&#125;&#125;\n\nåˆ›å»ºæµ‹è¯•ä¿¡æ¯ç±»12345public class Message&#123;\tpublic string Type &#123; get; set; &#125;\tpublic string Context &#123; get; set; &#125;&#125;\n\né€šè¿‡æ§åˆ¶å™¨è°ƒç”¨ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144public class FileControllerï¼šController&#123;\tprivate readonly IHttpContextAccessor _httpContextAccessor;\tpublic FileController(IHttpContextAccessor httpContextAccessorï¼‰\t&#123;\t\t_httpContextAccessor=httpContextAccessor;\t&#125;\t\t/// &lt;summary&gt;\t\t/// å¯¼å‡ºå½“å‰å¯¹è¯å…¨éƒ¨ä¿¡æ¯ä¸ºMarkdown\t\t/// &lt;/summary&gt;\t\t/// &lt;param name=&quot;messageId&quot;&gt;&lt;/param&gt;\t\t/// &lt;returns&gt;&lt;/returns&gt;\t\t[HttpGet]\t\t[DisableAuditing]\t\tpublic async Task&lt;IActionResult&gt; GenerateAllMarkdown()\t\t&#123;\t\t\tvar stringBuilder = await GenerateFile(&quot;md&quot;);\t\t\tbyte[] markdownBytes = Encoding.UTF8.GetBytes(stringBuilder);\t\t\tvar fileName = $&quot;æ–‡ä»¶åç§°-&#123;Clock.Now.ToString(&quot;yyyyMMddHHmmss&quot;)&#125;.md&quot;;\t\t\tvar contentType = &quot;text/markdown&quot;;\t\t\treturn File(markdownBytes, contentType, fileName);\t\t&#125;\t\t/// &lt;summary&gt;\t\t/// å¯¼å‡ºå½“å‰å¯¹è¯å…¨éƒ¨ä¿¡æ¯ä¸ºWord\t\t/// &lt;/summary&gt;\t\t/// &lt;param name=&quot;messageId&quot;&gt;&lt;/param&gt;\t\t/// &lt;returns&gt;&lt;/returns&gt;\t\t[HttpGet]\t\t[DisableAuditing]\t\tpublic async Task&lt;ActionResult&gt; GenerateAllWord()\t\t&#123;\t\t\tvar stringBuilder = await GenerateFile(&quot;html&quot;);\t\t\tHtmlHelper pdfHelper = new HtmlHelper();\t\t\tvar byteData = pdfHelper.ConvertHtmlTextToWord(stringBuilder);\t\t\tvar fileName = $&quot;æ–‡ä»¶åç§°-&#123;Clock.Now.ToString(&quot;yyyyMMddHHmmss&quot;)&#125;.docx&quot;;\t\t\tvar contentType = &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;;\t\t\treturn File(byteData, contentType, fileName);\t\t&#125;\t\t\t/// &lt;summary&gt;\t\t/// å¯¼å‡ºå½“å‰å¯¹è¯å…¨éƒ¨ä¿¡æ¯ä¸ºPDF\t\t/// &lt;/summary&gt;\t\t/// &lt;param name=&quot;chatId&quot;&gt;&lt;/param&gt;\t\t/// &lt;param name=&quot;chatUserId&quot;&gt;&lt;/param&gt;\t\t/// &lt;returns&gt;&lt;/returns&gt;\t\t/// &lt;exception cref=&quot;UserFriendlyException&quot;&gt;&lt;/exception&gt;\t\t[HttpGet]\t\t[DisableAuditing]\t\tpublic async Task&lt;ActionResult&gt; GeneratePDF()\t\t&#123;\t\t\t var stringBuilder = await GenerateFile(&quot;html&quot;);\t\t\tstring fontPath = Path.Combine(&quot;å­—ä½“åœ°å€&quot;, &quot;Nsimsun.ttf&quot;);\t\t\tHtmlHelper pdfHelper = new HtmlHelper(fontPath);\t\t\tvar byteData = pdfHelper.ConvertHtmlTextToPDF(stringBuilder);//ç”ŸæˆPDF\t\t\tvar fileName = $&quot;æ–‡ä»¶åç§°-&#123;Clock.Now.ToString(&quot;yyyyMMddHHmmss&quot;)&#125;.pdf&quot;;\t\t\tvar contentType = &quot;application/pdf&quot;;\t\t\treturn File(byteData, contentType, fileName);\t\t&#125;\tprivate async Task&lt;string&gt; GenerateFile(string type)\t&#123;\t\tvar title = &quot;æˆ‘æ˜¯æ ‡é¢˜&quot;;\t\tvar UserName = &quot;æˆ‘æ˜¯ç”¨æˆ·&quot;;\t\tvar Url = &quot;æˆ‘æ˜¯é“¾æ¥&quot;;\t\tList&lt;Message&gt; currentMessage = new List&lt;Message&gt;()\t\t&#123;\t\t\tnew Message()\t\t\t&#123;\t\t\t\tType =&quot;user&quot;,\t\t\t\tContext=&quot;ä½ æ˜¯è°&quot;\t\t\t&#125;ï¼Œ\t\t\tnew Message()\t\t\t&#123;\t\t\t\tType =&quot;bot&quot;,\t\t\t\tContext=&quot;helloï¼Œæˆ‘æ˜¯chatgpt&quot;\t\t\t&#125;\t\t\t//...\t\t&#125;;\t\t//ä¿¡æ¯æŸ¥è¯¢æ“ä½œã€‚ã€‚ã€‚ã€‚\t\tstring stringBuilder = default;\t\tstring symbolA = &quot;&quot;;\t\tstring symbolB = &quot;&quot;;\t\tswitch (type)\t\t&#123;\t\t\tcase &quot;html&quot;:\t\t\t\tsymbolA = &quot;&lt;strong&gt;&quot;;\t\t\t\tsymbolB = &quot;&lt;/strong&gt;&quot;;\t\t\t\tbreak;\t\t\tcase &quot;md&quot;:\t\t\t\tsymbolA = &quot;**&quot;;\t\t\t\tsymbolB = &quot;**&quot;;\t\t\t\tbreak;\t\t&#125;\t\t//è®¾ç½®æ ‡é¢˜\t\tstringBuilder += $&quot;# &#123;title&#125; \\n&quot;;\t\tforeach (var item in allMessages)\t\t&#123;\t\t\tif (item.Type == &quot;bot&quot;)\t\t\t&#123;\t\t\t\tstringBuilder += $&quot;&#123;symbolA&#125; AIå›ç­”ï¼š&#123;symbolB&#125;  \\n&quot;;\t\t\t&#125;\t\t\telse\t\t\t&#123;\t\t\t\tstringBuilder += $&quot;&#123;symbolA&#125; ç”¨æˆ·æé—®ï¼š&#123;symbolB&#125;  \\n&quot;;\t\t\t&#125;\t\t\tstringBuilder += $&quot;&#123;item.Content&#125; \\n&quot;;\t\t\tstringBuilder += &quot;\\n&quot;;\t\t&#125;\t\tvar request = _httpContextAccessor.HttpContext.Request;\t\tstring fullUrl = $&quot;&#123;request.Scheme&#125;://&#123;request.Host&#125;&quot;;\t\tstringBuilder += $&quot;&gt; ç¼–è¾‘äº &#123;DateTime.Now&#125;\\n &quot; +\t\t\t$&quot;&gt;ä½œè€…ï¼š&#123;UserName&#125; \\n &quot; +\t\t\t$&quot;&gt;é“¾æ¥ï¼š&#123;Url&#125;\\n &quot; +\t\t\t$&quot;&gt;æ¥æºï¼šæˆ‘æ˜¯æ¥æº&quot;;\t\tif (type == &quot;html&quot;)\t\t&#123;\t\t\tstringBuilder = Markdown.ToHtml(stringBuilder);\t\t\tstringBuilder = stringBuilder.Replace(&quot;/n&quot;, &quot;&lt;br /&gt;&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;&lt;p&gt;&quot;, &quot;&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;&lt;/p&gt;&quot;, &quot;&lt;br /&gt;&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;AIå›ç­”ï¼š&quot;, &quot;&lt;br /&gt; AIå›ç­”ï¼š&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;ç”¨æˆ·æé—®ï¼š&quot;, &quot;&lt;br /&gt; ç”¨æˆ·æé—®ï¼š&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;&lt;blockquote&gt;&quot;, &quot;&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;&lt;/blockquote&gt;&quot;, &quot;&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;ç¼–è¾‘äºï¼š&quot;, &quot;&lt;br /&gt;&lt;br /&gt; ç¼–è¾‘äºï¼š&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;ä½œè€…ï¼š&quot;, &quot;&lt;br /&gt; ä½œè€…ï¼š&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;é“¾æ¥ï¼š&quot;, &quot;&lt;br /&gt; é“¾æ¥ï¼š&quot;);\t\t\tstringBuilder = stringBuilder.Replace(&quot;æ¥æºï¼š&quot;, &quot;&lt;br /&gt; æ¥æºï¼š&quot;);\t\t\tstringBuilder = $&quot;\\r\\n&lt;!DOCTYPE html&gt;\\r\\n&lt;html&gt;\\r\\n&lt;head&gt;\\r\\n    &lt;meta charset=\\&quot;utf-8\\&quot; /&gt;\\r\\n    &lt;title&gt;&#123;currentChat.Name&#125;&lt;/title&gt;\\r\\n&lt;/head&gt;\\r\\n&lt;body&gt;\\r\\n&quot; + stringBuilder;\t\t\tstringBuilder += &quot;\\r\\n&lt;/body&gt;\\r\\n&lt;/html&gt;&quot;;\t\t&#125;\t\treturn stringBuilder;\t&#125;&#125;\n","slug":"c#å®ç°å¯¹è¯è®°å½•è½¬PDFã€Wordã€MDæ–‡ä»¶","date":"2024-11-19T00:00:00.000Z","categories_index":".Net","tags_index":"c#,.Net","author_index":"FaceMan"},{"id":"09bfaf6dad899e5435cf142c3bc6c1cb","title":"Ubuntuåœ¨å®¹å™¨ä¸­é€šè¿‡bakæ–‡ä»¶è¿˜åŸæ•°æ®åº“","content":"åœ¨å®¹å™¨ä¸­é€šè¿‡bakæ–‡ä»¶è¿˜åŸæ•°æ®åº“1ã€æµ‹è¯•ç¯å¢ƒéœ€è¦è¿ç§»åˆ°å¦ä¸€å°è™šæ‹Ÿæœºä¸Šæ—¶\n\nå¯ä»¥ä½¿ç”¨nfsçš„æ–¹å¼è·å–å¤‡ä»½æ–‡ä»¶ï¼Œå³ä¸Šè§’æœç´¢å¦ä¸€ç¯‡æ–‡ç« ï¼šNFS for CentOS\nä½¿ç”¨scpå‘½ä»¤ä»æœ¬æœºæ‹·è´æ–‡ä»¶åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œåªéœ€è¦æä¾›ç›®æ ‡æœåŠ¡å™¨è´¦å·å’Œå¯†ç ã€‚\n\n1scp /path filename root@ç›®æ ‡æœåŠ¡å™¨ipåœ°å€ï¼š/path\n\n\n2ã€è¦ä¿è¯å®¹å™¨å†…éƒ¨ç©ºé—´å¯ä»¥å®¹çº³bakæ–‡ä»¶å¤§å°çš„ç©ºé—´ï¼Œä½¿ç”¨df -h æŸ¥çœ‹ï¼Œå¦‚æœä¸å¤Ÿéœ€è¦ç°åœ¨å¤–é¢ä¿®æ”¹æœ¬æœºçš„å®¹é‡é…ç½®ï¼Œå…·ä½“æ–¹æ³•å‚è€ƒä¸Šæ–‡æ‰©å¤§è™šæ‹Ÿç¡¬ç›˜å®¹é‡ï¼Œä¸»è¦æ˜¯æ‰©å¤§centos-rootçš„å®¹é‡ã€‚\n\n3ã€æ ¹æ®ä¸Šè¿°æˆ‘ä»¬å·²ç»å¯ä»¥æ‹¿åˆ°æ–‡ä»¶äº†ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦å°†æ–‡ä»¶ç§»åŠ¨åˆ°dockeré•œåƒä¸­\n1docker cp /mnt/nfs/gct_medPro_22_12_28_13_40.bak 1e057306ae58:/\n\nå…¶ä¸­ï¼š\n\n&#x2F;mnt&#x2F;nfs&#x2F;gct_medPro_22_12_28_13_40.bak æ˜¯ä½ åœ¨å…±äº«æ–‡ä»¶çš„æ‰€å±ä½ç½®\n1e057306ae58 æ˜¯å®¹å™¨id æˆ–åˆ™å®¹å™¨åå­—ä¹Ÿå¯ä»¥\n\nè¿›å…¥å®¹å™¨å†…éƒ¨ï¼Œç„¶åæ‰§è¡Œè¿˜åŸå‘½ä»¤ã€\n123/opt/mssql-tools/bin/sqlcmd \\-S localhost -U sa -P &lt;your_password&gt; \\-Q &quot;RESTORE DATABASE &lt;new_database_name&gt; FROM DISK=&#x27;&lt;path-inside-container&gt;/&lt;backup-file-name&gt;.bak&#x27; WITH MOVE &#x27;&lt;logical_data_name&gt;&#x27; TO &#x27;&lt;new_data_file_path&gt;&#x27;, MOVE &#x27;&lt;logical_log_name&gt;&#x27; TO &#x27;&lt;new_log_file_path&gt;&#x27;, REPLACE, STATS=5&quot;\n\nå…¶ä¸­ &lt;container-name&gt; æ˜¯å®¹å™¨çš„åç§°ï¼Œ&lt;your_password&gt; æ˜¯ SQL Server çš„ç®¡ç†å‘˜å¯†ç ï¼Œ&lt;new_database_name&gt; æ˜¯ä½ æƒ³è¦åˆ›å»ºçš„æ–°æ•°æ®åº“çš„åç§°ï¼Œ&lt;path-inside-container&gt; æ˜¯ä¹‹å‰å¤åˆ¶å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„ï¼Œ&lt;backup-file-name&gt; æ˜¯å¤‡ä»½æ–‡ä»¶çš„åç§°ï¼Œ&lt;logical_data_name&gt; å’Œ &lt;logical_log_name&gt; æ˜¯å¤‡ä»½æ–‡ä»¶ä¸­çš„é€»è¾‘æ–‡ä»¶åï¼Œ&lt;new_data_file_path&gt; å’Œ &lt;new_log_file_path&gt; æ˜¯ä½ æƒ³è¦ä¸ºæ–°æ•°æ®åº“æŒ‡å®šçš„æ•°æ®æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ã€‚\nä¾‹å¦‚ï¼š\n12345#æˆ‘å…ˆæŸ¥çœ‹è¿˜åŸæ–‡ä»¶ä½ç½®root@1e057306ae58:/# lsbin  boot  dev  etc  gct_medPro_22_12_28_13_40.bak  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  varç„¶åæ‰§è¡Œroot@1e057306ae58:/# /opt/mssql-tools/bin/sqlcmd -S localhost -U SA -P &#x27;bb123456??&#x27; -Q &quot;RESTORE DATABASE gct_medPro FROM DISK=&#x27;/gct_medPro_22_12_28_13_40.bak&#x27; WITH MOVE &#x27;gct_medPro&#x27; TO &#x27;/var/opt/mssql/data/gct_medPro.mdf&#x27;, MOVE &#x27;gct_medPro_log&#x27; TO &#x27;/var/opt/mssql/data/gct_medPro.ldf&#x27;&quot;\n\nçœ‹åˆ°è¿™ä¸ªä½ å°±èµ¢äº†ã€‚\n\n","slug":"åœ¨å®¹å™¨ä¸­é€šè¿‡bakæ–‡ä»¶è¿˜åŸæ•°æ®åº“","date":"2024-11-19T00:00:00.000Z","categories_index":"DevOps","tags_index":"Docker,Linux,Ubuntu,æ•°æ®åº“","author_index":"FaceMan"},{"id":"b41db14a99677b936cf320d0d9be73f1","title":"DockerSwarmç¯å¢ƒæ­å»º","content":"Swarmç¯å¢ƒæ­å»ºç³»ç»Ÿè§„åˆ’\nç¯å¢ƒå‡†å¤‡åˆ›å»ºæœåŠ¡å™¨æ–°å»ºä¸‰å°è™šæ‹Ÿæœº\n\n\n\nèŠ‚ç‚¹\nIP\nç³»ç»Ÿ\né…ç½®\nå­˜å‚¨\næœåŠ¡\n\n\n\nmanager\n192.168.2.xx\nCentOS7.6\n8U16G\n100G\nredis,frp,mssql\n\n\nworker1\n192.168.2.xx\nCentOS7.6\n4U8G\n80G\napp\n\n\nworker2\n192.168.2.xx\nCentOS7.6\n4U8G\n80G\napp\n\n\næ—¶é—´åŒæ­¥æ—¶é—´åŒæ­¥ä»»åŠ¡\n1234567891011121314yum install -y ntpcat &lt;&lt;EOF&gt;&gt;/var/spool/cron/root# 12ç‚¹åŒæ­¥00 12 * * * /usr/sbin/ntpdate -u ntp1.aliyun.com &amp;&amp; /usr/sbin/hwclock -w# 23ï¼š59åˆ†æ‰§è¡Œåˆ é™¤59 23 * * *  docker image prune -afEOF##æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡crontab -l##æ‰‹åŠ¨æ‰§è¡Œ/usr/sbin/ntpdate -u ntp1.aliyun.com &amp;&amp; /usr/sbin/hwclock -w\n\nDockerå®‰è£…Docker1curl -sSL http://mirror.dev.gct-china.com/docker/install.sh | sh\n\nå¯åŠ¨docker\n12sudo systemctl start dockersudo systemctl enable docker\n\né˜²ç«å¢™\n\n\n\n\n\n\n\n\nError response from daemon: rpc error: code &#x3D; Unavailable desc &#x3D; connection error: desc &#x3D; â€œtransport: Error while dialing dial tcp 192.168.2.61:2377: connect: no route to hostâ€\næ‰“å¼€é˜²ç«å¢™\n123456789101112# managerfirewall-cmd --zone=public --add-port=2377/tcp --permanent# æ‰€æœ‰nodefirewall-cmd --zone=public --add-port=7946/tcp --permanentfirewall-cmd --zone=public --add-port=7946/udp --permanentfirewall-cmd --zone=public --add-port=4789/tcp --permanentfirewall-cmd --zone=public --add-port=4789/udp --permanent# æ‰€æœ‰nodefirewall-cmd --reloadsystemctl restart docker\n\nè¦åœ¨ swarm é›†ç¾¤ä¸­ä½¿ç”¨ä½¿ç”¨è·¯ç”±ç½‘æ ¼ï¼Œé¦–å…ˆéœ€è¦å¼€å¯åŠ å…¥swarmé›†ç¾¤çš„èŠ‚ç‚¹çš„ä»¥ä¸‹ç«¯å£ï¼š\n\n2377 ï¼šä¸»èŠ‚ç‚¹ç›‘å¬ç«¯å£\n7946 ï¼šå®¹å™¨ç½‘ç»œå‘ç°\n4789 ï¼šå®¹å™¨ç½‘ç»œå…¥å£\n\nSwarmåˆ›å»ºSwarmåˆ›å»ºSwarm\n1docker swarm init --advertise-addr your_manager_ip\n\n\n12345678[root@manager ~]# docker swarm init --advertise-addr 192.168.2.61Swarm initialized: current node (rzds6oyb0bgvudzegpscmgiz3) is now a manager.To add a worker to this swarm, run the following command:    docker swarm join --token SWMTKN-1-51b7t8whxn8j6mdjt5perjmec9u8qguxq8tern9nill737pra2-ejc5nw5f90oz6xldcbmrl2ztu 192.168.2.61:2377To add a manager to this swarm, run &#x27;docker swarm join-token manager&#x27; and follow the instructions.\n\nåŠ å…¥Swarm1docker swarm join --token SWMTKN-1-51b7t8whxn8j6mdjt5perjmec9u8qguxq8tern9nill737pra2-ejc5nw5f90oz6xldcbmrl2ztu 192.168.2.61:2377\n\n\næŸ¥çœ‹èŠ‚ç‚¹12345[root@manager ~]# docker node lsID                            HOSTNAME   STATUS    AVAILABILITY   MANAGER STATUS   ENGINE VERSIONrzds6oyb0bgvudzegpscmgiz3 *   manager    Ready     Active         Leader           20.10.17rjj3fr5uazywwsfj6ok3f3fw3     worker1    Ready     Active                          20.10.176vkvdm3gcxip8htc6cfk8bm3n     worker2    Ready     Active                          20.10.17\n\næœåŠ¡çº¦æŸæ·»åŠ label\n12sudo docker node update --label-add role=env managersudo docker node update --label-add gct_medpro=gct_medpro zhuji\n\n\nç»™èŠ‚ç‚¹ä¹ŸåŠ ä¸Š\n1234[root@manager ~]# sudo docker node update --label-add role=app worker1worker1[root@manager ~]# sudo docker node update --label-add role=app worker2worker2\n","slug":"DockerSwarmç¯å¢ƒæ­å»º","date":"2024-11-18T16:00:00.000Z","categories_index":"DevOps","tags_index":"Docker","author_index":"FaceMan"},{"id":"fec2c7ee16664a58fd23e5c35dbd3596","title":"Ubuntuä¸€é”®å®‰è£…å¸è½½dockerå’Œdockercompose","content":"åœ¨æ–°å»ºçš„æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šç”¨å‡ æ¡å‘½ä»¤æ¥ä¸‹è½½å®‰è£…dockerå’Œdocker-composeï¼Œè¿™é‡Œä¸ºäº†é¿å…æ¯æ¬¡éƒ½å»æœç´¢å®‰è£…å‘½ä»¤ï¼Œæ‰€ä»¥å†™æˆè„šæœ¬ï¼Œæœ¬æ–‡ä»…æ”¯æŒUbuntu\\CentOSã€‚\nä¸€ã€dockeræ˜¯ä»€ä¹ˆï¼ŸDockeræ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨åŒ–å¹³å°ï¼Œç”¨äºæ„å»ºã€éƒ¨ç½²å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚å®ƒé‡‡ç”¨äº†è½»é‡çº§çš„å®¹å™¨æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œå¹¶æä¾›äº†ä¸€ç§å°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹æ‰“åŒ…åˆ°å¯ç§»æ¤çš„å®¹å™¨ä¸­çš„æ–¹å¼ã€‚\nä»¥ä¸‹æ˜¯Dockerçš„ä¸€äº›é‡è¦ç‰¹ç‚¹å’Œæ¦‚å¿µï¼š\n\nå®¹å™¨åŒ–ï¼šDockeråˆ©ç”¨Linuxå†…æ ¸çš„å®¹å™¨åŠŸèƒ½æ¥éš”ç¦»åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒï¼Œå…·æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ç©ºé—´å’Œèµ„æºé™åˆ¶ã€‚å®¹å™¨å¯ä»¥å¿«é€Ÿå¯åŠ¨ã€åœæ­¢å’Œè¿ç§»ï¼Œè€Œä¸”ç›¸äº’ä¹‹é—´å½¼æ­¤éš”ç¦»ï¼Œé¿å…äº†åº”ç”¨ç¨‹åºä¹‹é—´çš„å†²çªå’Œä¾èµ–é—®é¢˜ã€‚\né•œåƒï¼šDockerä½¿ç”¨é•œåƒæ¥æ„å»ºå®¹å™¨ã€‚é•œåƒæ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ï¼ŒåŒ…å«äº†åº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿã€åº“å’Œä¾èµ–é¡¹ã€‚é€šè¿‡ä½¿ç”¨Dockerfileå®šä¹‰æ„å»ºæ­¥éª¤ï¼Œå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„é•œåƒã€‚é•œåƒå¯ä»¥ä»Docker Hubç­‰é•œåƒä»“åº“ä¸­è·å–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„å»ºè‡ªå·±çš„é•œåƒè¿›è¡Œå®šåˆ¶ã€‚\nå®¹å™¨æ³¨å†Œè¡¨ï¼šDocker Hubæ˜¯Dockerå®˜æ–¹çš„å…¬å…±é•œåƒæ³¨å†Œè¡¨ï¼Œæä¾›äº†å¤§é‡çš„åŸºç¡€é•œåƒä¾›ç”¨æˆ·ä½¿ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„å…¬å…±å’Œç§æœ‰é•œåƒæ³¨å†Œè¡¨ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­å­˜å‚¨å’Œåˆ†äº«è‡ªå·±çš„é•œåƒã€‚\nDockerå¼•æ“ï¼šDockerå¼•æ“æ˜¯è¿è¡Œå’Œç®¡ç†å®¹å™¨çš„æ ¸å¿ƒç»„ä»¶ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼ˆDocker daemonï¼‰å’Œä¸€ä¸ªå‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼ˆDocker CLIï¼‰ã€‚å®ˆæŠ¤è¿›ç¨‹è´Ÿè´£æ„å»ºã€è¿è¡Œå’Œç®¡ç†å®¹å™¨ï¼Œè€Œå‘½ä»¤è¡Œå®¢æˆ·ç«¯æä¾›äº†äº¤äº’å¼çš„æ¥å£æ¥ä¸å®ˆæŠ¤è¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚\nç¼–æ’å’Œç®¡ç†å·¥å…·ï¼šDockeræä¾›äº†ä¸€ç³»åˆ—çš„ç¼–æ’å’Œç®¡ç†å·¥å…·ï¼Œç”¨äºç®€åŒ–å¤šä¸ªå®¹å™¨çš„éƒ¨ç½²å’Œç®¡ç†ã€‚ä¾‹å¦‚ï¼ŒDocker Composeå…è®¸é€šè¿‡ä¸€ä¸ªYAMLæ–‡ä»¶æè¿°å¤šä¸ªå®¹å™¨çš„å…³ç³»å’Œé…ç½®ï¼Œå¹¶é€šè¿‡ä¸€æ¡å‘½ä»¤å¯åŠ¨ã€åœæ­¢å’Œæ‰©å±•æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å®¹å™¨é›†ç¾¤ã€‚\nè·¨å¹³å°æ”¯æŒï¼šDockerå¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬Linuxã€Windowså’ŒMacOSç­‰ã€‚å¯¹äºLinuxå¹³å°ï¼ŒDockerç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å®¹å™¨åŠŸèƒ½ï¼›è€Œå¯¹äºWindowså’ŒMacOSï¼ŒDockerä½¿ç”¨ä¸€ä¸ªè½»é‡çº§çš„è™šæ‹Ÿæœºï¼ˆç§°ä¸ºDocker Desktopï¼‰æ¥æä¾›å®¹å™¨åŒ–ç¯å¢ƒã€‚\nç”Ÿæ€ç³»ç»Ÿï¼šDockeræ‹¥æœ‰åºå¤§çš„å¼€å‘è€…ç¤¾åŒºå’Œä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿã€‚ç¤¾åŒºæä¾›äº†å¤§é‡çš„æ–‡æ¡£ã€æ•™ç¨‹å’Œç¤ºä¾‹ä»£ç ï¼Œä»¥åŠäº¤æµå’Œæ”¯æŒçš„å¹³å°ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰è®¸å¤šç¬¬ä¸‰æ–¹å·¥å…·å’ŒæœåŠ¡ï¼Œå¦‚ç›‘æ§å·¥å…·ã€CI&#x2F;CDé›†æˆç­‰ï¼Œä¸Dockeré›†æˆï¼Œè¿›ä¸€æ­¥æ‰©å±•äº†å…¶åŠŸèƒ½å’Œç”¨é€”ã€‚\n\næ€»ç»“èµ·æ¥ï¼ŒDockeræ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®¹å™¨åŒ–å¹³å°ï¼Œé€šè¿‡å°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹æ‰“åŒ…åˆ°ç‹¬ç«‹çš„å®¹å™¨ä¸­ï¼Œæä¾›äº†æ›´åŠ çµæ´»ã€å¯ç§»æ¤å’Œå¯æ‰©å±•çš„åº”ç”¨éƒ¨ç½²å’Œç®¡ç†æ–¹å¼ã€‚å®ƒå·²ç»æˆä¸ºç°ä»£è½¯ä»¶å¼€å‘å’Œè¿ç»´çš„é‡è¦å·¥å…·ä¹‹ä¸€ã€‚\näºŒã€docker composeæ˜¯ä»€ä¹ˆï¼ŸDocker Composeæ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å’Œç®¡ç†å¤šä¸ªDockerå®¹å™¨çš„å·¥å…·ã€‚å®ƒå…è®¸æ‚¨ä½¿ç”¨ç®€å•çš„YAMLæ–‡ä»¶æè¿°åº”ç”¨ç¨‹åºä¸­çš„æœåŠ¡ã€ç½‘ç»œã€å­˜å‚¨å·ç­‰é…ç½®ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢æ¥å¯åŠ¨ã€åœæ­¢å’Œç®¡ç†è¿™äº›å®¹å™¨ã€‚\nä»¥ä¸‹æ˜¯Docker Composeçš„ä¸€äº›é‡è¦ç‰¹ç‚¹ï¼š\n\nå£°æ˜å¼è¯­æ³•ï¼šDocker Composeä½¿ç”¨å£°æ˜å¼çš„YAMLæ–‡ä»¶æ¥æè¿°åº”ç”¨ç¨‹åºçš„æ¶æ„å’Œé…ç½®ã€‚æ‚¨å¯ä»¥åœ¨æ–‡ä»¶ä¸­å®šä¹‰æ¯ä¸ªæœåŠ¡çš„é•œåƒã€ç«¯å£æ˜ å°„ã€ç¯å¢ƒå˜é‡ã€ä¾èµ–å…³ç³»ç­‰ã€‚è¿™ç§å£°æ˜å¼è¯­æ³•ä½¿å¾—å®šä¹‰å’Œç®¡ç†å¤æ‚çš„å®¹å™¨é›†ç¾¤å˜å¾—ç®€å•ä¸”å¯ç»´æŠ¤ã€‚\nå¤šå®¹å™¨åº”ç”¨ç®¡ç†ï¼šDocker Composeä¸“æ³¨äºç®¡ç†å¤šä¸ªç›¸å…³çš„å®¹å™¨ï¼Œä»¥æ„å»ºå®Œæ•´çš„åº”ç”¨ç¨‹åºå †æ ˆã€‚é€šè¿‡ä¸€æ¬¡æ€§çš„å‘½ä»¤ï¼Œæ‚¨å¯ä»¥å¯åŠ¨ã€åœæ­¢ã€é‡å¯å’Œé”€æ¯æ•´ä¸ªå®¹å™¨é›†ç¾¤ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨å¤„ç†æ¯ä¸ªå®¹å™¨ã€‚\nå®¹å™¨é—´è¿æ¥å’Œé€šä¿¡ï¼šä½¿ç”¨Docker Composeï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°ä¸ºå®¹å™¨ä¹‹é—´åˆ›å»ºè¿æ¥å’Œç½‘ç»œã€‚æ‚¨å¯ä»¥å®šä¹‰å®¹å™¨ä¹‹é—´çš„è¿æ¥æ–¹å¼ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿç›¸äº’é€šä¿¡å’Œè®¿é—®ã€‚è¿™åœ¨æ„å»ºå¾®æœåŠ¡æ¶æ„æˆ–å¤šå±‚åº”ç”¨ç¨‹åºæ—¶éå¸¸æœ‰ç”¨ã€‚\nå¯ä¼¸ç¼©æ€§å’Œè´Ÿè½½å‡è¡¡ï¼šDocker Composeå…è®¸æ‚¨è®¾ç½®å®¹å™¨çš„ä¼¸ç¼©ç­–ç•¥ï¼Œä»¥æ ¹æ®åº”ç”¨ç¨‹åºçš„éœ€è¦è‡ªåŠ¨æ‰©å±•æˆ–æ”¶ç¼©å®¹å™¨ã€‚å®ƒè¿˜æ”¯æŒä¸è´Ÿè½½å‡è¡¡å™¨é›†æˆï¼Œå¯ä»¥å°†æµé‡åˆ†å‘åˆ°å¤šä¸ªå®ä¾‹ä¸Šï¼Œæé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œå¯é æ€§ã€‚\nç¯å¢ƒéš”ç¦»å’Œæµ‹è¯•ï¼šä½¿ç”¨Docker Composeï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°åœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¸­å¤åˆ¶ç”Ÿäº§ç¯å¢ƒçš„é…ç½®ã€‚æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæœ¬åœ°çš„å®¹å™¨åŒ–å¼€å‘ç¯å¢ƒï¼Œç¡®ä¿åº”ç”¨ç¨‹åºåœ¨ä¸åŒç¯å¢ƒä¸‹çš„ä¸€è‡´æ€§ï¼Œå¹¶å‡å°‘ç”±äºç¯å¢ƒå·®å¼‚å¼•èµ·çš„é—®é¢˜ã€‚\nå¯æ’æ‹”çš„æ¶æ„ï¼šDocker Composeæ˜¯å¯æ’æ‹”çš„ï¼Œå¯ä»¥ä¸å…¶ä»–å·¥å…·å’ŒæœåŠ¡é›†æˆï¼Œä»¥æ»¡è¶³ç‰¹å®šéœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä¸ç›‘æ§å’Œæ—¥å¿—è®°å½•å·¥å…·é›†æˆï¼Œä»¥ç›‘è§†å’Œç®¡ç†å®¹å™¨çš„æ€§èƒ½å’ŒçŠ¶æ€ã€‚\n\nCompose V1è¯­æ³•ï¼š Compose V1è¯­æ³•æ˜¯è¾ƒæ—©ç‰ˆæœ¬çš„Composeè¯­æ³•ï¼Œå…¶æ–‡ä»¶åé€šå¸¸ä¸ºdocker-compose.ymlã€‚ä»¥ä¸‹æ˜¯ä¸€äº›Compose V1è¯­æ³•çš„ç‰¹ç‚¹ï¼š\n\nservicesï¼šä½¿ç”¨serviceså…³é”®å­—å®šä¹‰è¦è¿è¡Œçš„æœåŠ¡ã€‚æ¯ä¸ªæœåŠ¡éƒ½æœ‰ä¸€ä¸ªåç§°å’Œä¸€ç»„é…ç½®é€‰é¡¹ã€‚\nimageï¼šæŒ‡å®šè¦ä½¿ç”¨çš„é•œåƒåç§°ã€‚\nportsï¼šå®šä¹‰è¦æ˜ å°„åˆ°ä¸»æœºä¸Šçš„å®¹å™¨ç«¯å£ã€‚\nvolumesï¼šæŒ‡å®šè¦æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„å·ã€‚\nlinksï¼šå®šä¹‰ä¸å…¶ä»–æœåŠ¡ä¹‹é—´çš„è¿æ¥ã€‚\nenvironmentï¼šè®¾ç½®å®¹å™¨ä¸­çš„ç¯å¢ƒå˜é‡ã€‚\ndepends_onï¼šå®šä¹‰æœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªCompose V1è¯­æ³•çš„ç¤ºä¾‹ï¼š\n1234567891011121314version: &#x27;2&#x27;services:  web:    image: nginx:latest    ports:      - 8080:80    volumes:      - ./html:/usr/share/nginx/html  db:    image: mysql:latest    environment:      - MYSQL_ROOT_PASSWORD=secret\n\nCompose V2è¯­æ³•ï¼š Compose V2è¯­æ³•æ˜¯è¾ƒæ–°ç‰ˆæœ¬çš„Composeè¯­æ³•ï¼Œå…¶æ–‡ä»¶åé€šå¸¸ä¸ºdocker-compose.yamlæˆ–docker-compose.ymlã€‚ä»¥ä¸‹æ˜¯ä¸€äº›Compose V2è¯­æ³•çš„ç‰¹ç‚¹ï¼š\nservicesï¼šä¸Compose V1ç›¸åŒï¼Œä½¿ç”¨serviceså…³é”®å­—å®šä¹‰è¦è¿è¡Œçš„æœåŠ¡ã€‚imageã€portsã€volumesã€environmentç­‰é€‰é¡¹ä¸Compose V1ç›¸åŒã€‚å¼•å…¥äº†æ–°çš„é…ç½®é€‰é¡¹ï¼Œå¦‚networksã€configså’Œsecretsï¼Œç”¨äºæ›´çµæ´»åœ°å®šä¹‰ç½‘ç»œã€é…ç½®æ–‡ä»¶å’Œæœºå¯†ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªCompose V2è¯­æ³•çš„ç¤ºä¾‹ï¼š\n123456789101112131415161718version: &#x27;3&#x27;services:  web:    image: nginx:latest    ports:      - 8080:80    volumes:      - ./html:/usr/share/nginx/html  db:    image: mysql:latest    environment:      - MYSQL_ROOT_PASSWORD=secretnetworks:  app-net:    driver: bridge\n\né™¤äº†ä»¥ä¸Šä»‹ç»çš„ä¸åŒä¹‹å¤–ï¼ŒCompose V2è¯­æ³•è¿˜å¸¦æ¥äº†ä¸€äº›å…¶ä»–æ”¹è¿›å’ŒåŠŸèƒ½å¢å¼ºï¼Œä¾‹å¦‚æ”¯æŒå¤šä¸ªæ–‡ä»¶çš„æ‰©å±•æ€§ï¼Œå¯é€‰é¡¹çš„éªŒè¯å’Œé»˜è®¤å€¼ç­‰ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨Docker Composeæ—¶ï¼Œè¦æ ¹æ®æ‚¨æ‰€ä½¿ç”¨çš„Composeç‰ˆæœ¬é€‰æ‹©æ­£ç¡®çš„è¯­æ³•ï¼Œå¹¶ç¡®ä¿åœ¨ç¼–å†™Composeæ–‡ä»¶æ—¶éµå¾ªè¯¥ç‰ˆæœ¬çš„è¯­æ³•è§„èŒƒã€‚\nä¸‰ã€Ubuntu-24.04ç‰ˆæœ¬å®‰è£…æœ€æ–°ç”¨äº†æœ€æ–°çš„Ubuntu-24.04ç³»ç»Ÿï¼Œå‘ç°ä»¥å‰çš„å®‰è£…è„šæœ¬ä¼šæŠ¥é”™ï¼Œä¸ç¡®å®šæ˜¯ä¸æ˜¯24.04å¼€å§‹æ”¹å˜çš„ï¼Œ24.04åªéœ€è¦æ‰§è¡Œï¼šsnap install docker å°±å¯ä»¥å®‰è£…äº†ã€‚å…¶ä»–ç‰ˆæœ¬ä½ ä¹Ÿå¯ä»¥å…ˆè¯•è¯•ç”¨snap install dockerå®‰è£…ï¼Œä¸è¡Œå†è¯•ä¸‹é¢çš„æ–¹æ³•ã€‚\nå››ã€æ—§ç‰ˆæœ¬å®‰è£…æ­¥éª¤1ã€Ubuntu å®‰è£…è„šæœ¬ä»£ç å¦‚ä¸‹ï¼ˆç¤ºä¾‹ï¼‰ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#!/bin/bash# å¸è½½å½“å‰ç‰ˆæœ¬echo &quot;å¸è½½å½“å‰ç‰ˆæœ¬.....&quot;sudo apt-get remove docker docker-engine docker.io containerd runcy# è®¾ç½®aptæºecho &quot;è®¾ç½®aptæº.....&quot;sudo apt-get update# å®‰è£…åŸºç¡€ä¾èµ–echo &quot;å®‰è£…åŸºç¡€ä¾èµ–.....&quot;sudo apt-get install -y \\    ca-certificates \\    curl \\    gnupg# å¯ç”¨dockerå®˜æ–¹çš„æºecho &quot;å¯ç”¨dockerå®˜æ–¹çš„æº.....&quot;echo \\  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\  $(. /etc/os-release &amp;&amp; echo $VERSION_CODENAME) stable&quot; | \\  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null# æ·»åŠ dockerå®˜æ–¹çš„GPG Keyecho &quot;æ·»åŠ dockerå®˜æ–¹çš„GPG Key.....&quot;sudo mkdir -m 0755 -p /etc/apt/keyringscurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg# æ›´æ–°è½¯ä»¶æº## æ›´æ–°å¯†é’¥æƒé™ï¼Œå¯é€‰ sudo chmod a+r /etc/apt/keyrings/docker.gpgecho &quot;æ›´æ–°è½¯ä»¶æº.....&quot;sudo apt-get updateecho &quot;å®‰è£…æœ€æ–°ç‰ˆæœ¬æˆ–ç‰¹å®šç‰ˆæœ¬(Yï¼ˆæœ€æ–°ï¼‰/Nï¼ˆç‰¹å®šï¼‰)?&quot;read answerif [ &quot;$answer&quot; == &quot;Y&quot; -o &quot;$answer&quot; == &quot;y&quot; ]; then    echo &quot;å®‰è£…æœ€æ–°ç‰ˆæœ¬&quot;    # å®‰è£…æœ€æ–°ç‰ˆæœ¬    sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-pluginelif [ &quot;$answer&quot; == &quot;N&quot; -o &quot;$answer&quot; == &quot;n&quot; ]; then    echo &quot;æŸ¥è¯¢ç‰ˆæœ¬&quot;    ## æŸ¥è¯¢ç‰ˆæœ¬    apt-cache madison docker-ce | awk &#x27;&#123; print $3 &#125;&#x27;    echo &quot;è¯·æŒ‡å®šç‰ˆæœ¬ï¼š    ä¾‹å¦‚5:20.10.23~3-0~ubuntu-bionicã€5:20.10.23~3-0~ubuntu-focalã€5:20.10.23~3-0~ubuntu-jammy&quot;    read VERSION_STRING    # å®‰è£…ç‰¹å®šç‰ˆæœ¬    # ## å®‰è£…ç‰¹å®šç‰ˆæœ¬ ubuntu 18.04    # VERSION_STRING=5:20.10.23~3-0~ubuntu-bionic    # ## å®‰è£…ç‰¹å®šç‰ˆæœ¬ ubuntu 20.04    # VERSION_STRING=5:20.10.23~3-0~ubuntu-focal    # ## å®‰è£…ç‰¹å®šç‰ˆæœ¬ ubuntu 22.04    # VERSION_STRING=5:20.10.23~3-0~ubuntu-jammy    ## å®‰è£…    sudo apt-get install -y docker-ce=$VERSION_STRING docker-ce-cli=$VERSION_STRING containerd.io docker-compose-pluginelse    echo &quot;æ— æ•ˆçš„è¾“å…¥&quot;fi\n\n2.ç”Ÿæˆè„šæœ¬å°†ä¸Šè¿°å‘½ä»¤ä¿å­˜ä¸ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼ˆä¾‹å¦‚script.shï¼‰ï¼Œå¹¶æ·»åŠ æ‰§è¡Œæƒé™ã€‚æ‚¨å¯ä»¥åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ‰§è¡Œè¯¥è„šæœ¬ï¼š\n12chmod +x script.sh./script.sh\n\n3.å¯åŠ¨å’ŒéªŒè¯12345678910111213# æŸ¥çœ‹dockerdocker -v# è€ç‰ˆæœ¬docker composeå‘½ä»¤ä¸ºdocker-compose -v# æ–°ç‰ˆæœ¬docker composeå‘½ä»¤ä¸ºdocker compose version# æŸ¥çœ‹dockeræœåŠ¡æ˜¯å¦å¯åŠ¨$ systemctl status docker# è‹¥æœªå¯åŠ¨ï¼Œåˆ™å¯åŠ¨dockeræœåŠ¡$ sudo systemctl start docker# éªŒè¯hello world$ sudo docker run hello-world\n\näº”ã€å¸è½½æ­¥éª¤1.Ubuntuå¸è½½è„šæœ¬123456789101112131415161718192021222324252627282930# å¸è½½æ—§ç‰ˆæœ¬çš„Dockeryum remove docker \\                  docker-client \\                  docker-client-latest \\                  docker-common \\                  docker-latest \\                  docker-latest-logrotate \\                  docker-logrotate \\                  docker-selinux \\                  docker-engine-selinux \\                  docker-engine \\                  docker-cerm -rf /etc/dockerrm -rf /run/dockerrm -rf /var/lib/dockershim#åˆ é™¤dockerçš„é•œåƒæ–‡ä»¶rm -rf /var/lib/dockerps -ef|grep docker|grep -v grep|xargs kill -s 9#å¸è½½dockerç›¸å…³åŒ…yum remove docker-*yum remove docker-ce-cli-*yum remove docker-scan-plugin*# åˆ é™¤æ—§ç‰ˆdocker-composerm -rf /usr/local/bin/docker-composerm -rf /usr/bin/docker-compose\n\n2.ä¿å­˜æ–‡ä»¶åè®¾ç½®æ‰§è¡Œæƒé™1chmod +777  docker-uninstall.sh\n\n3.è¿è¡Œæ–‡ä»¶1sh  docker-uninstall.sh\n\n4.éªŒè¯æ˜¯å¦åˆ é™¤æˆåŠŸ12docker -vdocker-compose -v\n\nå…­ã€CentOSå®‰è£…è„šæœ¬1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980#!/bin/bash\t# å¸è½½å½“å‰ç‰ˆæœ¬\techo &quot;å¸è½½å½“å‰ç‰ˆæœ¬.....&quot;\tsudo yum remove docker-ce docker-ce-cli containerd.io\t# è®¾ç½®yumæº\techo &quot;è®¾ç½®yumæº.....&quot;\tsudo yum install -y yum-utils\tsudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\t# å®‰è£…åŸºç¡€ä¾èµ–\techo &quot;å®‰è£…åŸºç¡€ä¾èµ–.....&quot;\tsudo yum install -y \\\t    yum-plugin-copr \\\t    device-mapper-persistent-data \\\t    lvm2 \\\t    git \\\t    bash-completion \\\t    bash-completion-extras \\\t    iptables \\\t    policycoreutils-python \\\t    selinux-policy-base \\\t    selinux-policy-targeted \\\t    audit \\\t    libseccomp-devel \\\t    python3-pip \\\t    python3-setuptools \\\t    python3-wheel\t# æ›´æ–°è½¯ä»¶æº\techo &quot;æ›´æ–°è½¯ä»¶æº.....&quot;\tsudo yum update -y\techo &quot;å®‰è£…æœ€æ–°ç‰ˆæœ¬æˆ–ç‰¹å®šç‰ˆæœ¬(Yï¼ˆæœ€æ–°ï¼‰/Nï¼ˆç‰¹å®šï¼‰)?&quot;\tread answer\tif [ &quot;$answer&quot; == &quot;Y&quot; -o &quot;$answer&quot; == &quot;y&quot; ]; then\t    echo &quot;å®‰è£…æœ€æ–°ç‰ˆæœ¬&quot;\t    # å®‰è£…æœ€æ–°ç‰ˆæœ¬\t    sudo yum install -y docker-ce docker-ce-cli containerd.io\telif [ &quot;$answer&quot; == &quot;N&quot; -o &quot;$answer&quot; == &quot;n&quot; ]; then\t    echo &quot;æŸ¥è¯¢ç‰ˆæœ¬&quot;\t    ## æŸ¥è¯¢ç‰ˆæœ¬\t    yum list docker-ce --showduplicates | grep -i &quot;docker-ce&quot;\t    echo &quot;è¯·æŒ‡å®šç‰ˆæœ¬ï¼š\t    ä¾‹å¦‚3:20.10.11-3.el7ã€3:20.10.11-3.el8&quot;\t    read VERSION_STRING\t    # å®‰è£…ç‰¹å®šç‰ˆæœ¬\t    ## å®‰è£…ç‰¹å®šç‰ˆæœ¬ centos 7\t    # VERSION_STRING=3:20.10.11-3.el7\t    ## å®‰è£…ç‰¹å®šç‰ˆæœ¬ centos 8\t    # VERSION_STRING=3:20.10.11-3.el8\t    ## å®‰è£…\t    sudo yum install -y docker-ce-$VERSION_STRING docker-ce-cli-$VERSION_STRING containerd.io\telse\t    echo &quot;æ— æ•ˆçš„è¾“å…¥&quot;\tfi\t# å¯åŠ¨DockeræœåŠ¡\techo &quot;å¯åŠ¨DockeræœåŠ¡.....&quot;\tsudo systemctl start docker\t# è®¾ç½®Dockerå¼€æœºè‡ªå¯\techo &quot;è®¾ç½®Dockerå¼€æœºè‡ªå¯.....&quot;\tsudo systemctl enable docker\t# é…ç½®DockeråŠ é€Ÿå™¨\techo &quot;é…ç½®DockeråŠ é€Ÿå™¨.....&quot;\techo &#x27;&#123;\t  &quot;registry-mirrors&quot;: [&quot;https://your_mirror_url&quot;]\t&#125;&#x27; | sudo tee /etc/docker/daemon.json\t# é‡å¯DockeræœåŠ¡\techo &quot;é‡å¯DockeræœåŠ¡.....&quot;\tsudo systemctl daemon-reload\tsudo systemctl restart docker\techo &quot;Dockerå®‰è£…å®Œæˆ&quot;\n\nå¸è½½è„šæœ¬123456789101112131415161718192021222324#!/bin/bash# åœæ­¢å’Œåˆ é™¤æ‰€æœ‰Dockerå®¹å™¨echo &quot;åœæ­¢å’Œåˆ é™¤æ‰€æœ‰Dockerå®¹å™¨.....&quot;sudo docker stop $(sudo docker ps -aq)sudo docker rm $(sudo docker ps -aq)# å¸è½½DockeræœåŠ¡echo &quot;å¸è½½DockeræœåŠ¡.....&quot;sudo yum remove -y docker-ce docker-ce-cli containerd.io# åˆ é™¤Dockerç›¸å…³æ–‡ä»¶å’Œç›®å½•echo &quot;åˆ é™¤Dockerç›¸å…³æ–‡ä»¶å’Œç›®å½•.....&quot;sudo rm -rf /var/lib/dockersudo rm -rf /etc/docker# åˆ é™¤Dockerç”¨æˆ·ç»„echo &quot;åˆ é™¤Dockerç”¨æˆ·ç»„.....&quot;sudo groupdel docker# åˆ é™¤Dockerå­˜å‚¨åº“echo &quot;åˆ é™¤Dockerå­˜å‚¨åº“.....&quot;sudo rm -f /etc/yum.repos.d/docker-ce.repoecho &quot;Dockerå·²æˆåŠŸå¸è½½&quot;\n\næ€»ç»“æˆ‘ä»¬å¯ä»¥é€šè¿‡ç”¨æˆ·è¾“å…¥æŒ‡ä»¤æ¥å®‰è£…ä¸åŒç‰ˆæœ¬çš„dockerå’Œdocker composeï¼Œä¹Ÿå¯ä»¥ä¸€é”®å¸è½½ï¼Œä½¿ç”¨è„šæœ¬çœå¿ƒåˆå¿«æ·ã€‚\n","slug":"Ubuntuä¸€é”®å®‰è£…å¸è½½docker","date":"2024-11-18T16:00:00.000Z","categories_index":"DevOps","tags_index":"","author_index":"FaceMan"}]